*P00PROC
* 
* 
* P00PROC.FXP 
* ----------- 
*

PROCEDURE BROW_BOX
PARAMETER TOP_ROW, TOP_COL, BOT_ROW, BOT_COL
ACTIVATE SCREEN
@ TOP_ROW, TOP_COL TO BOT_ROW, BOT_COL PEN 2, 8 COLOR RGB(128,128,128,,,),
@ TOP_ROW-0.254, TOP_COL-0.400 TO BOT_ROW-0.254, BOT_COL-0.200 PEN 2, 8 COLOR RGB(255,255,255,,,),

PROCEDURE CUSTOM_SET
RETURN
USE PA7rpts
IF  .NOT. EMPTY(MENU)
   DEFINE BAR 14 OF REPORTS PROMPT '\<1. '+MENU MESSAGE 'Custom Report/Label Option #1' SKIP FOR  .NOT. OPTION_VAL('CUSTOM 1') .OR. .F.
ELSE
   DEFINE BAR 14 OF REPORTS PROMPT '\<1. Undefined Custom Report' SKIP FOR .T.
ENDIF
SKIP
IF  .NOT. EMPTY(MENU)
   DEFINE BAR 15 OF REPORTS PROMPT '\<2. '+MENU MESSAGE 'Custom Report/Label Option #2' SKIP FOR  .NOT. OPTION_VAL('CUSTOM 2') .OR. .F.
ELSE
   DEFINE BAR 15 OF REPORTS PROMPT '\<2. Undefined Custom Report' SKIP FOR .T.
ENDIF
SKIP
IF  .NOT. EMPTY(MENU)
   DEFINE BAR 16 OF REPORTS PROMPT '\<3. '+MENU MESSAGE 'Custom Report/Label Option #3' SKIP FOR  .NOT. OPTION_VAL('CUSTOM 3') .OR. .F.
ELSE
   DEFINE BAR 16 OF REPORTS PROMPT '\<3. Undefined Custom Report' SKIP FOR .T.
ENDIF
SKIP
IF  .NOT. EMPTY(MENU)
   DEFINE BAR 17 OF REPORTS PROMPT '\<4. '+MENU MESSAGE 'Custom Report/Label Option #4' SKIP FOR  .NOT. OPTION_VAL('CUSTOM 4') .OR. .F.
ELSE
   DEFINE BAR 17 OF REPORTS PROMPT '\<4. Undefined Custom Report' SKIP FOR .T.
ENDIF
SKIP
IF  .NOT. EMPTY(MENU)
   DEFINE BAR 18 OF REPORTS PROMPT '\<5. '+MENU MESSAGE 'Custom Report/Label Option #5' SKIP FOR  .NOT. OPTION_VAL('CUSTOM 5') .OR. .F.
ELSE
   DEFINE BAR 18 OF REPORTS PROMPT '\<5. Undefined Custom Report' SKIP FOR .T.
ENDIF
CLOSE DATABASES
RETURN

FUNCTION  BUTT_UPDAT
PARAMETER A, B, C, D, E, _WINDOW
_WHICH_WIN = _WINDOW
IF A=1
   SHOW GET M_XX, 1 ENABLE
ELSE
   SHOW GET M_XX, 1 DISABLE
ENDIF
IF B=1
   SHOW GET M_XX, 2 ENABLE
ELSE
   SHOW GET M_XX, 2 DISABLE
ENDIF
IF C=1
   SHOW GET M_XX, 3 ENABLE
ELSE
   SHOW GET M_XX, 3 DISABLE
ENDIF
IF D=1
   SHOW GET M_XX, 4 ENABLE
ELSE
   SHOW GET M_XX, 4 DISABLE
ENDIF
IF E=1
   SHOW GET M_XX, 5 ENABLE
ELSE
   SHOW GET M_XX, 5 DISABLE
ENDIF
RETURN .T.

FUNCTION  BUTT_CHK
IF MWINDOW()='P00PICK' .AND. MDOWN()
   DO p00pick.prg
   IF  .NOT. EXIT_KEYS()
      RETURN .F.
   ENDIF
ENDIF
RETURN .T.

FUNCTION  BUTT2_UPDA
PARAMETER A, B, C, D, E, F, _WINDOW
_WHICH_WIN = _WINDOW
IF A=1
   SHOW GET M_XX, 1 ENABLE
ELSE
   SHOW GET M_XX, 1 DISABLE
ENDIF
IF B=1
   SHOW GET M_XX, 2 ENABLE
ELSE
   SHOW GET M_XX, 2 DISABLE
ENDIF
IF C=1
   SHOW GET M_XX, 3 ENABLE
ELSE
   SHOW GET M_XX, 3 DISABLE
ENDIF
IF D=1
   SHOW GET M_XX, 4 ENABLE
ELSE
   SHOW GET M_XX, 4 DISABLE
ENDIF
IF E=1
   SHOW GET M_XX, 5 ENABLE
ELSE
   SHOW GET M_XX, 5 DISABLE
ENDIF
IF F=1
   SHOW GET M_XX, 6 ENABLE
ELSE
   SHOW GET M_XX, 6 DISABLE
ENDIF
RETURN .T.

FUNCTION  BUTT2_CHK
IF MWINDOW()='P00PICK2' .AND. MDOWN()
   DO p00pick2.prg
   IF  .NOT. EXIT_KEYS()
      RETURN .F.
   ENDIF
ENDIF
RETURN .T.

FUNCTION  BUTT3_UPDA
PARAMETER A, B, C, D, E, _WINDOW
_WHICH_WIN = _WINDOW
IF A=1
   SHOW GET M_XX, 1 ENABLE
ELSE
   SHOW GET M_XX, 1 DISABLE
ENDIF
IF B=1
   SHOW GET M_XX, 2 ENABLE
ELSE
   SHOW GET M_XX, 2 DISABLE
ENDIF
IF C=1
   SHOW GET M_XX, 3 ENABLE
ELSE
   SHOW GET M_XX, 3 DISABLE
ENDIF
IF D=1
   SHOW GET M_XX, 4 ENABLE
ELSE
   SHOW GET M_XX, 4 DISABLE
ENDIF
IF E=1
   SHOW GET M_XX, 5 ENABLE
ELSE
   SHOW GET M_XX, 5 DISABLE
ENDIF
RETURN .T.

FUNCTION  ENCRYPT
PARAMETER TO_DO
RET_VAR = ''
Y = 1
DO WHILE Y<=LEN(ALLTRIM(TO_DO))
   RET_VAR = RET_VAR+CHR(ASC(SUBSTR(TO_DO,Y,1))+153)
   Y = Y+1
ENDDO
RETURN RET_VAR

FUNCTION  DECRYPT
PARAMETER TO_DO
RET_VAR = ''
Y = 1
DO WHILE Y<=LEN(ALLTRIM(TO_DO))
   RET_VAR = RET_VAR+CHR(ASC(SUBSTR(TO_DO,Y,1))-153)
   Y = Y+1
ENDDO
RETURN RET_VAR

PROCEDURE BANNER
IF SHAREWARE
   @ INT((SROWS()-8)/2)-6, INT((SCOLS()-50)/2) CLEAR TO INT((SROWS()-8)/2)+2, INT((SCOLS()-50)/2)+49
   @ INT((SROWS()-8)/2)-6, INT((SCOLS()-50)/2) TO INT((SROWS()-8)/2)-2, INT((SCOLS()-50)/2)+49 DOUBLE
   @ INT((SROWS()-8)/2)-4, INT(SCOLS()-40)/2 SAY 'SHAREWARE VERSION, PLEASE REGISTER.....' FONT 'MS Sans Serif', 8 STYLE 'B' COLOR W+/RB* 
ENDIF
RETURN

PROCEDURE JERK
IF _START+30>DATE()
   RETURN
ENDIF
DEFINE WINDOW ERR_MSG FROM SROWS()-15, 5 TO SROWS()-10, 75 COLOR SCHEME 7
ACTIVATE WINDOW ERR_MSG
@ 1, 5 SAY 'UREGISTERED VERSION, This is a strong reminder to register.'
@ 2, 5 SAY 'Delay Counter: '
FOR DELAY_COUN = 1 TO (((DATE()-_START)-30)*4)
   @ 2, 22 SAY STR(DELAY_COUN,5)
   X = INKEY(1)
ENDFOR
RELEASE WINDOW ERR_MSG
RETURN

PROCEDURE PA7_CUSTOM
PARAMETER _WHICH_ONE
USE PA7Rpts
GOTO _WHICH_ONE
MTYPE = TYPE
XFILE = NAME
CLOSE DATABASES
PCG_REPORT = SPACE(8)
PCG_CONDEN = .F.
PCG_FILE = SPACE(8)
PCG_SORT = SPACE(10)
DFFROM = ' '
DFTO = ' '
SENDPRN = ''
XFILENAME = SPACE(40)
DO CASE
   CASE MTYPE='L'
      XFILE = ALLTRIM(XFILE)+'.LB1'
   OTHERWISE
      XFILE = ALLTRIM(XFILE)+'.FR1'
ENDCASE
DO PC7_FILTER WITH XFILE, MTYPE
RETURN

PROCEDURE PC7_FILTER
PARAMETER XFILE, MTYPE
RESTORE FROM &xfile ADDITIVE
MFILE = MDRIVE+'\'+PCG_FILE
USE &mfile ALIAS pc7_HANDLE
IF  .NOT. PC7_SCOPE()
   CLOSE DATABASES
   PRGVAR = 0
   RETURN
ENDIF
INDEX ON &PCg_Sort TO TEMP
USE &mfile INDEX temp
SET FILTER TO &PCg_Sort >= dffrom .AND. &PCg_Sort <= dfto
GOTO TOP
IF  .NOT. PRN_READY()
   SELECT PC7_HANDLE
   CLOSE DATABASES
   DELETE FILE TEMP.IDX
   PRGVAR = 0
   RETURN
ENDIF
IF EOF()
   = ISOUND()
   = OKMSG('No Records Found.')
   USE
   DELETE FILE temp.idx
   PRGVAR = 0
   RETURN
ENDIF
SET CONSOLE OFF
CLEAR
= PRNMSG('Printing Custom Report')
IF PCG_CONDEN
   = RPT_SETUP(.T.)
ELSE
   = RPT_SETUP(.F.)
ENDIF
STOP_PRN = .F.
SAVE SCREEN TO XXX
IF MTYPE='L'
   DO CASE
      CASE UPPER(SENDPRN)='SCREEN'
         SET PRINTER TO
         SET DEVICE TO SCREEN
         LABEL FORM &pcg_report TO FILE out.txt
      CASE UPPER(SENDPRN)='FILE'
         SET PRINTER TO
         SET DEVICE TO SCREEN
         LABEL FORM &pcg_report TO FILE &xfilename
      OTHERWISE
         LABEL FORM &pcg_report TO PRINT PROMPT
   ENDCASE
ELSE
   DO CASE
      CASE UPPER(SENDPRN)='SCREEN'
         SET PRINTER TO
         SET DEVICE TO SCREEN
         REPORT FORM &pcg_report TO FILE out.txt
      CASE UPPER(SENDPRN)='FILE'
         SET PRINTER TO
         SET DEVICE TO SCREEN
         REPORT FORM &pcg_report TO FILE &xfilename
      OTHERWISE
         REPORT FORM &pcg_report TO PRINT PROMPT
   ENDCASE
ENDIF
SET CONSOLE ON
RESTORE SCREEN FROM XXX
CLEAR
RELEASE WINDOW
CLEAR
IF PCG_CONDEN
   = RPT_RESET(.T.)
ELSE
   = RPT_RESET(.F.)
ENDIF
CLOSE DATABASES
DELETE FILE temp.idx
PRGVAR = 0
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN

FUNCTION  PC7_SCOPE
DO CASE
   CASE TYPE(PCG_SORT)='N'
      DFFROM = 0
      DFTO = VAL(SUBSTR(STRING1,1,LEN(PCG_SORT)))
      PIC_CLAUSE = '9999999999'
   CASE TYPE(PCG_SORT)='D'
      DFFROM = CTOD('01/01/01')
      DFTO = CTOD('12/12/99')
      PIC_CLAUSE = 'XX/XX/XX'
   OTHERWISE
      DFFROM = 'A'+SPACE(LEN(PCG_SORT)-1)
      DFTO = REPLICATE('Z',(LEN(PCG_SORT)))
      PIC_CLAUSE = '!!!!!!!!!!'
ENDCASE
XFILENAME = 'REPORT.TXT'+SPACE(10)
_BUTTONS = 1
_BROWSE = '  '
DO PPC_SCOP.SPR
IF LASTKEY()=KEY_ESC .OR. _BUTTONS=2
   RETURN .F.
ENDIF
RETURN .T.

PROCEDURE PC7_CHK
PRGVAR = 59
DO PSCOPE.MPR

PROCEDURE HELP_CALL
RET_ESC = ON('KEY','ESCAPE')
ON KEY LABEL F1 
ON KEY LABEL ESCAPE 
DO CASE
   CASE PRGVAR=99 .OR. PRGVAR=1000
   CASE PRGVAR=0
      SET TOPIC TO 'GENERAL'
   CASE PRGVAR=11 .OR. PRGVAR=111
      SET TOPIC TO 'ACCOUNTS'
   CASE PRGVAR=12 .OR. PRGVAR=121
      SET TOPIC TO 'CLIENTS'
   CASE PRGVAR=13
      SET TOPIC TO 'VENDORS'
   CASE PRGVAR=14 .OR. PRGVAR=141 .OR. PRGVAR=142
      SET TOPIC TO 'PRODUCTS'
   CASE PRGVAR=15
      SET TOPIC TO 'SERVICES'
   CASE PRGVAR=16
      SET TOPIC TO 'MESSAGES'
   CASE PRGVAR=17
      SET TOPIC TO 'SALESPEOPLE'
   CASE PRGVAR=18
      SET TOPIC TO 'JOB'
   CASE PRGVAR=19 .OR. PRGVAR=191
      SET TOPIC TO 'GENERAL/ID'
   CASE PRGVAR=101 .OR. PRGVAR=102 .OR. PRGVAR=103 .OR. PRGVAR=104
      SET TOPIC TO 'CLIENT_NOTES'
   CASE PRGVAR=112
      SET TOPIC TO 'PASSWORD_ACCESS'
   CASE PRGVAR=113
      SET TOPIC TO 'OPEN_COMPANY'
   CASE PRGVAR=114
      SET TOPIC TO 'CREATE_COMPANY'
   CASE PRGVAR=21 .OR. PRGVAR=211
      SET TOPIC TO 'PURCHASE_ORDERS'
   CASE PRGVAR=22 .OR. PRGVAR=221
      SET TOPIC TO 'RECEIVED_PO'
   CASE PRGVAR=23
      SET TOPIC TO 'INVENTORY_ADJUSTMENTS'
   CASE PRGVAR=241 .OR. PRGVAR=242
      SET TOPIC TO 'PRINT_PO/RECEIVED_PO'
   CASE PRGVAR=25
      SET TOPIC TO 'PRINT_ADJUSTMENTS'
   CASE PRGVAR=26
      SET TOPIC TO 'PURCHASE_JOURNAL'
   CASE PRGVAR=27
      SET TOPIC TO 'POST_RECEIVED_PO'
   CASE PRGVAR=28
      SET TOPIC TO 'POST_ADJUSTMENTS'
   CASE PRGVAR=291 .OR. PRGVAR=292
      SET TOPIC TO 'BILL_OF_MATERIALS'
   CASE PRGVAR=31 .OR. PRGVAR=311
      SET TOPIC TO 'ESTIMATES'
   CASE PRGVAR=32 .OR. PRGVAR=321
      SET TOPIC TO 'INVOICES'
   CASE PRGVAR=33
      SET TOPIC TO 'PRINT_ESTIMATES'
   CASE PRGVAR=34
      SET TOPIC TO 'PRINT_INVOICES'
   CASE PRGVAR=35
      SET TOPIC TO 'REVENUE_JOURNAL'
   CASE PRGVAR=36
      SET TOPIC TO 'COMMISSION_REPORT'
   CASE PRGVAR=37
      SET TOPIC TO 'SALES_ANALYSIS'
   CASE PRGVAR=38
      SET TOPIC TO 'POST_INVOICES'
   CASE PRGVAR=391 .OR. PRGVAR=392 .OR. PRGVAR=393
      SET TOPIC TO 'RECURRING_INVOICES'
   CASE PRGVAR=41
      SET TOPIC TO 'AR_TRANSACTIONS'
   CASE PRGVAR=42 .OR. PRGVAR=421 .OR. PRGVAR=422 .OR. PRGVAR=423
      SET TOPIC TO 'CASH_RECEIPTS'
   CASE PRGVAR=43
      SET TOPIC TO 'PRINT_AR_JOURNALS'
   CASE PRGVAR=44
      SET TOPIC TO 'AR_POSTING_PROCESS'
   CASE PRGVAR=45
      SET TOPIC TO 'FINANCE_CHARGES'
   CASE PRGVAR=461 .OR. PRGVAR=462 .OR. PRGVAR=463
      SET TOPIC TO 'AR_RECURRING_ENTRIES'
   CASE PRGVAR=51
      SET TOPIC TO 'AP_TRANSACTIONS'
   CASE PRGVAR=52 .OR. PRGVAR=521 .OR. PRGVAR=522
      SET TOPIC TO 'CASH_PAYMENTS'
   CASE PRGVAR=53
      SET TOPIC TO 'DIRECT_CHECKS'
   CASE PRGVAR=54
      SET TOPIC TO 'PRINT_AP_JOURNALS'
   CASE PRGVAR=55
      SET TOPIC TO 'PRINT_CHECKS'
   CASE PRGVAR=56
      SET TOPIC TO 'AP_POSTING_PROCESS'
   CASE PRGVAR=571 .OR. PRGVAR=572 .OR. PRGVAR=573
      SET TOPIC TO 'AP_RECURRING_ENTRIES'
   CASE PRGVAR=61
      SET TOPIC TO 'GL_TRANSACTIONS'
   CASE PRGVAR=63
      SET TOPIC TO 'ACCOUNT_ACTIVITY'
   CASE PRGVAR=64
      SET TOPIC TO 'GL_JOURNAL_REPORT'
   CASE PRGVAR=621 .OR. PRGVAR=6211 .OR. PRGVAR=622 .OR. PRGVAR=623
      SET TOPIC TO 'CHECK_RECONCILE'
   CASE PRGVAR=65
      SET TOPIC TO 'SALES_TAX_REPORT'
   CASE PRGVAR=66
      SET TOPIC TO 'GL_POSTING_PROCESS'
   CASE PRGVAR=671 .OR. PRGVAR=672 .OR. PRGVAR=673
      SET TOPIC TO 'GL_RECURRING_ENTRIES'
   CASE PRGVAR=71
      SET TOPIC TO 'LEDGER_REPORTS'
   CASE PRGVAR=72
      SET TOPIC TO 'CLIENT_REPORTS'
   CASE PRGVAR=73
      SET TOPIC TO 'VENDOR_REPORTS'
   CASE PRGVAR=74
      SET TOPIC TO 'SERVICE_LIST'
   CASE PRGVAR=75
      SET TOPIC TO 'PRODUCT_LIST'
   CASE PRGVAR=76
      SET TOPIC TO 'MESSAGE_LIST'
   CASE PRGVAR=77
      SET TOPIC TO 'JOB_LIST'
   CASE PRGVAR=78
      SET TOPIC TO 'SALESPEOPLE_LIST'
   CASE PRGVAR=79
      SET TOPIC TO 'HISTORICAL_REPORTS'
   CASE PRGVAR=811
      SET TOPIC TO 'GL_END_OF_MONTH'
   CASE PRGVAR=812
      SET TOPIC TO 'AR_END_OF_MONTH'
   CASE PRGVAR=813
      SET TOPIC TO 'AP_END_OF_MONTH'
   CASE PRGVAR=814
      SET TOPIC TO 'INVENTORY_END_OF_MONTH'
   CASE PRGVAR=815
      SET TOPIC TO 'COMMISSION_END_OF_MONTH'
   CASE PRGVAR=816
      SET TOPIC TO 'GL_END_OF_YEAR'
   CASE PRGVAR=817
      SET TOPIC TO 'ROLL_HISTORICAL_NUMBERS'
   CASE PRGVAR=818
      SET TOPIC TO 'INVOICE_PURGE'
   CASE PRGVAR=819
      SET TOPIC TO 'JOB_PURGE'
   CASE PRGVAR=81101 .OR. PRGVAR=81102
      SET TOPIC TO 'BUDGET'
   CASE PRGVAR=81111 .OR. PRGVAR=81112 .OR. PRGVAR=81113
      SET TOPIC TO 'FIXED_ASSETS'
   CASE PRGVAR=823
      SET TOPIC TO 'BACKUP_DATA'
   CASE PRGVAR=824
      SET TOPIC TO 'RESTORE_DATA'
   CASE PRGVAR=831
      SET TOPIC TO 'COLOR_SETUP'
   CASE PRGVAR=832
      SET TOPIC TO 'VIDEO_SETUP'
   CASE PRGVAR=833
      SET TOPIC TO 'TAX_TABLES'
   CASE PRGVAR=834
      SET TOPIC TO 'STATEMENT_TEXT'
   CASE PRGVAR=835
      SET TOPIC TO 'CUSTOM_FORMS'
   CASE PRGVAR=836
      SET TOPIC TO 'CUSTOM_FONTS'
   CASE PRGVAR=837
      SET TOPIC TO 'PRINTER_SETUP'
   CASE PRGVAR=838
      SET TOPIC TO 'DEFAULT_DESCRIPTIONS'
   CASE PRGVAR=839
      SET TOPIC TO 'COUNTRY_SETUP'
   CASE PRGVAR=8310
      SET TOPIC TO 'PROGRAM_CONFIGURATION'
   CASE PRGVAR=8311
      SET TOPIC TO 'RUN_PROGRAM_SETUP'
   CASE PRGVAR=841
      SET TOPIC TO 'FORMAT_DISK'
   CASE PRGVAR=843
      SET TOPIC TO 'COPY_FILE'
   CASE PRGVAR=844
      SET TOPIC TO 'DELETE_FILE'
   CASE PRGVAR=845
      SET TOPIC TO 'RENAME_FILE'
   CASE PRGVAR=846
      SET TOPIC TO 'DOS_BACKUP'
   CASE PRGVAR=847
      SET TOPIC TO 'DOS_RESTORE'
   CASE PRGVAR=853 .OR. PRGVAR=8531
      SET TOPIC TO 'PAINLESS_COMPANION'
   CASE PRGVAR=854
      SET TOPIC TO 'PAINLESS_EDITOR'
   CASE PRGVAR=855
      SET TOPIC TO 'XBASE_INTERPRETER'
   CASE PRGVAR=858
      SET TOPIC TO 'CUSTOMIZE_MENU'
   CASE PRGVAR=861
      SET TOPIC TO 'CLIENT_BEGINNING_BALANCES'
   CASE PRGVAR=862
      SET TOPIC TO 'VENDOR_BEGINNING_BALANCES'
   CASE PRGVAR=863
      SET TOPIC TO 'ACCOUNT_BEGINNING_BALANCES'
   CASE PRGVAR=864
      SET TOPIC TO 'PRODUCT_BEGINNING_BALANCES'
ENDCASE
RUN /n3 WinHelp Account4.HLP
SET TOPIC TO 
IF  .NOT. EMPTY(RET_ESC)
   ON KEY LABEL ESCAPE &ret_esc
ENDIF
ON KEY LABEL F1 DO Help_Call

PROCEDURE PE_EXIT
PRGVAR = 0
RELEASE MENU PPE_0MNU
DO REINDEX WITH .F.
DO CUSTOM_SET
DO P00TBAR
RETURN

PROCEDURE PC_EXIT
PRGVAR = 0
RELEASE MENU PPC_0MNU
DO CUSTOM_SET
IF _WINDOWS
   DO P00TBAR
ENDIF
RETURN

PROCEDURE INITVARS
SET BELL OFF
SET CONFIRM ON
SET DATE AMERICAN
SET DELETED ON
SET ESCAPE OFF
SET EXCLUSIVE OFF
SET HEADING OFF
SET REPROCESS TO AUTOMATIC
SET SAFETY OFF
SET SCOREBOARD OFF
SET STATUS OFF
SET TALK OFF
SET FUNCTION 2 TO
SET FUNCTION 3 TO
SET FUNCTION 4 TO
SET FUNCTION 5 TO
SET FUNCTION 6 TO
SET FUNCTION 7 TO
SET FUNCTION 8 TO
SET FUNCTION 9 TO
SET FUNCTION 10 TO
SET FUNCTION 11 TO
SET FUNCTION 12 TO
ON KEY LABEL RIGHTMOUSE KEYBOARD "{F4}"
PUBLIC KEY_F1, KEY_F4, KEY_F6, KEY_ESC, KEY_ENTER, KEY_TAB, KEY_SHIFTT
PUBLIC KEY_UP, KEY_DOWN, KEY_RIGHT, KEY_LEFT, KEY_F2, KEY_F8, KEY_F5
KEY_TAB = 9
KEY_SHIFTT = 15
KEY_UP = 5
KEY_DOWN = 4
KEY_LEFT = 19
KEY_RIGHT = 24
KEY_ENTER = 13
KEY_F2 = -1
KEY_F4 = -3
KEY_F5 = -4
KEY_F6 = -5
KEY_F8 = -7
KEY_ESC = 27
CLEAR WINDOW

FUNCTION  EXIT_KEYS
IF LASTKEY()=KEY_F5 .OR. LASTKEY()=KEY_F8
   RETURN .T.
ENDIF
RETURN .F.

PROCEDURE INITCO
IF  .NOT. USED('DOCGEN')
   USE &mDrive\DocGen In 0
ENDIF
SELECT DOCGEN
CCOMPANY = COMPANY
CNAME = NAME
CADDRESS1 = ADDRESS1
CADDRESS2 = ADDRESS2
CCITY = CITY
CSTATE = STATE
CZIP = ZIP
CPHONE1 = PHONE1
MPASS0 = LEFT(LINE1,25)
MPASS1 = LEFT(LINE2,25)
MPASS2 = LEFT(LINE3,25)
MPASS3 = LEFT(LINE4,25)
MPASS4 = LEFT(LINE5,25)
MPASS5 = SUBSTR(LINE1,26,25)
MPASS6 = SUBSTR(LINE2,26,25)
MPASS7 = SUBSTR(LINE3,26,25)
MPASS8 = SUBSTR(LINE4,26,25)
MPASS9 = SUBSTR(LINE5,26,25)
PASS_LEVEL = 0
I0 = VAL(SUBSTR(GENERAL,1,2))
J0 = 40
DOTS = 'Description..................................'
PRNDEF = SUBSTR(GENERAL,5,1)
DO CASE
   CASE PRNDEF='P'
      SENDPRN = 'Printer'
   CASE PRNDEF='F'
      SENDPRN = 'File'
   OTHERWISE
      SENDPRN = 'Screen'
ENDCASE
SCRLINES = VAL(SUBSTR(LINE15,17,2))
IF SCRLINES<>25 .AND. SCRLINES<>43 .AND. SCRLINES<>50
   SCRLINES = 25
ENDIF
DO CASE
   CASE SCRLINES=43
      IF LEFT(SYS(2006),3)$'EGA|VGA|XGA'
         SET DISPLAY TO EGA43
      ENDIF
   CASE SCRLINES=50
      IF LEFT(SYS(2006),3)$'VGA|XGA'
         SET DISPLAY TO VGA50
      ENDIF
ENDCASE
MSIGN = SUBSTR(LINE10,21,5)
MDOLL = SUBSTR(LINE10,26,20)
INTERFACE = IIF(SUBSTR(LINE15,16,1)='Y',.T.,.F.)
M.INSHIP = IIF(SUBSTR(LINE15,17,1)='Y',.T.,.F.)
JOBCOST = IIF(SUBSTR(GENERAL,6,1)='Y',.T.,.F.)
HOLDINV = IIF(SUBSTR(GENERAL,7,1)='Y',.T.,.F.)
NEGUNITS = IIF(SUBSTR(GENERAL,8,1)='Y',.T.,.F.)
WRITEOFF = IIF(SUBSTR(GENERAL,9,1)='Y',.T.,.F.)
SHIPTO = IIF(SUBSTR(GENERAL,10,1)='Y',.T.,.F.)
EXPLOWIN = IIF(SUBSTR(GENERAL,11,1)='Y',.T.,.F.)
CALCCOMM = IIF(SUBSTR(GENERAL,12,1)='Y',.T.,.F.)
HOLDREV = IIF(SUBSTR(GENERAL,13,1)='Y',.T.,.F.)
GSTTAX = IIF(SUBSTR(GENERAL,14,1)='Y',.T.,.F.)
VATTAX = IIF(SUBSTR(GENERAL,19,1)='Y',.T.,.F.)
COSTING = SUBSTR(GENERAL,18,1)
COSTING = IIF(COSTING=' ','S',COSTING)
BROWTYPE = SUBSTR(GENERAL,20,1)
BROWTYPE = IIF(BROWTYPE=' ','N',BROWTYPE)
IS_EXPLODE = IIF(EXPLOWIN=.T.,'EXPLODE','  ')
MPRODUCTS = PRODUCTS
MPAY = PAYABLE
MCHECKING = CHECKING
MFRGHTE = FREIGHTEXP
MSALES = SALES
MRECEIV = RECEIVABLE
MCOGS = COGS
MFRGHTI = FREIGHTINC
MCOGSLIAB = SALESTAX
MDISCEXP = TAXEXP
IF SUBSTR(GENERAL,15,1)=' '
   ILEFT = 6
ELSE
   ILEFT = VAL(SUBSTR(GENERAL,15,1))
ENDIF
IF SUBSTR(GENERAL,16,1)=' '
   IRIGHT = 4
ELSE
   IRIGHT = VAL(SUBSTR(GENERAL,16,1))
ENDIF
IF ILEFT+IRIGHT=3
   CQTY = 'O'
ELSE
   CQTY = LEFT('Ordr.......',(IRIGHT+ILEFT)-1)
ENDIF
IF IRIGHT>0
   PICQTY = REPLICATE('9',ILEFT)+'.'+REPLICATE('9',IRIGHT)
ELSE
   PICQTY = REPLICATE('9',ILEFT)
ENDIF
MRATE0 = 0
MRATE1 = RATE1/100
MRATE2 = RATE2/100
MRATE3 = RATE3/100
MRATE4 = RATE4/100
MRATE5 = RATE5/100
MRATE6 = RATE6/100
MRATE7 = GSTRATE/100
MHEADB = COMPANY
COLHEAD = (80-LEN(RTRIM(COMPANY)))/2
COUNTRY = VAL(SUBSTR(LINE15,1,1))
DATEF = VAL(SUBSTR(LINE15,2,1))
IF COUNTRY=0
   COUNTRY = 1
ENDIF
DO CASE
   CASE COUNTRY=2
      STATEPIC = '!!!!'
      ZIPPIC = 'XXX-XXX'
   CASE COUNTRY=3
      STATEPIC = '!!!'
      ZIPPIC = 'XXXX'
   OTHERWISE
      STATEPIC = '!!'
      ZIPPIC = 'XXXXX-XXXX'
ENDCASE
DO CASE
   CASE DATEF=2
      SET DATE Ansi
   CASE DATEF=3
      SET DATE British
   CASE DATEF=4
      SET DATE German
   CASE DATEF=5
      SET DATE Italian
   CASE DATEF=6
      SET DATE French
   OTHERWISE
      SET DATE American
ENDCASE
IF EMPTY(LPT)
   PRN_PORT = 'LPT1'
ELSE
   PRN_PORT = 'LPT'+ALLTRIM(STR(LPT))
ENDIF
PDRIVE = ALLTRIM(LEFT(LINE6,30))
IF INTERFACE
   IF FILE(PDRIVE+'\PA_INTER.DBF')
      USE &pDrive\PA_INTER
      IF RECCOUNT()<>0
         DO P00PayUp.PRG
      ENDIF
      SELECT DOCGEN
   ENDIF
ENDIF
SELECT DOCGEN
PRNUM = VAL(SUBSTR(LINE15,14,2))
IF PRNUM=0
   PRNUM = 19
ENDIF
RETURN

FUNCTION  INPUTOK
PARAMETER THESTRING
IF CHR(34)$THESTRING .OR. CHR(96)$THESTRING .OR. CHR(39)$THESTRING
   = OKMSG('Code cannot contain an apostrophe.')
   RETURN .F.
ENDIF
RETURN .T.

FUNCTION  OKCANMSG
PARAMETER MSGSTRING
OK_PRGVAR = PRGVAR
CLEAR TYPEAHEAD
PUSH KEY CLEAR
ON KEY LABEL esc *
PRGVAR = 1000
M.RESP = 1
IF RIGHT(MSGSTRING,2)='??'
   MSGSTRING = LEFT(MSGSTRING,LEN(MSGSTRING)-1)
   M.RESP = 2
ENDIF
IF M.RESP=2
ENDIF
MSG_POSITI = (48-LEN(MSGSTRING))/2
IF  .NOT. WEXIST('_qdm0lazwk')
   DEFINE WINDOW _QDM0LAZWK AT 0.000, 0.000 SIZE 10.154, 47.000 FONT 'MS Sans Serif', 8 STYLE 'B' FLOAT NOCLOSE SHADOW TITLE 'Confirm!' NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
   MOVE WINDOW _QDM0LAZWK CENTER
ENDIF
ACTIVATE WINDOW SAME _QDM0LAZWK
@ 3.000, 0 SAY (LOCFILE('..\bmpico\x_quest.bmp','BMP|ICO','Where is x_quest?')) BITMAP
@ 2, MSG_POSITI SAY MSGSTRING FONT 'Arial', 9 STYLE 'B'
@ 4.385, 11.500 GET M.RESP DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.154, 12.500, 0.667 PICTURE '@*BHT  '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))+';'+(LOCFILE('..\bmpico\x_cancl2.bmp','BMP|ICO','Where is x_cancl2?'))
IF  .NOT. WVISIBLE('_qdm0lazwk')
   ACTIVATE WINDOW _QDM0LAZWK
ENDIF
READ MODAL
RELEASE WINDOW _QDM0LAZWK
PRGVAR = OK_PRGVAR
RETVAL = (M.RESP=1)
POP KEY
RETURN (RETVAL)

FUNCTION  OKMSG
PARAMETER MSGSTRING
OK_PRGVAR = PRGVAR
CLEAR TYPEAHEAD
PUSH KEY CLEAR
ON KEY LABEL esc *
PRGVAR = 1000
M.RESP = 1
IF RIGHT(MSGSTRING,2)='??'
   MSGSTRING = LEFT(MSGSTRING,LEN(MSGSTRING)-1)
ENDIF
MSG_POSITI = MAX(0,(48-LEN(MSGSTRING))/2)
IF  .NOT. WEXIST('_qdm0mv5f7')
   DEFINE WINDOW _QDM0MV5F7 AT 0.000, 0.000 SIZE 10.154, 50.000 FONT 'MS Sans Serif', 8 STYLE 'B' FLOAT NOCLOSE SHADOW TITLE 'Information' NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
   MOVE WINDOW _QDM0MV5F7 CENTER
ENDIF
ACTIVATE WINDOW SAME _QDM0MV5F7
@ 3.000, 0 SAY (LOCFILE('..\bmpico\x_info.bmp','BMP|ICO','Where is x_info?')) BITMAP
@ 2, MSG_POSITI SAY MSGSTRING
@ 4.000, 18.000 GET M.RESP DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.154, 11.500, 0.667 PICTURE '@*BHT '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))
IF  .NOT. WVISIBLE('_qdm0mv5f7')
   ACTIVATE WINDOW _QDM0MV5F7
ENDIF
READ MODAL
RELEASE WINDOW _QDM0MV5F7
PRGVAR = OK_PRGVAR
POP KEY
RETURN .T.

PROCEDURE PROMSG
PARAMETER MSGSTRING
WINWIDTH = LEN(MSGSTRING)+10
WINHEIGHT = 7
DEFINE WINDOW PRO_MSG AT 0.000, 0.000 SIZE 8.385, 98.200 FONT 'MS Sans Serif', 8 NOFLOAT NOCLOSE NOMINIMIZE NONE COLOR RGB(,,,192,192,192)
MOVE WINDOW PRO_MSG CENTER
ACTIVATE WINDOW PRO_MSG
@ 0, 0 TO 8.385, 98.200 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.100, 0.100 TO 8.285, 98.100 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.200, 0.200 TO 8.185, 98.000 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.923, 2.400 TO 7.461, 96.200 PEN 1, 8 COLOR RGB(128,128,128,,,),
@ 7.385, 2.400 TO 7.385, 96.200 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 0.923, 96.000 TO 7.461, 96.000 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 2.769, 12.000 SAY (LOCFILE('..\bmpico\x_clock.bmp','BMP|ICO','Where is x_clock?')) BITMAP STYLE 'T' SIZE 2.462, 6.400
@ 5.615, 31.200 SAY 'Processing, one moment please.....' FONT 'Arial', 10 STYLE 'B'
@ 2, (WCOLS()-TXTWIDTH(MSGSTRING,'Arial',10)*FONTMETRIC(6,'Arial',10)/FONTMETRIC(6))/2 SAY MSGSTRING FONT 'Arial', 10
ACTIVATE WINDOW PRO_MSG
RETURN

PROCEDURE MAKEEOF
GOTO BOTTOM
IF  .NOT. EOF()
   SKIP
ENDIF

PROCEDURE ERROR_MSG_
PARAMETER ERRNUM, MSG, PROG, LINE
DEFINE WINDOW ERR_MSG FROM SROWS()-7, 0 TO SROWS()-2, 79 COLOR SCHEME 7
DO CASE
   CASE ERRNUM=108
      LINE1 = 'FILE is in use by another.  Try again later...'
   CASE ERRNUM=109 .OR. ERRNUM=130
      LINE1 = 'RECORD is in use by another.  Try again later...'
   OTHERWISE
      LINE1 = 'Error in '+PROG+' at '+ALLTRIM(STR(LINE,4))+', '+MSG
ENDCASE
ACTIVATE WINDOW ERR_MSG
IF LEN(LINE1)>WCOLS()-2
   LINE1 = LEFT(LINE1,WCOLS()-2)
ENDIF
@ 1, (WCOLS()-LEN(LINE1))/2 SAY LINE1
WAIT SPACE((WCOLS()-28)/2)+'Press any key to continue...'
RELEASE WINDOW ERR_MSG
RETURN

PROCEDURE ERROR_MSG
PARAMETER ERRNUM, MSG, PROG, LINE
PRIVATE MCMESSAGE
DO CASE
   CASE ERRNUM=108
      LINE1 = 'FILE is in use by another.  Try again later...'
   CASE ERRNUM=109
      LINE1 = 'RECORD is in use by another.  Try again later...'
   CASE ERRNUM=130 .OR. ERRNUM=1707
      RETURN
   OTHERWISE
      LINE1 = 'Error in '+PROG+' at '+ALLTRIM(STR(LINE,4))+', '+MSG
ENDCASE
MCMESSAGE = LINE1
SHOW GET MCMESSAGE
PRIVATE M.CURRAREA, M.TALKSTAT, M.COMPSTAT
IF SET('TALK')='ON'
   SET TALK OFF
   M.TALKSTAT = 'ON'
ELSE
   M.TALKSTAT = 'OFF'
ENDIF
M.COMPSTAT = SET('COMPATIBLE')
SET COMPATIBLE TO FOXPLUS
M.RBORDER = SET('READBORDER')
SET READBORDER ON
M.CURRAREA = SELECT()
IF  .NOT. WEXIST('_qyg0h0e2b')
   DEFINE WINDOW _QYG0H0E2B AT 0.000, 0.000 SIZE 12.538, 98.400 FONT 'MS Sans Serif', 8 FLOAT NOCLOSE TITLE 'Error Message' NOMINIMIZE SYSTEM COLOR RGB(,,,192,192,192)
   MOVE WINDOW _QYG0H0E2B CENTER
ENDIF
IF WVISIBLE('_qyg0h0e2b')
   ACTIVATE WINDOW SAME _QYG0H0E2B
ELSE
   ACTIVATE WINDOW NOSHOW _QYG0H0E2B
ENDIF
@ 1.308, 10.000 GET MCMESSAGE DEFAULT ' ' FONT 'Arial', 11 SIZE 4.588, 57.714 PICTURE '@K' WHEN .F. COLOR ,RGB(,,,255,255,255)
@ 2.077, 2.000 SAY 'i' FONT 'Times New Roman', 36 STYLE 'BIT'
@ 8.308, 33.600 GET HNIGNEXIT DEFAULT 1 FONT 'MS Sans Serif', 8 SIZE 3.538, 22.200, 0.800 PICTURE '@*BHT '+(LOCFILE('..\bmpico\exit.bmp','BMP|ICO|PCT|ICN','Where is exit?')) VALID _QYG0H0FTV()
@ 1.154, 9.600 TO 1.154, 91.400 STYLE '1' PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 7.385, 9.600 TO 7.385, 91.400 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 1.154, 9.400 TO 7.462, 9.400 PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 1.154, 91.400 TO 7.462, 91.400 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
IF  .NOT. WVISIBLE('_qyg0h0e2b')
   ACTIVATE WINDOW _QYG0H0E2B
ENDIF
READ CYCLE MODAL
RELEASE WINDOW _QYG0H0E2B
SELECT (M.CURRAREA)
SET READBORDER &rborder
IF M.TALKSTAT='ON'
   SET TALK ON
ENDIF
IF M.COMPSTAT='ON'
   SET COMPATIBLE TO DB4
ENDIF

PROCEDURE _QYG0H0FTV
= PA7GETOUT()

PROCEDURE P00PAYUP
RETURN

PROCEDURE WRITEFILE
IF FILE(MDRIVE+'\OVERFLOW.LOG')
   L = FOPEN(MDRIVE+'\OVERFLOW.LOG',12)
   = FSEEK(L,0,2)
ELSE
   L = FCREATE(MDRIVE+'\OVERFLOW.LOG')
ENDIF
IF L>0
   = FPUTS(L,LINE1)
   = FPUTS(L,LINE2)
   = FCLOSE(L)
ENDIF

FUNCTION  ACC_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = ACCOUNT(1)
IF  .NOT. USED('ACCOUNT')
   USE IN 0 (MDRIVE+'\ACCOUNT.DBF')
ENDIF
SELECT ACCOUNT
GOTO TOP
IF  .NOT. EMPTY(ACCOUNT(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW ACC_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Account Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW ACC_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE FIELDS ACCOUNT.ACCOUNT :H = 'Account', ACCOUNT.ACCTNAME :H = 'Account Name', ACCOUNT.ACCTTYPE :H = 'Type', ACCOUNT.PREVBAL :H = 'Prev. Balance', ACCOUNT.MONTHBAL :H = 'Month Balance', ACCOUNT.CURRBAL :H = 'Curr. Balance' FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW ACC_BROW TITLE 'List Of Accounts' NOREFRESH
   RELEASE WINDOW ACC_BROW
   RELEASE WINDOW 'List Of Accounts'
   RELEASE WINDOW BUTTWIND
   ON KEY LABEL ENTER 
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
ACCOUNT[ 1] = ACCOUNT
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   ACCOUNT[ 1] = M.OLDCODE
ENDIF
SEEK ACCOUNT(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

FUNCTION  BNOKVALID
ACTIVATE WINDOW 'List Of Accounts'
IF BNOK=1
   KEYBOARD '{ENTER}'
ELSE
   KEYBOARD '{ESC}'
ENDIF
RETURN .T.

PROCEDURE ACC_SAVE
IF  .NOT. USED('ACCOUNT')
   USE IN 0 (MDRIVE+'\ACCOUNT.DBF')
ENDIF
SELECT ACCOUNT
SEEK ACCOUNT(1)
NEW_ADD = .F.
IF EOF()
   APPEND BLANK
   NEW_ADD = .T.
ENDIF
IF RLOCK()
   IF NEW_ADD
      FOR _Q = 4 TO 30
         ACCOUNT[ _Q] = 0
      ENDFOR
   ENDIF
   GATHER FROM ACCOUNT
ENDIF
IF  .NOT. RESTACC
   SCATTER BLANK TO ACCOUNT
   = MAKEEOF()
   _CUROBJ = OBJNUM(ACCOUNT(1))
ELSE
   CLEAR READ
ENDIF

FUNCTION  ATY_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = ACCTYPE(1)
IF  .NOT. USED('ACCTYPE')
   USE IN 0 (MDRIVE+'\ACCTYPE.DBF')
ENDIF
SELECT ACCTYPE
GOTO TOP
IF  .NOT. EMPTY(ACCTYPE(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW ATY_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Account Type Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW ATY_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE LAST FIELDS ACCTYPE.ACCTTYPE :H = 'Account Type', ACCTYPE.TYPENAME :H = 'Account Type Name' FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW ATY_BROW NOREFRESH
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW ATY_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
ACCTYPE[ 1] = ACCTYPE.ACCTTYPE
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   ACCTYPE[ 1] = M.OLDCODE
ENDIF
SEEK ACCTYPE(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE ATY_SAVE
IF  .NOT. USED('ACCTYPE')
   USE IN 0 (MDRIVE+'\ACCTYPE.DBF')
ENDIF
SELECT ACCTYPE
SEEK ACCTYPE(1)
IF EOF()
   APPEND BLANK
ENDIF
IF RLOCK()
   GATHER FROM ACCTYPE
ENDIF
SCATTER BLANK TO ACCTYPE
= MAKEEOF()
_CUROBJ = OBJNUM(ACCTYPE(1))

FUNCTION  CLI_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = CLIENT(1)
IF  .NOT. USED('CLIENT')
   USE IN 0 (MDRIVE+'\CLIENT.DBF')
ENDIF
SELECT CLIENT
GOTO TOP
IF  .NOT. EMPTY(CLIENT(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW CLI_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Client Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW CLI_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE LAST FIELDS CLIENT.CLIENT :H = 'Client', CLIENT.COMPANY :H = 'Company', CLIENT.NAME :H = 'Name', CLIENT.ADDRESS :H = 'Address', CLIENT.ADDRESS3 :H = 'Address 2', CLIENT.CITY :H = 'City', CLIENT.STATE :H = 'State', CLIENT.ZIP :H = 'Zip', CLIENT.PHONE1 :H = 'Phone', CLIENT.PHONE2 :H = 'Phone 2', CLIENT.LASTVISIT :H = 'Last Invoice', CLIENT.LASTPAY :H = 'Last Payment', CLIENT.TOTBALAN :H = 'Balance', CLIENT.COMMENTS :H = 'Comments' FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW CLI_BROW NOREFRESH
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW CLI_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
CLIENT[ 1] = CLIENT
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   CLIENT[ 1] = M.OLDCODE
ENDIF
SEEK CLIENT(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE CLI_SAVE
IF  .NOT. USED('CLIENT')
   USE IN 0 (MDRIVE+'\CLIENT.DBF')
ENDIF
SELECT CLIENT
SEEK CLIENT(1)
NEW_ADD = .F.
IF EOF()
   APPEND BLANK
   NEW_ADD = .T.
ENDIF
IF RLOCK()
   GATHER FROM CLIENT
   REPLACE FORWARD WITH IIF(M.FORWARD=.T.,'Y','N')
   REPLACE INTEREST WITH IIF(M.INTEREST=.T.,'Y','N')
   REPLACE GSTCODE WITH IIF(M.GSTCODE=.T.,'Y','N')
   REPLACE VAT WITH IIF(M.VAT=.T.,'Y','N')
   IF NEW_ADD
      REPLACE TOTBALAN WITH 0
      REPLACE MTDU WITH 0
      REPLACE MTDD WITH 0
      REPLACE YTDU WITH 0
      REPLACE YTDD WITH 0
      REPLACE LYU WITH 0
      REPLACE LYD WITH 0
   ENDIF
ENDIF
IF  .NOT. RESTCLI
   SCATTER BLANK TO CLIENT
   = MAKEEOF()
   M.FORWARD = .F.
   M.INTEREST = .F.
   M.GSTCODE = .F.
   M.VAT = .F.
   _CUROBJ = OBJNUM(CLIENT(1))
ELSE
   CLEAR READ
ENDIF

FUNCTION  VEN_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = VENDOR(1)
IF  .NOT. USED('VENDOR')
   USE IN 0 (MDRIVE+'\VENDOR.DBF')
ENDIF
SELECT VENDOR
GOTO TOP
IF  .NOT. EMPTY(VENDOR(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW VEN_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Vendor Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW VEN_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE LAST FIELDS VENDOR.VENDOR :H = 'Vendor', VENDOR.COMPANY :H = 'Company', VENDOR.NAME :H = 'Name', VENDOR.ADDRESS :H = 'Address', VENDOR.ADDRESS2 :H = 'Address 2', VENDOR.CITY :H = 'City', VENDOR.STATE :H = 'State', VENDOR.ZIP :H = 'Zip', VENDOR.PHONE1 :H = 'Phone 1', VENDOR.PHONE2 :H = 'Phone 2', VENDOR.CURRBAL :H = 'Balance', VENDOR.LASTPUR :H = 'Last Purchase', VENDOR.LASTPAY :H = 'Last Payment', VENDOR.COMMENTS :H = 'Comments' FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW VEN_BROW NOREFRESH
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW VEN_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
VENDOR[ 1] = VENDOR
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   VENDOR[ 1] = M.OLDCODE
ENDIF
SEEK VENDOR(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE VEN_SAVE
IF  .NOT. USED('VENDOR')
   USE IN 0 (MDRIVE+'\VENDOR.DBF')
   RESTVEN = .F.
ENDIF
SELECT VENDOR
SEEK VENDOR(1)
NEW_ADD = .F.
IF EOF()
   APPEND BLANK
   NEW_ADD = .T.
ENDIF
IF RLOCK()
   GATHER FROM VENDOR
   REPLACE VAT WITH IIF(M.VAT=.T.,'Y','N')
   REPLACE GSTCODE WITH IIF(M.GSTTAX1=.T.,'Y','N')
   IF NEW_ADD
      REPLACE CURRBAL WITH 0
      REPLACE MTDU WITH 0
      REPLACE MTDD WITH 0
      REPLACE YTDU WITH 0
      REPLACE YTDD WITH 0
      REPLACE LYU WITH 0
      REPLACE LYD WITH 0
   ENDIF
ENDIF
IF  .NOT. RESTVEN
   SCATTER BLANK TO VENDOR
   = MAKEEOF()
   _CUROBJ = OBJNUM(VENDOR(1))
ELSE
   CLEAR READ
ENDIF

FUNCTION  PRO_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = SERVICE(1)
IF  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE.DBF')
ENDIF
SELECT SERVICE
GOTO TOP
IF  .NOT. EMPTY(SERVICE(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW SER_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Product Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW SER_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE WINDOW SER_BROW LAST FOR TYPE='P' NOEDIT NODELETE NOREFRESH NOMENU  FONT "MS Sans Serif", 8 STYLE "B" FIELDS  SERVICE.SERVICE &PROSIZE :H='Product',    SERVICE.SERVDESC        :H='Product description',        SERVICE.SELLPRICE       :H='Price' :P='9999999.99',      SERVICE.COST            :H='Std. Cost' :P='9999999.99',  SERVICE.AVECOST         :H='Ave. Cost' :P='9999999.99',  SERVICE.UNITS           :H='On Hand Units' :P='9999999.99',      SERVICE.DOLLARS         :H='On Hand Dollars' :P='9999999.99',    SERVICE.ORDER           :H='On Order' :P='9999999.99',   SERVICE.COMMITT         :H='Committed' :P='9999999.99',  SERVICE.PSALES          :H='Sales Acct.',        SERVICE.DEPT            :H='Dept.',      SERVICE.CLASS           :H='Class',      SERVICE.TAXABLE         :H='Taxable'
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW SER_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
SERVICE[ 1] = LEFT(SERVICE,I0)
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   SERVICE[ 1] = M.OLDCODE
ENDIF
SELECT SERVICE
SEEK SERVICE(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

FUNCTION  SER_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = SERVICE(1)
IF  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE.DBF')
ENDIF
SELECT SERVICE
GOTO TOP
IF  .NOT. EMPTY(SERVICE(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW SER_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Service Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW SER_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE WINDOW SER_BROW LAST FOR TYPE=' ' NOEDIT NODELETE NOREFRESH NOMENU  FONT "MS Sans Serif", 8 STYLE "B" FIELDS  SERVICE.SERVICE &PROSIZE :H='Service',    SERVICE.SERVDESC        :H='Service description',        SERVICE.SELLPRICE       :H='Price',      SERVICE.PSALES          :H='Sales Acct.',        SERVICE.DEPT            :H='Dept.',      SERVICE.CLASS           :H='Class',      SERVICE.TAXABLE         :H='Taxable'
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW SER_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
SERVICE[ 1] = LEFT(SERVICE,I0)
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   SERVICE[ 1] = M.OLDCODE
ENDIF
SELECT SERVICE
SEEK SERVICE(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

FUNCTION  MES_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = SERVICE(1)
IF  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE.DBF')
ENDIF
SELECT SERVICE
GOTO TOP
IF  .NOT. EMPTY(SERVICE(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW SER_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Message Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW SER_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE WINDOW SER_BROW LAST FOR TYPE='D' NOEDIT NODELETE NOREFRESH NOMENU  FONT "MS Sans Serif", 8 STYLE "B" FIELDS  SERVICE.SERVICE    &PROSIZE  :H='Message',  SERVICE.SERVDESC        :H='Message description'
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW SER_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
SERVICE[ 1] = LEFT(SERVICE,I0)
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   SERVICE[ 1] = M.OLDCODE
ENDIF
SELECT SERVICE
SEEK SERVICE(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE SER_SAVE
IF  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE.DBF')
ENDIF
SELECT SERVICE
SEEK SERVICE(1)
NEW_ADD = .F.
IF EOF()
   APPEND BLANK
   NEW_ADD = .T.
ENDIF
IF RLOCK()
   IF NEW_ADD .AND. PRGVAR<>16
      FOR _Q = 14 TO 26
         SERVICE[ _Q] = 0
      ENDFOR
      SERVICE[ 6] = 0
      SERVICE[ 7] = 0
      SERVICE[ 8] = 0
      SERVICE[ 9] = 0
   ENDIF
   JCEXACT = SET('Exact')
   SET EXACT OFF
   SERVICE[ 2] = LEFT(SERVICE(2),25)
   GATHER FROM SERVICE
   IF TYPE('M.MANUFACT')='N'
      REPLACE MANUFACT WITH IIF(SEEK(SERVICE(1),'build'),'Y','N')
      REPLACE LEVELS WITH IIF(M.LEVEL=1,'Y','N')
   ELSE
      REPLACE MANUFACT WITH IIF(M.MANUFACT,'Y','N')
      REPLACE LEVELS WITH IIF(M.LEVEL,'Y','N')
   ENDIF
   Set Exact &jcExact
   REPLACE TAXABLE WITH IIF(M.TAXABLE,'Y','N')
   REPLACE GSTCODE WITH IIF(M.GST,'Y','N')
   REPLACE TYPE WITH IIF(PRGVAR=14,'P',IIF(PRGVAR=15,' ','D'))
   SCATTER BLANK TO SERVICE
   M.MANUFACT = .F.
   M.LEVEL = .F.
   M.TAXABLE = .F.
   M.GST = .F.
   M.VATCODE = '0'
   SERVICE[ 10] = MSALES
   SERVICE[ 11] = MCOGS
ENDIF
DO CASE
   CASE PRGVAR=14 .AND. RESTPRO
      CLEAR READ
   CASE PRGVAR=15 .AND. RESTSER
      CLEAR READ
   CASE PRGVAR=16 .AND. RESTSER
      CLEAR READ
   OTHERWISE
      = MAKEEOF()
      _CUROBJ = OBJNUM(SERVICE(1))
ENDCASE

FUNCTION  SAL_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDALIAS = ALIAS()
OLDPRG = PRGVAR
PRGVAR = 99
M.OLDCODE = SALESMAN(1)
IF  .NOT. USED('SALESMAN')
   USE IN 0 (MDRIVE+'\SALESMAN.DBF')
ENDIF
SELECT SALESMAN
GOTO TOP
IF  .NOT. EMPTY(SALESMAN(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW SAL_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Salesman Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW SAL_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE LAST FIELDS SALESMAN.S_PERSON :H = 'Code' :V = KEYPRESS() :F, SALESMAN.S_NAME :H = 'Salesperson' :V = KEYPRESS() :F FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW SAL_BROW NOREFRESH
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW SAL_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
SALESMAN[ 1] = S_PERSON
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   SALESMAN[ 1] = M.OLDCODE
ENDIF
SEEK SALESMAN(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE SAL_SAVE
IF  .NOT. USED('SALESMAN')
   USE IN 0 (MDRIVE+'\SALESMAN.DBF')
ENDIF
SELECT SALESMAN
GOTO TOP
SEEK SALESMAN(1)
NEW_ADD = .F.
IF EOF()
   APPEND BLANK
   NEW_ADD = .T.
ENDIF
IF RLOCK()
   IF NEW_ADD
      FOR _Q = 4 TO 12
         SALESMAN[ _Q] = 0
      ENDFOR
   ENDIF
   JNPERCENTA = JNPERCENTA*0.01
   GATHER FROM SALESMAN
   REPLACE COMMISSION WITH JNPERCENTA
ENDIF
IF  .NOT. RESTSAL
   SCATTER BLANK TO SALESMAN
   JNPERCENTA = 0
   = MAKEEOF()
   _CUROBJ = OBJNUM(SALESMAN(1))
ELSE
   CLEAR READ
ENDIF

FUNCTION  JOB_BROW
PRIVATE OLDALIAS, M.OLDCODE
OLDPRG = PRGVAR
PRGVAR = 99
OLDALIAS = ALIAS()
M.OLDCODE = JOB(1)
IF  .NOT. USED('JOB')
   USE IN 0 (MDRIVE+'\JOB.DBF')
ENDIF
SELECT JOB
GOTO TOP
IF  .NOT. EMPTY(JOB(1))
   SEEK M.OLDCODE
ENDIF
XBROWTYPE = BROWTYPE
IF BROWTYPE='P'
   DO P00PRMPT.SPR
ENDIF
IF BROWTYPE='A'
   DO P00BROW.SPR
ELSE
   PRIVATE BNOK
   BNOK = 1
   DEFINE WINDOW JOB_BROW FROM 10, 5 TO 30, 75 GROW NOFLOAT NOCLOSE NOZOOM SHADOW TITLE 'Job Browse' SYSTEM COLOR SCHEME 10
   DEFINE WINDOW BUTTWIND FROM 38.010, 5 TO 42.010, 75.800 COLOR SCHEME 10
   ACTIVATE WINDOW BUTTWIND
   @ 0.010, 0.050 GET BNOK SIZE 3, 69.7 PICTURE '@*NH \!Exit'
   CLEAR GETS
   ACTIVATE WINDOW JOB_BROW
   STORE -1 TO M.G_LASTROW, M.G_LASTCOL, M.G_LASTCLLK
   PUSH KEY CLEAR
   ON KEY LABEL leftmouse do i_dblclk
   ON KEY LABEL enter keyb chr(23)
   BROWSE LAST FIELDS JOB.JOB :H = 'Job', JOB.JOBNAME :H = 'Job Name' FONT 'MS Sans Serif', 8 STYLE 'B' NOMENU NOEDIT NODELETE WINDOW JOB_BROW NOREFRESH
   ON KEY LABEL ENTER 
   ON KEY LABEL leftmouse 
   RELEASE WINDOW JOB_BROW
   RELEASE WINDOW BUTTWIND
   POP KEY
ENDIF
BROWTYPE = XBROWTYPE
JOB[ 1] = JOB
IF LASTKEY()=KEY_ESC .AND.  .NOT. EMPTY(M.OLDCODE)
   JOB[ 1] = M.OLDCODE
ENDIF
SEEK JOB(1)
SELECT &OLDALIAS
PRGVAR = OLDPRG
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN (LASTKEY()<>KEY_ESC)

PROCEDURE JOB_SAVE
IF  .NOT. USED('JOB')
   USE IN 0 (MDRIVE+'\JOB.DBF')
ENDIF
SELECT JOB
SEEK JOB(1)
IF EOF()
   APPEND BLANK
ENDIF
IF RLOCK()
   GATHER FROM JOB
ENDIF
IF  .NOT. RESTJOB
   SCATTER BLANK TO JOB
   = MAKEEOF()
   _CUROBJ = OBJNUM(JOB(1))
ELSE
   CLEAR READ
ENDIF

PROCEDURE REINDEX
PARAMETER _FLY
IF _FLY
   IF  .NOT. OKCANMSG('Continue with Reindex?')
      RETURN
   ENDIF
ENDIF
PATH = ALLTRIM(DATA_PATH)+'\*.dbf'
CPATH = ALLTRIM(DATA_PATH)+'\'
MLFIRST = .T.
DO WHILE .T.
   IF MLFIRST
      MLFIRST = .F.
      DBFFILE = SYS(2000,PATH)
   ELSE
      DBFFILE = SYS(2000,PATH,1)
   ENDIF
   IF  .NOT. EMPTY(DBFFILE)
      USE (CPATH+DBFFILE)
      USE
   ELSE
      EXIT
   ENDIF
ENDDO
= PRN_STAT()
COUNT = 44
X = 1
= STATUSBAR('ACCOUNT.DBF')
USE &mDrive\Account EXCLUSIVE
PACK
INDEX ON ACCOUNT TAG ACCOUNT
= STATUSBAR('ACCTYPE.DBF')
USE &mDrive\AccType EXCLUSIVE
PACK
INDEX ON ACCTTYPE TAG ACCTYPE
= STATUSBAR('CLIENT.DBF')
USE &mDrive\Client EXCLUSIVE
PACK
INDEX ON CLIENT TAG CLIENT
IF FILE(MDRIVE+'\PA_SHIP.DBF')
   = STATUSBAR('PA_SHIP.DBF')
   USE &mDrive\Pa_Ship EXCLUSIVE
   PACK
   INDEX ON CLIENT TAG CLIENT
ENDIF
IF FILE(MDRIVE+'\RUNIT.DBF')
   USE &mDrive\RUNIT EXCLUSIVE
   PACK
   INDEX ON RT1 TAG RT1
ENDIF
IF FILE(MDRIVE+'\APPOINT.DBF')
   USE &mDrive\APPOINT EXCLUSIVE
   PACK
   INDEX ON ADATE TAG ADATE
ENDIF
IF FILE(MDRIVE+'\FORMS.DBF')
   USE &mDrive\FORMS EXCLUSIVE
   PACK
   INDEX ON NAME TAG NAME
ENDIF
= STATUSBAR('SERVICE.DBF')
USE &mDrive\Service EXCLUSIVE
PACK
INDEX ON SERVICE TAG SERVICE
= STATUSBAR('VENDOR.DBF')
USE &mDrive\Vendor EXCLUSIVE
PACK
INDEX ON VENDOR TAG VENDOR
= STATUSBAR('INVOICE.DBF')
USE &mDrive\Invoice EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('INVLINE.DBF')
USE &mDrive\InvLine EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('CASH.DBF')
USE &mDrive\Cash EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('AROPEN.DBF')
USE &mDrive\ArOpen EXCLUSIVE
PACK
INDEX ON ARINVOICE+STR(ARTRANSAC,10) TAG INVTRAN
= STATUSBAR('RECEIV.DBF')
USE &mDrive\Receiv EXCLUSIVE
PACK
INDEX ON TRANS TAG TRANS
= STATUSBAR('RECLINE.DBF')
USE &mDrive\RecLine EXCLUSIVE
PACK
INDEX ON TRANS TAG TRANS
= STATUSBAR('GLTRAN.DBF')
USE &mDrive\GlTran EXCLUSIVE
PACK
INDEX ON GJOURNAL+GLTRAN TAG JRNTRAN
INDEX ON GLACCT TAG ACCOUNT
= STATUSBAR('GLREO.DBF')
USE &mDrive\GlReo EXCLUSIVE
PACK
INDEX ON GJOURNAL+GLTRAN TAG JRNTRAN
= STATUSBAR('ARREO.DBF')
USE &mDrive\ArReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('ARLINREO.DBF')
USE &mDrive\ArLinReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('BIREO.DBF')
USE &mDrive\BiReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('BILINREO.DBF')
USE &mDrive\BiLinReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('DIRCHK.DBF')
USE &mDrive\DirChk EXCLUSIVE
PACK
INDEX ON CKNUM TAG CKNUM
= STATUSBAR('JOB.DBF')
USE &mDrive\Job EXCLUSIVE
PACK
INDEX ON JOB TAG JOB
= STATUSBAR('SALESMAN.DBF')
USE &mDrive\SalesMan EXCLUSIVE
PACK
INDEX ON S_PERSON TAG SALESMAN
= STATUSBAR('CHECKS.DBF')
USE &mDrive\Checks EXCLUSIVE
PACK
INDEX ON NUMBER TAG NUMBER
= STATUSBAR('PURCHASE.DBF')
USE &mDrive\Purchase EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('PURLINE.DBF')
USE &mDrive\PurLine EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('APOPEN.DBF')
USE &mDrive\ApOpen EXCLUSIVE
PACK
INDEX ON APINVOICE+STR(APTRANSAC,10) TAG INVTRAN
= STATUSBAR('PAYABLE.DBF')
USE &mDrive\Payable EXCLUSIVE
PACK
INDEX ON TRANS TAG TRANS
= STATUSBAR('PAYLINE.DBF')
USE &mDrive\PayLine EXCLUSIVE
PACK
INDEX ON TRANS TAG TRANS
= STATUSBAR('INV-ADJ.DBF')
USE &mDrive\Inv-Adj EXCLUSIVE
PACK
INDEX ON SERVICE TAG SERVICE
= STATUSBAR('CLINOTES.DBF')
USE &mDrive\CliNotes EXCLUSIVE
PACK
INDEX ON CLIENT+DTOC(CLIDATE) TAG CLIENT
= STATUSBAR('INVYTD.DBF')
USE &mDrive\InvYtd EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
INDEX ON CLIENT TAG CLIENT
= STATUSBAR('INVLIYTD.DBF')
USE &mDrive\InvLiYtd EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('CK-YTD.DBF')
USE &mDrive\Ck-Ytd EXCLUSIVE
PACK
INDEX ON NUMBER TAG NUMBER
= STATUSBAR('GL-YTD.DBF')
USE &mDrive\Gl-Ytd EXCLUSIVE
PACK
INDEX ON GJOURNAL+GLTRAN TAG JRNTRAN
INDEX ON GLACCT TAG ACCOUNT
= STATUSBAR('APREO.DBF')
USE &mDrive\ApReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('APLINREO.DBF')
USE &mDrive\ApLinReo EXCLUSIVE
PACK
INDEX ON REOCNUM TAG REOCNUM
= STATUSBAR('ASSETS.DBF')
USE &mDrive\Assets EXCLUSIVE
PACK
INDEX ON ASSETNUM TAG ASSETNUM
= STATUSBAR('BUILD.DBF')
USE &mDrive\Build EXCLUSIVE
PACK
INDEX ON SERVICE+PRODUCT TAG SERPRO
= STATUSBAR('JOBLOG.DBF')
USE &mDrive\JobLog EXCLUSIVE
PACK
INDEX ON JOB+ACCOUNT TAG JOBACCT
= STATUSBAR('LEVELS.DBF')
USE &mDrive\Levels EXCLUSIVE
DELETE FOR LEVEL=SPACE(4)
PACK
INDEX ON SERVICE+LEVEL TAG SERLEVEL
= STATUSBAR('LIFOFIFO.DBF')
USE &mDrive\LifoFifo EXCLUSIVE
PACK
INDEX ON SERVICE+DTOC(DATE) TAG SERDATE
= STATUSBAR('PURYTD.DBF')
USE &mDrive\PurYtd EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('PURLIYTD.DBF')
USE &mDrive\PurLiYtd EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('ORDER.DBF')
USE &mDrive\Order EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
= STATUSBAR('ORDLINE.DBF')
USE &mDrive\OrdLine EXCLUSIVE
PACK
INDEX ON INVOICE TAG INVOICE
USE
IF  .NOT. MLCREATE
   = CALCBALS()
   = FIXCOGS()
ENDIF
RELEASE WINDOW PRN_STAT
IF _FLY
   = OKMSG('Reindex Complete.')
ENDIF
PRGVAR = 0

FUNCTION  PASS_CHK
PARAMETER PLEVEL
IF PASS_LEVEL>PLEVEL
   = OKMSG('Unauthorized Access!!!')
   RETURN .F.
ENDIF

FUNCTION  PASSOK
IF TYPE('MPSS1')='U'
   MPSS0 = 'rln'
   MPSS1 = 'rln'
   MPSS2 = 'rln'
   MPSS3 = 'rln'
   MPSS4 = 'rln'
   MPSS5 = 'rln'
   MPSS6 = 'rln'
   MPSS7 = 'rln'
   MPSS8 = 'rln'
   MPSS9 = 'rln'
ENDIF
IF MPASS1<>SPACE(25) .OR. MPASS2<>SPACE(25) .OR. MPASS3<>SPACE(25) .OR. MPASS4<>SPACE(25) .OR. MPASS5<>SPACE(25) .OR. MPASS6<>SPACE(25) .OR. MPASS7<>SPACE(25) .OR. MPASS8<>SPACE(25) .OR. MPASS9<>SPACE(25) .OR. MPASS0<>SPACE(25)
   NEWPASS = SPACE(25)
   DEFINE WINDOW PASS_OK FROM 10, 10 TO 14, 70 NOFLOAT TITLE 'Password' DOUBLE COLOR RGB(192,192,192,192,192,192)
   ACTIVATE WINDOW PASS_OK
   @ 1, 10 SAY 'Enter Password..:' COLOR RGB(0,0,0,192,192,192)
   TRYS = 2
   PASS_LEVEL = -1
   DO WHILE TRYS>=0 .AND. PASS_LEVEL=-1
      NEWPASS = UPPER(PASSGET(1,30,25,'w+/w*'))
      IF EMPTY(NEWPASS)
         = OKMSG('Invalid Password. Tries left:  '+STR(TRYS,1))
         TRYS = TRYS-1
         LOOP
      ENDIF
      DO CASE
         CASE NEWPASS=MPASS0 .OR. NEWPASS=MPSS0
            PASS_LEVEL = 0
         CASE NEWPASS=MPASS1 .OR. NEWPASS=MPSS1
            PASS_LEVEL = 1
         CASE NEWPASS=MPASS2 .OR. NEWPASS=MPSS2
            PASS_LEVEL = 2
         CASE NEWPASS=MPASS3 .OR. NEWPASS=MPSS3
            PASS_LEVEL = 3
         CASE NEWPASS=MPASS4 .OR. NEWPASS=MPSS4
            PASS_LEVEL = 4
         CASE NEWPASS=MPASS5 .OR. NEWPASS=MPSS5
            PASS_LEVEL = 5
         CASE NEWPASS=MPASS6 .OR. NEWPASS=MPSS6
            PASS_LEVEL = 6
         CASE NEWPASS=MPASS7 .OR. NEWPASS=MPSS7
            PASS_LEVEL = 7
         CASE NEWPASS=MPASS8 .OR. NEWPASS=MPSS8
            PASS_LEVEL = 8
         CASE NEWPASS=MPASS9 .OR. NEWPASS=MPSS9
            PASS_LEVEL = 9
         OTHERWISE
            IF UPPER(NEWPASS)='USER'
               PASS_LEVEL = 0
            ELSE
               = OKMSG('Invalid Password. Tries left:  '+STR(TRYS,1))
               TRYS = TRYS-1
            ENDIF
      ENDCASE
   ENDDO
   RELEASE WINDOW PASS_OK
   IF PASS_LEVEL<0
      RETURN .F.
   ENDIF
ENDIF

PROCEDURE REPHEADER
STORE 0 TO MLINE
@ MLINE+0, 0 SAY SPACE(72)
@ MLINE+1, 0 SAY SPACE(72)
IF TYPE('nPrnSysDt')='U' .OR. (TYPE('nPrnSysDt')='N' .AND. NPRNSYSDT=1)
   @ MLINE+2, 5 SAY 'Date: '
   @ MLINE+2, 11 SAY DATE()
ENDIF
@ MLINE+2, MCOL+36 SAY 'Page No:'
@ MLINE+2, MCOL+46 SAY PAGENO PICTURE '999'
@ MLINE+3, MCOL SAY MREPORT
@ MLINE+4, MCOL SAY CCOMPANY
@ MLINE+5, MCOL SAY CADDRESS1
XLI = 6
IF CADDRESS2<>SPACE(30)
   @ MLINE+XLI, MCOL SAY CADDRESS2
   XLI = 7
ENDIF
IF EMPTY(CSTATE)
   STORE '  ' TO MCSEP1
ELSE
   STORE ', ' TO MCSEP1
ENDIF
@ MLINE+XLI, MCOL SAY TRIM(CCITY)+MCSEP1+CSTATE+' '+CZIP
IF TYPE('cRptTitle')='C'
   @ MLINE+XLI+2, MCOL SAY CRPTTITLE
   @ MLINE+XLI+3, 0 SAY ''
ENDIF
STORE PAGENO+1 TO PAGENO

FUNCTION  PRN_STAT
IF  .NOT. WEXIST('prn_stat')
   DEFINE WINDOW PRN_STAT AT 0.000, 0.000 SIZE 6.063, 85.429 FONT 'MS Sans Serif', 8 NOFLOAT NOCLOSE NOMINIMIZE NONE COLOR RGB(,,,192,192,192)
   MOVE WINDOW PRN_STAT CENTER
ENDIF
IF WVISIBLE('prn_Stat')
   ACTIVATE WINDOW SAME PRN_STAT
ELSE
   ACTIVATE WINDOW NOSHOW PRN_STAT
ENDIF
CLEAR
@ 2.875, 5.286 TO 4.563, 80.000 PEN 1, 8 COLOR RGB(128,128,128,,,),
@ 4.500, 5.429 TO 4.500, 80.000 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 2.938, 79.857 TO 4.563, 79.857 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 2.875, 5.286 TO 4.500, 5.286 PEN 6, 8 COLOR RGB(0,0,128,0,0,128)
@ 0.000, 0.000 TO 6.063, 0.000 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 0.000, 85.286 TO 6.063, 85.286 PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 5.563, 1.000 TO 5.563, 84.714 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 6.000, 0.000 TO 6.000, 85.286 STYLE '1' PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 0.375, 1.000 TO 0.375, 84.857 STYLE '1' PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 0.000, 0.000 TO 0.000, 85.286 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 0.313, 0.857 TO 5.626, 0.857 PEN 1, 8 COLOR RGB(128,128,128,128,128,128)
@ 0.313, 84.571 TO 5.626, 84.571 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
RETURN .T.

PROCEDURE STATUSBAR
PARAMETER MFILE
PRIVATE PROGRESS, M_WIDTH, PERCNT
IF  .NOT. WVISIBLE('prn_stat')
   ACTIVATE WINDOW PRN_STAT
ENDIF
PROGRESS = X/COUNT
M_WIDTH = 5.429+(PROGRESS*75)
@ 2.875, 5.429 TO 4.563, M_WIDTH PATTERN 1 COLOR RGB(0,0,128,0,0,128)
PERCNT = STR(100*PROGRESS)+' %'
IF M_WIDTH<39
   @ 3.188, 39.000 SAY ALLTRIM(PERCNT) FONT 'Arial', 10 STYLE 'B' SIZE 1.000, 8.500 PICTURE '@TI'
ELSE
   @ 3.188, 39.000 SAY ALLTRIM(PERCNT) FONT 'Arial', 10 STYLE 'BT' SIZE 1.000, 8.500 PICTURE '@TI' COLOR RGB(255,255,255,0,0,128)
ENDIF
@ 1, 5 SAY 'Processing: '+MFILE+SPACE(50-LEN(MFILE)) FONT 'Arial', 10
X = X+1
LDBFCREATE = .T.
RETURN

FUNCTION  PASSGET
PARAMETER READ_ROW, READ_COL, WORD_LNGTH, PAS_COLR
RTRN_STR = SPACE(WORD_LNGTH)
CHAR_COUNT = 0
CURS_COL = READ_COL
HLD_CLR = SET('COLOR')
SYSBLNKTME = 0
IF ','$PAS_COLR
   PAS_COLR = SUBSTR(PAS_COLR,AT(',',PAS_COLR)+1)
ENDIF
CURS_COLR = STUFF(PAS_COLR,AT('/',PAS_COLR),0,'*')
SET COLOR TO &pas_colr
@ READ_ROW, READ_COL SAY SPACE(WORD_LNGTH)
DO WHILE .T.
   @read_row,curs_col SAY "" COLOR &curs_colr
   GET_CHAR = INKEY(SYSBLNKTME,'H')
   DO CASE
      CASE BETWEEN(GET_CHAR,32,126)
         GET_CHAR = ASC(UPPER(CHR(GET_CHAR)))
         RTRN_STR = STUFF(RTRN_STR,CURS_COL-READ_COL+1,1,CHR(GET_CHAR))
         SET COLOR TO &pas_colr
         @ READ_ROW, CURS_COL SAY ''
         IF CURS_COL<READ_COL+WORD_LNGTH-1
            CURS_COL = CURS_COL+1
         ELSE
            EXIT
         ENDIF
      CASE GET_CHAR=13 .OR. GET_CHAR=KEY_TAB .OR. GET_CHAR=KEY_DOWN
         EXIT
      CASE GET_CHAR=127
         RTRN_STR = STUFF(RTRN_STR,CURS_COL-READ_COL,1,' ')
         @ READ_ROW, CURS_COL SAY ' '
         IF CURS_COL>READ_COL
            CURS_COL = CURS_COL-1
         ENDIF
      CASE GET_CHAR=27
         RTRN_STR = ''
         EXIT
      CASE GET_CHAR=28
      CASE GET_CHAR=0
      OTHERWISE
         ?? CHR(7)
   ENDCASE
ENDDO
SET COLOR TO &hld_clr
RETURN (RTRN_STR)

PROCEDURE VERSION
ON KEY LABEL CTRL+M 
= OKMSG(_VERSION+' Available Memory '+(STR(MEMORY(),4,0)))
ON KEY LABEL CTRL+M DO Version

PROCEDURE EDIT_AUTOE
ON KEY LABEL CTRL+F8 
MODIFY COMMAND C:\AUTOEXEC.BAT
ON KEY LABEL CTRL+F8 DO Edit_Autoexec

PROCEDURE EDIT_CONFI
ON KEY LABEL CTRL+F9 
MODIFY COMMAND C:\CONFIG.SYS
ON KEY LABEL CTRL+F9 DO Edit_Config

PROCEDURE ISOUND
SET BELL TO 100, 10
?? CHR(7)
SET BELL TO 50, 10
?? CHR(7)
SET BELL TO

PROCEDURE PRNVIEW
SET PRINTER TO
PRIVATE NPRGVAR
NPRGVAR = 800
IF FILE('OUT.TXT')
   DEFINE WINDOW PRNVIEW FROM 3, 1 TO SROWS()-15, 78 GROW FLOAT CLOSE ZOOM TITLE 'Report Viewer' SYSTEM COLOR SCHEME 11
   MODIFY COMMAND out.txt NOEDIT WINDOW PRNVIEW
ENDIF
SET CLOCK STATUS
DELETE FILE out.txt
RETURN

FUNCTION  STOP_IT
RET_PRN = .F.
STORE INKEY() TO STOPKEY
IF STOPKEY<>0
   RET_CONSOL = SYS(100)
   RET_DEVICE = SYS(101)
   RET_PRINTE = SYS(102)
   SET CONSOLE ON
   SET DEVICE TO SCREEN
   SET PRINTER OFF
   IF OKCANMSG('Stop printing report??')
      RET_PRN = .T.
      STOP_PRN = .T.
   ENDIF
   SET CONSOLE &ret_console
   SET DEVICE TO &ret_device
   SET PRINTER &ret_printer
ENDIF
RETURN RET_PRN

FUNCTION  PRN_READY
DO WHILE .T.
   IF UPPER(SENDPRN)<>'PRINTER'
      EXIT
   ENDIF
   IF PRINTSTATUS()
      EXIT
   ENDIF
   IF  .NOT. OKCANMSG('Printer Error. Retry??')
      RETURN .F.
   ENDIF
ENDDO
RETURN .T.

FUNCTION  SCOPE
PARAMETER TMP_TITLE, TMP_SUBTIT, TMP_BROWSE
_TITLE = TMP_TITLE
_SUBTITLE = TMP_SUBTIT
_BROWSE = TMP_BROWSE
_BUTTONS = 2
DO PSCOPE.SPR
IF _BUTTONS=2
   RETURN .F.
ENDIF
RETURN .T.

FUNCTION  OPTION_VAL
PARAMETER _OPTION
RETURN .T.
IF  .NOT. _INIT_LOAD
   RETURN .T.
ENDIF
IF  .NOT. USED('PA7P')
   USE PA7p
ENDIF
SELECT PA7P
LOCATE FOR ALLTRIM(_OPTION)=ALLTRIM(OPTION)
IF LEVEL>PASS_LEVEL
   RETURN .T.
ENDIF
RETURN .F.

FUNCTION  PRO_WHEEL
RETURN .T.
DO CASE
   CASE PIN_COUNTE=1
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk1.bmp','BMP|ICO','Where is x_clk1?')) BITMAP
   CASE PIN_COUNTE=2
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk2.bmp','BMP|ICO','Where is x_clk2?')) BITMAP
   CASE PIN_COUNTE=3
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk3.bmp','BMP|ICO','Where is x_clk3?')) BITMAP
   OTHERWISE
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk4.bmp','BMP|ICO','Where is x_clk4?')) BITMAP
ENDCASE
PIN_TOT = PIN_TOT+1
IF PIN_TOT=10
   PIN_COUNTE = PIN_COUNTE+1
   IF PIN_COUNTE=5
      PIN_COUNTE = 1
   ENDIF
   PIN_TOT = 1
ENDIF
PIN_COUNTE = PIN_COUNTE+1
IF PIN_COUNTE=5
   PIN_COUNTE = 1
ENDIF
RETURN .T.

PROCEDURE PRNMSG
PARAMETER MSGSTRING
WINWIDTH = LEN(MSGSTRING)+10
WINHEIGHT = 7
DEFINE WINDOW PRN_MSG AT 0.000, 0.000 SIZE 8.385, 98.200 FONT 'MS Sans Serif', 8 NOFLOAT NOCLOSE NOMINIMIZE NONE COLOR RGB(,,,192,192,192)
MOVE WINDOW PRN_MSG CENTER
ACTIVATE WINDOW PRN_MSG
@ 0, 0 TO 8.385, 98.200 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.100, 0.100 TO 8.285, 98.100 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.200, 0.200 TO 8.185, 98.000 PEN 1, 8 COLOR RGB(0,0,255,,,),
@ 0.923, 2.400 TO 7.461, 96.200 PEN 1, 8 COLOR RGB(128,128,128,,,),
@ 7.385, 2.400 TO 7.385, 96.200 STYLE '1' PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 0.923, 96.000 TO 7.461, 96.000 PEN 1, 8 COLOR RGB(255,255,255,255,255,255)
@ 2.769, 12.000 SAY (LOCFILE('..\bmpico\x_clock.bmp','BMP|ICO','Where is x_clock?')) BITMAP STYLE 'T' SIZE 2.462, 6.400
@ 5.615, 31.200 SAY 'Press any key to stop printing.....' FONT 'Arial', 10 STYLE 'B'
@ 2, (WCOLS()-TXTWIDTH(MSGSTRING,'Arial',10)*FONTMETRIC(6,'Arial',10)/FONTMETRIC(6))/2 SAY MSGSTRING FONT 'Arial', 10
ACTIVATE WINDOW PRN_MSG
RETURN

FUNCTION  PRN_WHEEL
RETURN .T.
SET DEVICE TO SCREEN
SET CURSOR OFF
DO CASE
   CASE PIN_COUNTE=1
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk1.bmp','BMP|ICO','Where is x_clk1?')) BITMAP
   CASE PIN_COUNTE=2
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk2.bmp','BMP|ICO','Where is x_clk2?')) BITMAP
   CASE PIN_COUNTE=3
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk3.bmp','BMP|ICO','Where is x_clk3?')) BITMAP
   OTHERWISE
      @ 3.500, 72 SAY (LOCFILE('..\bmpico\x_clk4.bmp','BMP|ICO','Where is x_clk4?')) BITMAP
ENDCASE
PIN_TOT = PIN_TOT+1
IF PIN_TOT=10
   PIN_COUNTE = PIN_COUNTE+1
   IF PIN_COUNTE=5
      PIN_COUNTE = 1
   ENDIF
   PIN_TOT = 1
ENDIF
SET CURSOR ON
SET DEVICE TO PRINTER
RETURN .T.

PROCEDURE SOURCE
IF  .NOT. FILE('SOURCE.TXT')
   = OKMSG('File SOURCE.TXT not found')
ELSE
   IF OKCANMSG('Print Source Code Information To Printer??')
      DEFINE WINDOW PRNVIEW FROM 0, 0 TO 1, 1 GROW FLOAT CLOSE ZOOM SYSTEM COLOR SCHEME 11
      = PRNMSG('Printing Source Code Information')
      ACTIVATE WINDOW PRNVIEW
      HIDE WINDOW PRNVIEW
      SET HEADING OFF
      SET PRINTER FONT 'Courier New', 12
      TYPE TO PRINTER SOURCE.TXT
      SET HEADING ON
      RELEASE WINDOW PRNVIEW
      RELEASE WINDOW PRN_MSG
   ELSE
      DEFINE WINDOW PRNVIEW FROM 3, 1 TO SROWS()-2, 78 GROW FLOAT CLOSE ZOOM TITLE 'Painless Source Code Information' SYSTEM COLOR SCHEME 11
      MODIFY COMMAND source.txt NOEDIT WINDOW PRNVIEW
   ENDIF
ENDIF
RETURN

PROCEDURE PRODUCTS
IF  .NOT. FILE('PRODUCTS.TXT')
   = OKMSG('File PRODUCTS.TXT not found')
ELSE
   IF OKCANMSG('Print Product Information To Printer??')
      DEFINE WINDOW PRNVIEW FROM 0, 0 TO 1, 1 GROW FLOAT CLOSE ZOOM SYSTEM COLOR SCHEME 11
      = PRNMSG('Printing Product Information')
      ACTIVATE WINDOW PRNVIEW
      HIDE WINDOW PRNVIEW
      SET HEADING OFF
      SET PRINTER FONT 'Courier New', 12
      TYPE TO PRINTER PRODUCTS.TXT
      SET HEADING ON
      RELEASE WINDOW PRNVIEW
      RELEASE WINDOW PRN_MSG
   ELSE
      DEFINE WINDOW PRNVIEW FROM 3, 1 TO SROWS()-2, 78 GROW FLOAT CLOSE ZOOM TITLE 'Painless Product Information' SYSTEM COLOR SCHEME 11
      MODIFY COMMAND products.txt NOEDIT WINDOW PRNVIEW
   ENDIF
ENDIF
RETURN

PROCEDURE BEG1

PROCEDURE BEG2

PROCEDURE FILESIZES
PRGVAR = 99
DEFINE WINDOW PRN_STAT AT 1, 0 SIZE 26, 80 FONT 'Arial', 9 STYLE 'B' GROW FLOAT NOCLOSE ZOOM TITLE 'Physical Size of Data' COLOR SCHEME 5
MOVE WINDOW PRN_STAT CENTER
ACTIVATE WINDOW PRN_STAT
CLEAR
ARROW = '<====='
@ 1, 2 SAY 'ACCOUNTS'
@ 2, 2 SAY 'ACCOUNT TYPES'
@ 3, 2 SAY 'CLIENTS'
@ 4, 2 SAY 'PRODUCTS/SERVICES/MSGS'
@ 5, 2 SAY 'VENDORS'
@ 6, 2 SAY 'SALESPEOPLE'
@ 7, 2 SAY 'CLIENT RECORDS'
@ 8, 2 SAY 'PRICE LEVELS'
@ 9, 2 SAY 'JOBS'
@ 10, 2 SAY 'JOB RECORDS'
@ 11, 2 SAY 'CASH CLIENTS'
@ 12, 2 SAY 'INVOICES'
@ 13, 2 SAY 'INVOICE LINES'
@ 14, 2 SAY 'INVOICE RECUR'
@ 15, 2 SAY 'INVOICE RECUR LINES'
@ 16, 2 SAY 'CLIENT OPEN INVOICES'
@ 17, 2 SAY 'AR'
@ 18, 2 SAY 'AR LINES'
@ 19, 2 SAY 'PRODUCT COSTS'
@ 20, 2 SAY 'BILL OF MATERIALS'
@ 1, 42 SAY 'AR RECUR'
@ 2, 42 SAY 'AR RECUR LINES'
@ 3, 42 SAY 'GL TRANSACTIONS'
@ 4, 42 SAY 'GL RECUR'
@ 5, 42 SAY 'GL YTD'
@ 6, 42 SAY 'DIRECT CHECKS'
@ 7, 42 SAY 'CHECKS'
@ 8, 42 SAY 'CHECKS YTD'
@ 9, 42 SAY 'PURCHASES'
@ 10, 42 SAY 'PURCHASE LINES'
@ 11, 42 SAY 'VENDOR OPEN INVOICES'
@ 12, 42 SAY 'AP TRANSACTIONS'
@ 13, 42 SAY 'AP LINE'
@ 14, 42 SAY 'AP RECUR'
@ 15, 42 SAY 'AP RECUR LINES'
@ 16, 42 SAY 'INVENTORY ADJUSTMENTS'
@ 17, 42 SAY 'INVOICES YTD'
@ 18, 42 SAY 'INVOICE LINES YTD'
@ 19, 42 SAY 'ORDERS'
@ 20, 42 SAY 'ORDER LINES '
@ 1, 29 SAY ARROW
USE &mDrive\Account
@ 1, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 2, 29 SAY ARROW
USE &mDrive\AccType
@ 2, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 3, 29 SAY ARROW
USE &mDrive\Client
@ 3, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 4, 29 SAY ARROW
USE &mDrive\Service
@ 4, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 5, 29 SAY ARROW
USE &mDrive\Vendor
@ 5, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 6, 29 SAY ARROW
USE &mDrive\SalesMan
@ 6, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 7, 29 SAY ARROW
USE &mDrive\CliNotes
@ 7, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 8, 29 SAY ARROW
USE &mDrive\Levels
@ 8, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 9, 29 SAY ARROW
USE &mDrive\Job
@ 9, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 10, 29 SAY ARROW
USE &mDrive\JobLog
@ 10, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 11, 29 SAY ARROW
USE &mDrive\Cash
@ 11, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 12, 29 SAY ARROW
USE &mDrive\Invoice
@ 12, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 13, 29 SAY ARROW
USE &mDrive\InvLine
@ 13, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 14, 29 SAY ARROW
USE &mDrive\BiReo
@ 14, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 15, 29 SAY ARROW
USE &mDrive\BiLinReo
@ 15, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 16, 29 SAY ARROW
USE &mDrive\ArOpen
@ 16, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 17, 29 SAY ARROW
USE &mDrive\Receiv
@ 17, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 18, 29 SAY ARROW
USE &mDrive\RecLine
@ 18, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 19, 29 SAY ARROW
USE &mDrive\LifoFifo
@ 19, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 20, 29 SAY ARROW
USE &mDrive\Build
@ 20, 29 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 1, 69 SAY ARROW
USE &mDrive\ArReo
@ 1, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 2, 69 SAY ARROW
USE &mDrive\ArLinReo
@ 2, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 3, 69 SAY ARROW
USE &mDrive\GlTran
@ 3, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 4, 69 SAY ARROW
USE &mDrive\GlReo
@ 4, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 5, 69 SAY ARROW
USE &mDrive\Gl-Ytd
@ 5, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 6, 69 SAY ARROW
USE &mDrive\DirChk
@ 6, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 7, 69 SAY ARROW
USE &mDrive\Checks
@ 7, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 8, 69 SAY ARROW
USE &mDrive\Ck-Ytd
@ 8, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 9, 69 SAY ARROW
USE &mDrive\Purchase
@ 9, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 10, 69 SAY ARROW
USE &mDrive\PurLine
@ 10, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 11, 69 SAY ARROW
USE &mDrive\ApOpen
@ 11, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 12, 69 SAY ARROW
USE &mDrive\Payable
@ 12, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 13, 69 SAY ARROW
USE &mDrive\PayLine
@ 13, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 14, 69 SAY ARROW
USE &mDrive\ApReo
@ 14, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 15, 69 SAY ARROW
USE &mDrive\ApLinReo
@ 15, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 16, 69 SAY ARROW
USE &mDrive\Inv-Adj
@ 16, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 17, 69 SAY ARROW
USE &mDrive\InvYtd
@ 17, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 18, 69 SAY ARROW
USE &mDrive\InvLiYtd
@ 18, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 19, 69 SAY ARROW
USE &mDrive\Order
@ 19, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
@ 20, 69 SAY ARROW
USE &mDrive\OrdLine
@ 20, 69 SAY STR(RECCOUNT(),6,0)+SPACE(2)
USE
M.RESP = 1
@ 23, 35 GET M.RESP DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.154, 11.500, 0.667 PICTURE '@*BHT \! '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))
READ CYCLE MODAL
RELEASE WINDOW
PRGVAR = 0

PROCEDURE FOUND_IT
PARAMETER FILE
PRIVATE FILE
RETURN
DEL_FILE = DATA_PATH+'\'+FILE
IF FILE(DEL_FILE)
   IF LEN(DEL_FILE)>25
      MSG = FILE
   ELSE
      MSG = DEL_FILE
   ENDIF
   IF OKCANMSG(MSG+' exist! Overwrite?')
      DELETE FILE (DEL_FILE)
   ENDIF
ENDIF

PROCEDURE PUZZ
PRGVAR = 858
ON KEY LABEL CTRL+Z 
ACTIVATE WINDOW PUZZLE
ON KEY LABEL CTRL+Z DO PUZZ
PRGVAR = 0

PROCEDURE CALC
PRGVAR = 851
ON KEY LABEL CTRL+C 
ACTIVATE WINDOW CALCULATOR
ON KEY LABEL CTRL+C DO CALC
PRGVAR = 0

FUNCTION  SCOPE2
PARAMETER _TITLE, FROMTOOPT, XTYPES
DO CASE
   CASE _WINDOWS
      XLINE = 14
      SET READBORDER ON
      IF FROMTOOPT=0 .OR. FROMTOOPT=8 .OR. FROMTOOPT=10
         DEFINE WINDOW SCOPE AT 0, 0 SIZE 18, 60 FONT 'Arial', 9 FLOAT SHADOW TITLE _TITLE NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
         MOVE WINDOW SCOPE CENTER
      ELSE
         IF FROMTOOPT=4 .OR. FROMTOOPT=5
            XLINE = XLINE+4
            DEFINE WINDOW SCOPE AT 0, 0 SIZE 22, 60 FONT 'Arial', 9 FLOAT SHADOW TITLE _TITLE NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
            MOVE WINDOW SCOPE CENTER
         ELSE
            DEFINE WINDOW SCOPE AT 0, 0 SIZE 18, 60 FONT 'Arial', 9 FLOAT SHADOW TITLE _TITLE NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
            MOVE WINDOW SCOPE CENTER
         ENDIF
      ENDIF
      ACTIVATE WINDOW SCOPE
      _INACTIVE = 0
      REPTYPE = 1
      DO CASE
         CASE XTYPES=0 .OR. XTYPES=1 .OR. XTYPES=11 .OR. XTYPES=12
         CASE XTYPES=2
            @ 4, 5 GET REPTYPE DEFAULT IIF(MLLIGHTVER=.F. .AND. MCICONNAME<>'DLXACC.ICO',1,2) SIZE 1, 20, 0 PICTURE '@*RVN \<Transaction;\<Payments Received' MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
         CASE XTYPES=4
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<A/P Transactions;\<Payments;\<Unposted Checkbook;\<Disbursements' MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
         CASE XTYPES=5
            @ 2, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Trial Balance;\<Income Statement;\<Balance Sheet;\<Account Activity Report;Accounts \<Listing;\<Job Cost Statement' VALID ENABLACTIV() WHEN ENABLACTIV() MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
         CASE XTYPES=6
            @ 3, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<A/R Aging;\<Statement;\<Client Directory;\<Mailing Labels;\<Historical Invoice' VALID ZEROBALANC(2) WHEN ZEROBALANC(1) MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
            @ 12, 5 GET P_FORWARD DEFAULT 1 SIZE 1, 29 PICTURE '@*C Include Zero Balances' MESSAGE 'Check box to include zero balance statements' COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
         CASE XTYPES=7
            @ 3, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<A/P Aging;\<Invoices Due;\<Vendor Directory;\<Mailing Labels' VALID INVDUE() MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
         CASE XTYPES=8
            @ 3, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Client History;\<Vendor History;\<Product History;\<Service History' VALID _HIST_TYPE() MESSAGE 'Select report type' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
      ENDCASE
      DO CASE
         CASE FROMTOOPT=0
         CASE FROMTOOPT=3
            @ 9, 5 SAY 'From: '
            @ 9, 12 GET FIRST PICTURE '!!!!!!!!!!' WHEN FROMOK() MESSAGE 'Starting number' COLOR ,RGB(,,,255,255,255)
            @ 10, 5 SAY 'To..: '
            @ 10, 12 GET LAST PICTURE '!!!!!!!!!!' VALID (LAST>=FIRST) WHEN TOOK() MESSAGE 'Ending number' COLOR ,RGB(,,,255,255,255)
            IF _TITLE='Print Vendor Reports'
               @ 12, 3 SAY 'Invoices Due By'
               @ 12, 21 GET XDATE PICTURE '@D' VALID  .NOT. EMPTY(XDATE) WHEN REPTYPE=2 MESSAGE 'Print invoices due by this date' COLOR ,RGB(,,,255,255,255)
            ENDIF
         CASE FROMTOOPT=4
            @ 9, 4 SAY 'From:'
            @ 10, 4 SAY 'To..:'
            @ 14, 4 SAY 'Department'
            @ 15, 4 SAY 'From:'
            @ 16, 4 SAY 'To..:'
            @ 14, 24 SAY 'Class'
            @ 15, 24 SAY 'From:'
            @ 16, 24 SAY 'To..:'
            @ 9, 11 GET FIRST PICTURE '!!!!!!!!!!' MESSAGE 'Starting code to print' COLOR ,RGB(,,,255,255,255)
            @ 10, 11 GET LAST PICTURE '!!!!!!!!!!' VALID LAST>=FIRST MESSAGE 'Ending code to print' COLOR ,RGB(,,,255,255,255)
            @ 15, 11 GET DEPTFROM PICTURE '99999' WHEN REPTYPE>2 MESSAGE 'Starting department to print' COLOR ,RGB(,,,255,255,255)
            @ 16, 11 GET DEPTTO PICTURE '99999' VALID DEPTTO>=DEPTFROM WHEN REPTYPE>2 MESSAGE 'Ending department to print' COLOR ,RGB(,,,255,255,255)
            @ 15, 32 GET CLASSFROM PICTURE '99999' WHEN REPTYPE>2 MESSAGE 'Starting class to print' COLOR ,RGB(,,,255,255,255)
            @ 16, 32 GET CLASSTO PICTURE '99999' VALID CLASSTO>=CLASSFROM WHEN REPTYPE>2 MESSAGE 'Ending class to print' COLOR ,RGB(,,,255,255,255)
         CASE FROMTOOPT=5
            @ 9, 5 SAY 'Job: '
            @ 9, 12 GET FIRST PICTURE '!!!!!!!!!!' WHEN REPTYPE=6 MESSAGE 'Job number' COLOR ,RGB(,,,255,255,255)
            @ 11, 3 GET _INACTIVE DEFAULT 1 SIZE 1, 29 PICTURE '@*C Include Inactive Accounts' WHEN REPTYPE<>5 MESSAGE 'Check box to include inactive accounts' COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
            @ 14, 5 SAY 'Report Title: '
            @ 14, 19 GET CRPTTITLE WHEN REPTYPE<>4 .AND. REPTYPE<>5 COLOR ,RGB(,,,255,255,255)
            @ 16, 5 GET NPRNSYSDT SIZE 1, 29 PICTURE '@*C Print System Date on the Report' WHEN REPTYPE<>4 .AND. REPTYPE<>5 COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
         CASE FROMTOOPT=8
            @ 5, 5 SAY 'Recurring Code' COLOR ,RGB(,,,255,255,255) GET RCODE PICTURE '9' MESSAGE 'Recurring code to print for'
            @ 9, 5 SAY 'Range Of G/L Journal No.'
            @ 10, 5 SAY 'From: '
            @ 10, 12 GET FIRST PICTURE '!!' WHEN FROMOK() MESSAGE 'Starting journal' COLOR ,RGB(,,,255,255,255)
            @ 11, 5 SAY 'To..: '
            @ 11, 12 GET LAST PICTURE '!!' VALID (LAST>=FIRST) WHEN TOOK() MESSAGE 'Ending journal' COLOR ,RGB(,,,255,255,255)
         CASE FROMTOOPT=10
            @ 9, 5 SAY 'Recurring Code' COLOR ,RGB(,,,255,255,255) GET RCODE PICTURE '9' MESSAGE 'Recurring code to print for'
      ENDCASE
      _SEND_OUT = AT(PRNDEF,'PSF')
      @ 11, 38 SAY 'Filename: '
      @ 4, 36 SAY 'Printer' FONT 'Arial', 9 STYLE 'T'
      @ 4, 44 SAY 'Screen' FONT 'Arial', 9 STYLE 'T'
      @ 4, 54 SAY 'File' FONT 'Arial', 9 STYLE 'T'
      @ 5, 35 GET _SEND_OUT DEFAULT 2 FONT 'Arial', 9 SIZE 2.923, 08.000, 0.1 PICTURE '@*RBHN '+(LOCFILE('..\bmpico\x_report.bmp','BMP|ICO','Where is x_report?'))+';'+(LOCFILE('..\bmpico\x_screen.bmp','BMP|ICO','Where is x_screen?'))+';'+(LOCFILE('..\bmpico\x_disk04.bmp','BMP|ICO','Where is x_disk04?')) VALID RPRTCHOICE() WHEN RPRTWHEN() MESSAGE 'Where to send report' COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
      @ 8.500, 38 GET NPRNTSETUP DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 1.769, 14.500, 0.667 PICTURE '@*HN \<Printer Setup' VALID _R2S1A92WT() MESSAGE 'Select the printer to print your reports to'
      @ 12, 38 GET XFILENAME DEFAULT ' ' SIZE 1, 20 PICTURE '@!' WHEN _SEND_OUT=3 MESSAGE 'Enter filename for report' COLOR ,RGB(,,,255,255,255)
      @ XLINE, 15 GET _BUTTONS DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.462, 12.833, 0.667 PICTURE '@*BHT \! '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))+';'+(LOCFILE('..\bmpico\x_cancl2.bmp','BMP|ICO','Where is x_cancl2?'))
      READ CYCLE WHEN SCP_MNU(XTYPES) MODAL
      RELEASE WINDOW
      RELEASE MENU
   OTHERWISE
      XLINE = 14
      SET READBORDER ON
      IF FROMTOOPT=0 .OR. FROMTOOPT=5 .OR. FROMTOOPT=8 .OR. FROMTOOPT=10
         DEFINE WINDOW SCOPE FROM 2, 10 TO 19, 70 FONT 'Arial', 9 STYLE 'N' SHADOW TITLE ' Scope Information ' FOOTER ' F8-Accept  ESC-Exit ' DOUBLE COLOR SCHEME 5
      ELSE
         IF FROMTOOPT=4
            XLINE = XLINE+4
            DEFINE WINDOW SCOPE FROM 2, 10 TO 23, 70 FONT 'Arial', 9 STYLE 'N' SHADOW TITLE ' Scope Information ' FOOTER ' F4-Browse  F8-Accept  ESC-Exit ' DOUBLE COLOR SCHEME 5
         ELSE
            DEFINE WINDOW SCOPE FROM 2, 10 TO 19, 70 FONT 'Arial', 9 STYLE 'N' SHADOW TITLE ' Scope Information ' FOOTER ' F4-Browse  F8-Accept  ESC-Exit ' DOUBLE COLOR SCHEME 5
         ENDIF
      ENDIF
      ACTIVATE WINDOW SCOPE
      _INACTIVE = 0
      @ 1, (60-LEN(ALLTRIM(_TITLE)))/2 SAY _TITLE
      REPTYPE = 1
      DO CASE
         CASE XTYPES=0 .OR. XTYPES=1 .OR. XTYPES=11 .OR. XTYPES=12
         CASE XTYPES=2
            @ 4, 5 GET REPTYPE DEFAULT IIF(MLLIGHTVER=.F. .AND. MCICONNAME<>'DLXACC.ICO',1,2) SIZE 1, 20, 0 PICTURE '@*RVN \<Transaction;\<Payments Received' MESSAGE 'Select report type'
         CASE XTYPES=4
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Transactions;\<Payments;\<Unposted Checkbook;D\<isbursements' MESSAGE 'Select report type'
         CASE XTYPES=5
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Trial Balance;\<Income Statement;\<Balance Sheet;\<Accounts Listing;\<Job Cost Statement' VALID ENABLACTIV() MESSAGE 'Select report type'
         CASE XTYPES=6
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Aging;\<Statement;\<Directory;\<Labels;\<Historical' MESSAGE 'Select report type'
         CASE XTYPES=7
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Aging;\<Invoices Due;\<Directory;\<Labels' MESSAGE 'Select report type'
         CASE XTYPES=8
            @ 4, 5 GET REPTYPE DEFAULT 1 SIZE 1, 20, 0 PICTURE '@*RVN \<Client;\<Vendor;\<Product;\<Service' VALID _HIST_TYPE() MESSAGE 'Select report type'
      ENDCASE
      DO CASE
         CASE FROMTOOPT=0
         CASE FROMTOOPT=3
            @ 10, 5 SAY 'From: '
            @ 10, 12 GET FIRST PICTURE '!!!!!!!!!!' WHEN FROMOK() MESSAGE 'Starting number'
            @ 11, 5 SAY 'To..: '
            @ 11, 12 GET LAST PICTURE '!!!!!!!!!!' VALID (LAST>=FIRST) WHEN TOOK() MESSAGE 'Ending number'
            IF _TITLE='Print Vendor Reports'
               @ 12, 5 SAY 'Invoices Due By'
               @ 12, 21 GET XDATE PICTURE '@D' VALID  .NOT. EMPTY(XDATE) WHEN REPTYPE=2 MESSAGE 'Print invoice due by this date'
            ENDIF
         CASE FROMTOOPT=4
            @ 9, 4 SAY 'From:'
            @ 10, 4 SAY 'To..:'
            @ 11, 4 SAY 'Department'
            @ 12, 4 SAY 'From:'
            @ 13, 4 SAY 'To..:'
            @ 14, 4 SAY 'Class'
            @ 15, 4 SAY 'From:'
            @ 16, 4 SAY 'To..:'
            @ 9, 11 GET FIRST PICTURE '!!!!!!!!!!' MESSAGE 'Starting code to print'
            @ 10, 11 GET LAST PICTURE '!!!!!!!!!!' VALID LAST>=FIRST MESSAGE 'Ending code to print'
            @ 12, 11 GET DEPTFROM PICTURE '99999' WHEN REPTYPE>2 MESSAGE 'Starting department to print'
            @ 13, 11 GET DEPTTO PICTURE '99999' VALID DEPTTO>=DEPTFROM WHEN REPTYPE>2 MESSAGE 'Ending department to print'
            @ 15, 11 GET CLASSFROM PICTURE '99999' WHEN REPTYPE>2 MESSAGE 'Starting class to print'
            @ 16, 11 GET CLASSTO PICTURE '99999' VALID CLASSTO>=CLASSFROM WHEN REPTYPE>2 MESSAGE 'Ending class to print'
         CASE FROMTOOPT=5
            @ 9, 5 SAY 'Job: '
            @ 9, 12 GET FIRST PICTURE '!!!!!!!!!!' WHEN REPTYPE=5 MESSAGE 'Job number'
            @ 11, 5 GET _INACTIVE DEFAULT 1 SIZE 1, 29 PICTURE '@*C Include Inactive Accounts' WHEN REPTYPE<>5 MESSAGE 'Check box to include inactive accounts'
         CASE FROMTOOPT=8
            @ 8, 5 SAY 'Recurring Code' GET RCODE PICTURE '9' MESSAGE 'Recurring code to print for'
            @ 10, 5 SAY 'From: '
            @ 10, 12 GET FIRST PICTURE '!!' WHEN FROMOK() MESSAGE 'Starting journal'
            @ 11, 5 SAY 'To..: '
            @ 11, 12 GET LAST PICTURE '!!' VALID (LAST>=FIRST) WHEN TOOK() MESSAGE 'Ending journal'
         CASE FROMTOOPT=10
            @ 9, 5 SAY 'Recurring Code' GET RCODE PICTURE '9' MESSAGE 'Recurring code to print for'
      ENDCASE
      _SEND_OUT = AT(PRNDEF,'PSF')
      @ 9, 35 SAY 'Filename: '
      @ 4, 40 SAY 'Send Report To:'
      @ 9, 35 SAY 'Filename: '
      @ 5, 40 GET _SEND_OUT DEFAULT 2 SIZE 1, 11, 0 PICTURE '@*RVN \<Printer;\<Screen;\<File' MESSAGE 'Where to send report'
      @ 10, 35 GET XFILENAME DEFAULT ' ' SIZE 1, 20 PICTURE '@!' WHEN _SEND_OUT=3 MESSAGE 'Enter filename for report'
      @ XLINE, 19 GET _BUTTONS DEFAULT 1 FONT 'Arial', 9 SIZE 3, 10, 3 PICTURE '@*HT \! \<Ok ;\? \<Cancel '
      READ CYCLE WHEN SCP_MNU(XTYPES) MODAL
      RELEASE WINDOW
      RELEASE MENU
ENDCASE
IF LASTKEY()=27 .OR. _BUTTONS=2
   STOP_PRN = .T.
   RETURN .F.
ENDIF
IF _INACTIVE=1
   REPRINT = .T.
ENDIF
DO CASE
   CASE _SEND_OUT=2
      SENDPRN = 'SCREEN'
   CASE _SEND_OUT=3
      SENDPRN = 'FILE'
   OTHERWISE
      SENDPRN = 'PRINTER'
ENDCASE
IF  .NOT. PRN_READY()
   RETURN .F.
ENDIF
RETURN .T.

FUNCTION  FROMOK
IF XTYPES=4
   IF REPTYPE=4
      RETURN .T.
   ENDIF
   RETURN .F.
ENDIF

FUNCTION  TOOK
IF XTYPES=4
   IF REPTYPE=4
      RETURN .T.
   ENDIF
   RETURN .F.
ENDIF

FUNCTION  _HIST_TYPE
DO CASE
   CASE REPTYPE=1
      _BROWSE = 'CLIENT'
   CASE REPTYPE=2
      _BROWSE = 'VENDOR'
   CASE REPTYPE=3
      _BROWSE = 'PRODUCT'
   CASE REPTYPE=4
      _BROWSE = 'SERVICE'
ENDCASE
RETURN .T.

FUNCTION  STA_SCOPE
DEFINE WINDOW STA_SCOPE AT 0, 0 SIZE 15, 60 FONT 'Arial', 9 STYLE 'B' FLOAT SHADOW TITLE 'Client Statement' NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
DEFINE POPUP _QDE1CQCJN PROMPT FIELDS NAME MARK '' MARGIN SCROLL
MOVE WINDOW STA_SCOPE CENTER
ACTIVATE WINDOW STA_SCOPE
_NAME = 1
@ 1, 1 GET P_FORWARD DEFAULT 1 SIZE 1, 29 PICTURE '@*C Include Zero Balances' MESSAGE 'Check box to include zero balance statements' COLOR ,,,,,,,,RGB(,,,192,192,192),RGB(,,,192,192,192)
@ 4, 6 SAY 'From:'
@ 4, 13 GET BDATE DEFAULT ' ' SIZE 1, 8 PICTURE '99/99/99' MESSAGE 'Starting statement scope date' COLOR ,RGB(,,,255,255,255)
@ 5, 13 GET EDATE DEFAULT ' ' SIZE 1, 8 PICTURE '99/99/99' MESSAGE 'Enter ending statement date scope' COLOR ,RGB(,,,255,255,255)
@ 10, 19 GET _BUTT2 DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.462, 12.500, 0.667 PICTURE '@*BHT \! '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))+';'+(LOCFILE('..\bmpico\x_cancl2.bmp','BMP|ICO','Where is x_cancl2?'))
@ 3, 3 SAY 'Statement Scope Date:'
@ 5, 6 SAY 'To..:'
READ CYCLE MODAL
RELEASE WINDOW STA_SCOPE
IF _BUTT2=2 .OR. LASTKEY()=27
   RETURN .F.
ENDIF
RETURN .T.

PROCEDURE GLRPT
PRGVAR = 71
DO WHILE .T.
   REPTYPE = 1
   REPRINT = .F.
   FIRST = '          '
   XFILENAME = 'REPORT.TXT'+SPACE(20)
   STOP_PRN = .F.
   _SEND_OUT = 1
   CYEAR = RIGHT(STR(YEAR(DATE()),4),2)
   CRPTTITLE = 'Report for the Period '+CMONTH(DATE())+"'"+CYEAR
   CRPTTITLE = CRPTTITLE+SPACE(40-LEN(CRPTTITLE))
   NPRNSYSDT = 1
   IF  .NOT. SCOPE2('Print Ledger Reports',5,5)
      EXIT
   ENDIF
   DO CASE
      CASE REPTYPE=1
         DO P711TRL
      CASE REPTYPE=2
         DO INCOMEST
      CASE REPTYPE=3
         DO BALSHEET
      CASE REPTYPE=4
         DO ActActiv.Spr
      CASE REPTYPE=5
         DO P714COA
      CASE REPTYPE=6
         DO P715JOB
   ENDCASE
   CLOSE DATABASES
ENDDO
PRGVAR = 0
RETURN

PROCEDURE ARRPT
PRGVAR = 72
DO WHILE .T.
   P_FORWARD = 1
   REPTYPE = 1
   REPRINT = .F.
   XFILENAME = 'REPORT.TXT'+SPACE(20)
   STOP_PRN = .F.
   _SEND_OUT = 1
   XDATE = DATE()
   FIRST = 'FIRST     '
   LAST = 'LAST      '
   SELECT 0
   USE (MDRIVE+'\Client') ORDER Client
   IF  .NOT. SCOPE2('Print Client Reports',3,6)
      CLOSE DATABASES
      EXIT
   ENDIF
   CLOSE DATABASES
   DO CASE
      CASE REPTYPE=1
         DO P721CAG
      CASE REPTYPE=2
         BDATE = CTOD('01/01/01')
         EDATE = DATE()
         IF  .NOT. USED('DOCGEN')
            USE IN 0 (MDRIVE+'\DOCGEN')
         ENDIF
         SELECT DOCGEN
         PRIVATE MCFORMNO, MLCOMPHEAD
         MCFORMNO = DOCGEN.STAFORM
         MLCOMPHEAD = DOCGEN.COMPHEAD
         USE
         SELECT 10
         USE &mDrive\Forms ALIAS FormsDB
         SET FILTER TO RIGHT(TRIM(NAME),3)='STA'
         GOTO TOP
         MLEN = 0
         ILINES = 0
         DO WHILE  .NOT. EOF()
            IF ALLTRIM(FORMSDB.NAME)=ALLTRIM(MCFORMNO)
               MLEN = WIDTH
               ILINES = LINES
               EXIT
            ENDIF
            SKIP
         ENDDO
         XFILE = ALLTRIM(MCFORMNO)
         CLOSE DATABASES
         DO P722CST WITH IIF(P_FORWARD=0,.F.,.T.)
      CASE REPTYPE=3
         DO P723CDR
      CASE REPTYPE=4
         DO P724CLB
      CASE REPTYPE=5
         DO P725CIN
   ENDCASE
   CLOSE DATABASES
ENDDO
PRGVAR = 0
RETURN

PROCEDURE APRPT
PRGVAR = 73
DO WHILE .T.
   REPTYPE = 1
   REPRINT = .F.
   XDATE = DATE()
   XFILENAME = 'REPORT.TXT'+SPACE(20)
   STOP_PRN = .F.
   _SEND_OUT = 1
   FIRST = 'FIRST     '
   LAST = 'LAST      '
   SELECT 0
   USE (MDRIVE+'\Vendor') ORDER Vendor
   IF  .NOT. SCOPE2('Print Vendor Reports',3,7)
      CLOSE DATABASES
      EXIT
   ENDIF
   CLOSE DATABASES
   DO CASE
      CASE REPTYPE=1
         DO P731VAG
      CASE REPTYPE=2
         DO DUE2VEND
      CASE REPTYPE=3
         DO P732VDR
      CASE REPTYPE=4
         DO P733VLB
   ENDCASE
   CLOSE DATABASES
ENDDO
PRGVAR = 0
RETURN

PROCEDURE HIRPT
PRGVAR = 79
DO WHILE .T.
   REPTYPE = 1
   REPRINT = .F.
   XFILENAME = 'REPORT.TXT'+SPACE(20)
   STOP_PRN = .F.
   _SEND_OUT = 1
   FIRST = 'FIRST     '
   LAST = 'LAST      '
   DEPTFROM = 0
   DEPTTO = 99999
   CLASSFROM = 0
   CLASSTO = 99999
   SELECT 0
   USE (MDRIVE+'\Client') ORDER Client
   SELECT 0
   USE (MDRIVE+'\Vendor') ORDER Vendor
   SELECT 0
   USE (MDRIVE+'\Service') ORDER Service
   SELECT CLIENT
   IF  .NOT. SCOPE2('Historical Reports',4,8)
      CLOSE DATABASES
      EXIT
   ENDIF
   CLOSE DATABASES
   DO CASE
      CASE REPTYPE=1
         DO P791CLI
      CASE REPTYPE=2
         DO P792VEN
      CASE REPTYPE=3
         DO P793PRO
      CASE REPTYPE=4
         DO P794SER
   ENDCASE
   CLOSE DATABASES
ENDDO
PRGVAR = 0
RETURN

FUNCTION  SCP_MNU
PARAMETER _TYPE
PUBLIC _BROWSE
DO CASE
   CASE _TYPE=5 .OR. _TYPE=2 .OR. _TYPE=0 .OR. _TYPE=4
      DO P70SCP.MPR
   CASE _TYPE=6 .OR. _TYPE=8
      _BROWSE = 'CLIENT'
      DO P70SCP_B.MPR
   CASE _TYPE=7
      _BROWSE = 'VENDOR'
      DO P70SCP_B.MPR
   CASE _TYPE=1
      _BROWSE = 'MESSAGE'
      DO P70SCP_B.MPR
   CASE _TYPE=11
      _BROWSE = 'JOB'
      DO P70SCP_B.MPR
   CASE _TYPE=12
      _BROWSE = 'SALESMAN'
      DO P70SCP_B.MPR
ENDCASE
IF _SEND_OUT<>3
   SHOW GET XFILENAME DISABLE
ENDIF
IF MLLIGHTVER=.T. .AND. XTYPES=6 .AND. MCICONNAME<>'DLXACC.ICO'
   SHOW GET REPTYPE, 5 DISABLE
ENDIF
IF MLLIGHTVER=.T. .AND. PRGVAR=43 .AND. MCICONNAME<>'DLXACC.ICO'
   SHOW GET REPTYPE, 1 DISABLE
ENDIF
RETURN .T.

FUNCTION  PSSCOPE
_OK = .T.
DO P741SER.SPR
RETURN _OK

FUNCTION  AADD
PARAMETER ZACCOUNT, ZTYPE, ZDESC
SELECT ACCOUNT
SEEK '&zAccount'
IF EOF()
   APPEND BLANK
   REPLACE ACCOUNT WITH ZACCOUNT
   REPLACE ACCTNAME WITH 'Added during '+ZDESC+' Posting'
   REPLACE ACCTTYPE WITH ZTYPE
ENDIF
RETURN .T.

FUNCTION  VADD
PARAMETER ZVENDOR, ZDESC
SELECT VENDOR
SEEK '&zVendor'
IF EOF()
   APPEND BLANK
   REPLACE VENDOR WITH ZVENDOR
   REPLACE COMPANY WITH 'Added during '+ZDESC+' Posting'
ENDIF
RETURN .T.

FUNCTION  CADD
PARAMETER ZCLIENT, ZSMAN, ZDESC
SELECT CLIENT
SEEK '&zClient'
IF EOF()
   APPEND BLANK
   REPLACE CLIENT WITH ZCLIENT
   IF CALCCOMM
      REPLACE SLS WITH ZSMAN
   ENDIF
   REPLACE COMPANY WITH 'Added during '+ZDESC+' Posting'
ENDIF
RETURN .T.

FUNCTION  PADD
PARAMETER ZSERVICE, ZSALES, ZCOGS, ZDESC, JNCOST
SELECT SERVICE
SEEK '&zService'
IF EOF()
   APPEND BLANK
   REPLACE SERVICE WITH ZSERVICE
   REPLACE SERVDESC WITH 'Added during '+ZDESC+' Posting'
   REPLACE TYPE WITH 'P'
   REPLACE PSALES WITH ZSALES
   REPLACE PCOGS WITH ZCOGS
   REPLACE COST WITH JNCOST
ENDIF
RETURN .T.

FUNCTION  SADD
PARAMETER ZSERVICE, ZSALES, ZDESC
SELECT SERVICE
SEEK '&zService'
IF EOF()
   APPEND BLANK
   REPLACE SERVICE WITH ZSERVICE
   REPLACE SERVDESC WITH 'Added during '+ZDESC+' Posting'
   REPLACE TYPE WITH ' '
   REPLACE PSALES WITH ZSALES
ENDIF
RETURN .T.

FUNCTION  LADD
PARAMETER ZSMAN, ZDESC
SELECT SALESMAN
SEEK '&zSman'
IF EOF()
   APPEND BLANK
   REPLACE S_PERSON WITH ZSMAN
   REPLACE S_NAME WITH 'Added during '+ZDESC+' Posting'
ENDIF
RETURN .T.

FUNCTION  JADD
PARAMETER ZJOB, ZDESC
SELECT JOB
SEEK '&zJob'
IF EOF()
   APPEND BLANK
   REPLACE JOB WITH ZJOB
   REPLACE JOBNAME WITH 'Added during '+ZDESC+' Posting'
ENDIF
RETURN .T.

FUNCTION  ARADD
PARAMETER ZINVOICE, ZCLIENT, ZDATE, ZDUE, ZAMOUNT, ZTYPE, ZDESC
SELECT AROPEN
APPEND BLANK
REPLACE ARINVOICE WITH ZINVOICE
REPLACE ARCLIENT WITH ZCLIENT
REPLACE ARVISIT WITH ZDATE
REPLACE ARDUEDATE WITH ZDUE
REPLACE ARINVBAL WITH ZAMOUNT
REPLACE ARPAYMENT WITH 0
REPLACE ARTYPE WITH ' '
REPLACE ARHOLD WITH 'N'
REPLACE ARPOSTED WITH '_'
REPLACE ARDESC WITH ZDESC
REPLACE ARCODE WITH ZTYPE
RETURN .T.

FUNCTION  ADDWHAT
IF  .NOT. WEXIST('what2add')
   DEFINE WINDOW WHAT2ADD AT 0, 0 SIZE 10, 24 FONT 'Arial', 9 STYLE 'B' FLOAT SHADOW TITLE 'ITEM SELECTION' NOMINIMIZE DOUBLE COLOR RGB(,,,192,192,192)
   MOVE WINDOW WHAT2ADD CENTER
ENDIF
M.RESP = 1
ACTIVATE WINDOW NOSHOW WHAT2ADD
@ 5, 6.000 GET M.RESP DEFAULT 1 FONT 'MS Sans Serif', 8 STYLE 'B' SIZE 3.154, 11.500, 0.667 PICTURE '@*BHT '+(LOCFILE('..\bmpico\x_ok2.bmp','BMP|ICO','Where is x_ok2?'))
@ 1, 6 GET M.WHAT2ADD DEFAULT 1 SIZE 1, 11, 0 PICTURE '@*RVN \<Product;\<Service;\<Message' MESSAGE 'Type of item to add' COLOR ,,,,,,,,RGB(0,0,0,192,192,192),RGB(0,0,0,192,192,192)
ACTIVATE WINDOW WHAT2ADD
_CUROBJ = OBJNUM(M.RESP)
READ CYCLE MODAL NOLOCK
RELEASE WINDOW WHAT2ADD
RETURN (WHAT2ADD)

PROCEDURE EXDOS
RET_PATH = SYS(2003)
ON KEY LABEL CTRL+X 
SAVE SCREEN TO EX_DOS
DEFINE WINDOW X_DOS FROM 0, 0 TO 24, 79 COLOR N,N,N,N,N 
ACTIVATE WINDOW X_DOS
CLEAR
set default to &ret_path
RELEASE WINDOW
RESTORE SCREEN FROM EX_DOS
ON KEY LABEL CTRL+X DO EXDOS
RETURN

PROCEDURE CHKDSK
SAVE SCREEN TO EX_DOS
DEFINE WINDOW X_DOS FROM 0, 0 TO 24, 79 COLOR N,N,N,N,N 
ACTIVATE WINDOW X_DOS
CLEAR
RUN CLS
RUN chkdsk /f
RELEASE WINDOW
RESTORE SCREEN FROM EX_DOS
RETURN

FUNCTION  RPT_SETUP
PARAMETER _CONDENSE
SET PRINTER OFF
IF _WINDOWS
   IF FILE(MDRIVE+'\PRINTER.MEM')
      RESTORE FROM (MDRIVE+'\PRINTER.MEM') ADDITIVE
   ELSE
      WIN_P_NORM = 'FoxPrint,12,B'
      WIN_P_COND = 'FoxPrint,7,B'
      WIN_P_NLEN = 65
      WIN_P_CLEN = 90
   ENDIF
   IF _CONDENSE
      SET PRINTER FONT 'Foxprint', 7
      _PLENGTH = WIN_P_CLEN
   ELSE
      SET PRINTER FONT 'FoxPrint', 12
      _PLENGTH = WIN_P_NLEN
   ENDIF
ELSE
   _PLENGTH = 55
ENDIF
IF _PLINENO>1
   SET PRINTER TO nul
   EJECT
   SET PRINTER TO
ENDIF
DO CASE
   CASE UPPER(SENDPRN)='FILE'
      SET PRINTER TO &xfilename
      MCFILETOMO = UPPER(ALLTRIM(XFILENAME))
   CASE UPPER(SENDPRN)='SCREEN'
      SET PRINTER TO out.txt
      MCFILETOMO = 'OUT.TXT'
ENDCASE
SET PRINTER ON
SET DEVICE TO PRINTER
IF _CONDENSE .AND. _DOS
   @ 0,0 say CHR(&sc1)+CHR(&sc2)+CHR(&sc3)+CHR(&sc4)+CHR(&sc5)+CHR(&sc6)
ENDIF
RETURN .T.

FUNCTION  RPT_RESET
PARAMETER _CONDENSE
SET PRINTER OFF
SET DEVICE TO SCREEN
SET PRINTER TO
IF PRN_PORT='LPT1' .OR. EMPTY(PRN_PORT)
   JCOLDALIAS = ALIAS()
   SELECT 0
   PRN_PORT = ''
   SET PRINTER OFF
   IF  .NOT. EMPTY(JCOLDALIAS)
      select &jcOldAlias
   ENDIF
ELSE
   SET PRINTER TO &prn_port
ENDIF
IF _WINDOWS
   IF FILE(MDRIVE+'\PRINTER.MEM')
      RESTORE FROM (MDRIVE+'\PRINTER.MEM') ADDITIVE
   ENDIF
   WIN_P_NORM = 'FoxPrint,10,B'
   SET PRINTER FONT (SUBSTR(WIN_P_NORM,1,AT(',',WIN_P_NORM)-1)), VAL(SUBSTR(WIN_P_NORM,AT(',',WIN_P_NORM)+1,RAT(',',WIN_P_NORM)-AT(',',WIN_P_NORM)-1))
ENDIF
RELEASE WINDOW PRN_MSG
= CHANGEFILE()
IF UPPER(SENDPRN)='SCREEN' .AND. STOP_PRN=.F.
   DO PRNVIEW
ENDIF
ACTIVATE MENU _MSYSMENU NOWAIT
RETURN .T.

PROCEDURE DUMMY_MENU
SET SYSMENU TO
SET SYSMENU AUTOMATIC
DEFINE PAD _QFX0R9ZE1 OF _MSYSMENU PROMPT '' COLOR SCHEME 3
ON PAD _QFX0R9ZE1 OF _MSYSMENU PAD POPUP _QFX0R9I3D
DEFINE POPUP _QFX0R9I3D SHADOW MARGIN RELATIVE COLOR SCHEME 4
DEFINE BAR 1 OF _QFX0R9I3D PROMPT ''

PROCEDURE UP_FILES
RETURN
USE EXCLUSIVE (MDRIVE)+'\SERVICE'
IF TYPE('VAT')='U'
   = PROMSG('Updating File Structures')
   USE EXCLUSIVE (MDRIVE)+'\CLIENT'
   COPY TO (MDRIVE)+'\CLISTRU' STRUCTURE EXTENDED
   COPY TO (MDRIVE)+'\OLDCLI'
   USE EXCLUSIVE (MDRIVE)+'\CLISTRU'
   LOCATE FOR FIELD_NAME=='VAT'
   IF  .NOT. FOUND()
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'VAT'
      REPLACE FIELD_TYPE WITH 'C'
      REPLACE FIELD_LEN WITH 1
      CREATE (MDRIVE)+'\CLIENT' FROM (MDRIVE)+'\CLISTRU'
      USE EXCLUSIVE (MDRIVE)+'\CLIENT'
      APPEND FROM (MDRIVE)+'\OLDCLI' FOR  .NOT. DELETED()
      DELETE FILE (MDRIVE)+'\CLISTRU.DBF'
      INDEX ON CLIENT TAG CLIENT
   ENDIF
   USE EXCLUSIVE (MDRIVE)+'\VENDOR'
   COPY TO (MDRIVE)+'\VENSTRU' STRUCTURE EXTENDED
   COPY TO (MDRIVE)+'\OLDVEN'
   USE EXCLUSIVE (MDRIVE)+'\VENSTRU'
   LOCATE FOR FIELD_NAME='VAT '
   IF  .NOT. FOUND()
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'VAT'
      REPLACE FIELD_TYPE WITH 'C'
      REPLACE FIELD_LEN WITH 1
      CREATE (MDRIVE)+'\VENDOR' FROM (MDRIVE)+'\VENSTRU'
      USE EXCLUSIVE (MDRIVE)+'\VENDOR'
      APPEND FROM (MDRIVE)+'\OLDVEN' FOR  .NOT. DELETED()
      DELETE FILE (MDRIVE)+'\VENSTRU.DBF'
      INDEX ON VENDOR TAG VENDOR
   ENDIF
   USE EXCLUSIVE (MDRIVE)+'\SERVICE'
   COPY TO (MDRIVE)+'\SERSTRU' STRUCTURE EXTENDED
   COPY TO (MDRIVE)+'\OLDSER'
   USE EXCLUSIVE (MDRIVE)+'\SERSTRU'
   LOCATE FOR FIELD_NAME='VAT '
   IF  .NOT. FOUND()
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'VAT'
      REPLACE FIELD_TYPE WITH 'C'
      REPLACE FIELD_LEN WITH 1
      CREATE (MDRIVE)+'\SERVICE' FROM (MDRIVE)+'\SERSTRU'
      USE EXCLUSIVE (MDRIVE)+'\SERVICE'
      APPEND FROM (MDRIVE)+'\OLDSER' FOR  .NOT. DELETED()
      DELETE FILE (MDRIVE)+'\SERSTRU.DBF'
      INDEX ON SERVICE TAG SERVICE
   ENDIF
   RELEASE WINDOW
ENDIF
USE EXCLUSIVE (MDRIVE)+'\APOPEN'
IF TYPE('APDISC')='U'
   = PROMSG('Updating File Structures')
   USE EXCLUSIVE (MDRIVE)+'\AROPEN'
   COPY TO (MDRIVE)+'\AROPSTRU' STRUCTURE EXTENDED
   COPY TO (MDRIVE)+'\OLDARO'
   USE EXCLUSIVE (MDRIVE)+'\AROPSTRU'
   FLAG = .F.
   LOCATE FOR FIELD_NAME='ARDISC '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'ARDISC'
      REPLACE FIELD_TYPE WITH 'N'
      REPLACE FIELD_LEN WITH 10
      REPLACE FIELD_DEC WITH 2
   ENDIF
   LOCATE FOR FIELD_NAME='ARTEMP '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'ARTEMP'
      REPLACE FIELD_TYPE WITH 'C'
      REPLACE FIELD_LEN WITH 1
   ENDIF
   LOCATE FOR FIELD_NAME='ARTEMP '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'MASSTRAN'
      REPLACE FIELD_TYPE WITH 'N'
      REPLACE FIELD_LEN WITH 10
   ENDIF
   IF FLAG
      CREATE (MDRIVE)+'\AROPEN' FROM (MDRIVE)+'\AROPSTRU'
      USE EXCLUSIVE (MDRIVE)+'\AROPEN'
      APPEND FROM (MDRIVE)+'\OLDARO' FOR  .NOT. DELETED()
      INDEX ON ARINVOICE+STR(ARTRANSAC,10) TAG INVTRAN
   ENDIF
   USE
   DELETE FILE (MDRIVE)+'\AROPSTRU.DBF'
   USE EXCLUSIVE (MDRIVE)+'\APOPEN'
   COPY TO (MDRIVE)+'\APOPSTRU' STRUCTURE EXTENDED
   COPY TO (MDRIVE)+'\OLDAPO'
   USE EXCLUSIVE (MDRIVE)+'\APOPSTRU'
   FLAG = .F.
   LOCATE FOR FIELD_NAME='APDISC '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'APDISC'
      REPLACE FIELD_TYPE WITH 'N'
      REPLACE FIELD_LEN WITH 10
      REPLACE FIELD_DEC WITH 2
   ENDIF
   LOCATE FOR FIELD_NAME='APTEMP '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'APTEMP'
      REPLACE FIELD_TYPE WITH 'C'
      REPLACE FIELD_LEN WITH 1
   ENDIF
   LOCATE FOR FIELD_NAME='MASSTRAN '
   IF  .NOT. FOUND()
      FLAG = .T.
      APPEND BLANK
      REPLACE FIELD_NAME WITH 'MASSTRAN'
      REPLACE FIELD_TYPE WITH 'N'
      REPLACE FIELD_LEN WITH 10
   ENDIF
   IF FLAG
      CREATE (MDRIVE)+'\APOPEN' FROM (MDRIVE)+'\APOPSTRU'
      USE EXCLUSIVE (MDRIVE)+'\APOPEN'
      APPEND FROM (MDRIVE)+'\OLDAPO' FOR  .NOT. DELETED()
      INDEX ON APINVOICE+STR(APTRANSAC,10) TAG INVTRAN
   ENDIF
   USE
   DELETE FILE (MDRIVE)+'\APOPSTRU.DBF'
   RELEASE WINDOW
ELSE
   IF TYPE('MASSTRAN')='U'
      = PROMSG('Updating File Structures')
      USE EXCLUSIVE (MDRIVE)+'\AROPEN'
      COPY TO (MDRIVE)+'\AROPSTRU' STRUCTURE EXTENDED
      COPY TO (MDRIVE)+'\OLDARO'
      USE EXCLUSIVE (MDRIVE)+'\AROPSTRU'
      FLAG = .T.
      LOCATE FOR FIELD_NAME='MASSTRAN '
      IF  .NOT. FOUND()
         FLAG = .T.
         APPEND BLANK
         REPLACE FIELD_NAME WITH 'ARTEMP'
         REPLACE FIELD_TYPE WITH 'C'
         REPLACE FIELD_LEN WITH 1
      ENDIF
      LOCATE FOR FIELD_NAME='MASSTRAN '
      IF  .NOT. FOUND()
         FLAG = .T.
         APPEND BLANK
         REPLACE FIELD_NAME WITH 'MASSTRAN'
         REPLACE FIELD_TYPE WITH 'N'
         REPLACE FIELD_LEN WITH 10
      ENDIF
      IF FLAG
         CREATE (MDRIVE)+'\AROPEN' FROM (MDRIVE)+'\AROPSTRU'
         USE EXCLUSIVE (MDRIVE)+'\AROPEN'
         APPEND FROM (MDRIVE)+'\OLDARO' FOR  .NOT. DELETED()
         INDEX ON ARINVOICE+STR(ARTRANSAC,10) TAG INVTRAN
      ENDIF
      USE
      DELETE FILE (MDRIVE)+'\AROPSTRU.DBF'
      USE EXCLUSIVE (MDRIVE)+'\APOPEN'
      COPY TO (MDRIVE)+'\APOPSTRU' STRUCTURE EXTENDED
      COPY TO (MDRIVE)+'\OLDAPO'
      USE EXCLUSIVE (MDRIVE)+'\APOPSTRU'
      LOCATE FOR FIELD_NAME='MASSTRAN '
      IF  .NOT. FOUND()
         FLAG = .T.
         APPEND BLANK
         REPLACE FIELD_NAME WITH 'APTEMP'
         REPLACE FIELD_TYPE WITH 'C'
         REPLACE FIELD_LEN WITH 1
      ENDIF
      LOCATE FOR FIELD_NAME='MASSTRAN '
      IF  .NOT. FOUND()
         FLAG = .T.
         APPEND BLANK
         REPLACE FIELD_NAME WITH 'MASSTRAN'
         REPLACE FIELD_TYPE WITH 'N'
         REPLACE FIELD_LEN WITH 10
      ENDIF
      IF FLAG
         CREATE (MDRIVE)+'\APOPEN' FROM (MDRIVE)+'\APOPSTRU'
         USE EXCLUSIVE (MDRIVE)+'\APOPEN'
         APPEND FROM (MDRIVE)+'\OLDAPO' FOR  .NOT. DELETED()
         INDEX ON APINVOICE+STR(APTRANSAC,10) TAG INVTRAN
      ENDIF
      USE
      DELETE FILE (MDRIVE)+'\APOPSTRU.DBF'
      RELEASE WINDOW
   ENDIF
ENDIF
USE
IF  .NOT. FILE(MDRIVE+'\PA_SHIP.DBF')
   USE EXCLUSIVE (MDRIVE)+'\CLIENT'
   COPY TO (MDRIVE)+'\PA_SHIP' STRUCTURE
   USE
ENDIF
RETURN

PROCEDURE I_DBLCLK
PRIVATE ALL LIKE l_*
IF _WINDOWS
   IF  .NOT. BETWEEN((MROW(WONTOP())*FONTMETRIC(1,WFONT(1,WONTOP()),WFONT(2,WONTOP()),WFONT(3,WONTOP()))),FONTMETRIC(1,WFONT(1,WONTOP()),WFONT(2,WONTOP()),WFONT(3,WONTOP())),((WROWS(WONTOP())*FONTMETRIC(1,WFONT(1,WONTOP()),WFONT(2,WONTOP()),WFONT(3,WONTOP())))-(SYSMETRIC(3)+SYSMETRIC(8)))) .OR.  .NOT. BETWEEN((MCOL(WONTOP())*FONTMETRIC(6,WFONT(1,WONTOP()),WFONT(2,WONTOP()),WFONT(3,WONTOP()))),0,((WCOLS(WONTOP())*FONTMETRIC(6,WFONT(1,WONTOP()),WFONT(2,WONTOP()),WFONT(3,WONTOP())))-(SYSMETRIC(3)+SYSMETRIC(5))))
      LEXIT = .T.
      RETURN
   ENDIF
ELSE
   IF  .NOT. BETWEEN(MROW(WONTOP()),3,WROWS(WONTOP())-2) .OR.  .NOT. BETWEEN(MCOL(WONTOP()),0,WCOLS(WONTOP())-2)
      RETURN
   ENDIF
ENDIF
IF MROW()<>M.G_LASTROW .OR. MCOL()<>M.G_LASTCOL .OR. (SECONDS()-G_LASTCLLK)>_DBLCLICK
   M.G_LASTROW = MROW()
   M.G_LASTCOL = MCOL()
   M.G_LASTCLLK = SECONDS()
ELSE
   KEYBOARD CHR(23)
ENDIF
RETURN

PROCEDURE CHANGEFILE
PRIVATE JCGETS, I, J
DO CASE
   CASE UPPER(SENDPRN)='FILE'
      SET PRINTER TO &xfilename
      MCFILETOMO = UPPER(ALLTRIM(XFILENAME))
   CASE UPPER(SENDPRN)='SCREEN'
      SET PRINTER TO out.txt
      MCFILETOMO = 'OUT.TXT'
ENDCASE
JNFILEHAND = FOPEN((MCFILETOMO),12)
JCGETS = FREAD(JNFILEHAND,2)
I = 2
DO WHILE ASC(JCGETS)=12
   I = I+2
   JCGETS = FREAD(JNFILEHAND,2)
ENDDO
= FSEEK(JNFILEHAND,-I,1)
STORE SPACE(I) TO J
= FWRITE(JNFILEHAND,J)
= FCLOSE(JNFILEHAND)
RETURN

PROCEDURE CALCBALS
PRIVATE JCOLDALIAS, NBALANCE, NPAYABLE, MJDRIVE
JCOLDALIAS = ALIAS()
IF  .NOT. FILE(MDRIVE+'\AROPEN.DBF')
   _ = OKMSG('File AROPEN.DBF not found...')
   RETURN
ENDIF
IF  .NOT. FILE(MDRIVE+'\APOPEN.DBF')
   _ = OKMSG('File APOPEN.DBF not found...')
   RETURN
ENDIF
IF  .NOT. FILE(MDRIVE+'\CLIENT.DBF')
   _ = OKMSG('File CLIENT.DBF not found...')
   RETURN
ENDIF
IF  .NOT. FILE(MDRIVE+'\VENDOR.DBF')
   _ = OKMSG('File VENDOR.DBF not found...')
   RETURN
ENDIF
IF  .NOT. FILE(MDRIVE+'\PURCHASE.DBF')
   _ = OKMSG('File PURCHASE.DBF not found...')
   RETURN
ENDIF
IF  .NOT. FILE(MDRIVE+'\INVOICE.DBF')
   _ = OKMSG('File INVOICE.DBF not found...')
   RETURN
ENDIF
IF  .NOT. USED('CLIENT')
   USE IN 0 (MDRIVE+'\Client')
ENDIF
IF  .NOT. USED('VENDOR')
   USE IN 0 (MDRIVE+'\VENDOR')
ENDIF
IF  .NOT. USED('AROPEN')
   USE IN 0 (MDRIVE+'\AROPEN')
ENDIF
IF  .NOT. USED('APOPEN')
   USE IN 0 (MDRIVE+'\APOPEN')
ENDIF
IF  .NOT. USED('PURCHASE')
   USE IN 0 (MDRIVE+'\PURCHASE')
ENDIF
IF  .NOT. USED('INVOICE')
   USE IN 0 (MDRIVE+'\INVOICE')
ENDIF
SELECT CLIENT
SET ORDER TO Client
GOTO TOP
SELECT AROPEN.ARCLIENT, SUM(AROPEN.ARINVBAL-AROPEN.ARPAYMENT) AS TOTAL FROM AROPEN GROUP BY AROPEN.ARCLIENT INTO CURSOR Query
SCAN
   SELECT CLIENT
   SEEK QUERY.ARCLIENT
   IF FOUND()
      REPLACE TOTBALAN WITH QUERY.TOTAL
   ENDIF
   SELECT QUERY
ENDSCAN
USE
SELECT VENDOR
SET ORDER TO Vendor
GOTO TOP
SELECT APOPEN.APVENDOR, SUM(APOPEN.APINVBAL-APOPEN.APPAYMENT) AS TOTAL FROM APOPEN GROUP BY APOPEN.APVENDOR INTO CURSOR Query
SCAN
   SELECT VENDOR
   SEEK QUERY.APVENDOR
   IF FOUND()
      REPLACE CURRBAL WITH QUERY.TOTAL
   ENDIF
   SELECT QUERY
ENDSCAN
USE
SELECT VENDOR
USE
SELECT CLIENT
USE
SELECT AROPEN
USE
SELECT APOPEN
USE
SELECT INVOICE
USE
SELECT PURCHASE
USE
IF  .NOT. EMPTY(JCOLDALIAS)
   SELECT (JCOLDALIAS)
ENDIF

PROCEDURE FIXCOGS
PRIVATE MJSERVCDX, MJLIFOCDX
IF  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE')
ENDIF
SELECT SERVICE
MJSERVCDX = SYS(22)
SET ORDER TO SERVICE
IF  .NOT. USED('LIFOFIFO')
   USE IN 0 (MDRIVE+'\LIFOFIFO')
ENDIF
SELECT LIFOFIFO
MJLIFOCDX = SYS(22)
SET ORDER TO SERDATE
IF  .NOT. USED('INVOICE')
   USE IN 0 (MDRIVE+'\INVOICE')
ENDIF
SELECT INVOICE
IF  .NOT. USED('INVLINE')
   USE IN 0 (MDRIVE+'\INVLINE')
ENDIF
SELECT INVLINE
SELECT SERVICE
GOTO TOP
SCAN
   IF UNITS>0
      = SCANLIFO()
   ENDIF
   IF UNITS<=0
      SELECT LIFOFIFO
      DELETE ALL FOR SERVICE=SERVICE.SERVICE
      SELECT SERVICE
      REPLACE AVECOST WITH 0
   ENDIF
   SELECT SERVICE
ENDSCAN
= CHKCOMMIT()
= CHKORDER()
= DOLLARSONH()
SELECT LIFOFIFO
USE
SELECT SERVICE
USE

PROCEDURE SCANLIFO
PRIVATE MJLIFOUNIT, MJLIFOAMOU, MCOST
MJLIFOUNIT = 0
MJLIFOAMOU = 0
IF COSTING='S'
   MCOST = SERVICE.COST
ELSE
   MCOST = SERVICE.DOLLARS/SERVICE.UNITS
ENDIF
SELECT SERVICE
REPLACE DOLLARS WITH UNITS*MCOST
SELECT LIFOFIFO
SEEK SERVICE.SERVICE
IF FOUND()
   SCAN WHILE SERVICE=SERVICE.SERVICE
      MJLIFOUNIT = MJLIFOUNIT+UNITS
      MJLIFOAMOU = MJLIFOAMOU+UNITS*COST
   ENDSCAN
   IF MJLIFOUNIT<>SERVICE.UNITS .OR. MJLIFOAMOU<>SERVICE.DOLLARS
      DELETE ALL FOR SERVICE=SERVICE.SERVICE
      INSERT INTO LIFOFIFO ( DATE, SERVICE, UNITS, COST ) VALUE ( DATE(), SERVICE.SERVICE, SERVICE.UNITS, MCOST )
   ENDIF
   SELECT SERVICE
   REPLACE AVECOST WITH DOLLARS/UNITS
ENDIF
SELECT SERVICE

PROCEDURE DOLLARSONH
PRIVATE NCOST
SELECT LIFOFIFO
GOTO TOP
SCAN
   CSERVICE = SERVICE
   NCOST = 0
   SCAN WHILE CSERVICE=SERVICE
      NCOST = NCOST+COST
   ENDSCAN
   SELECT SERVICE
   SEEK CSERVICE
   REPLACE DOLLARS WITH (UNITS*NCOST)
   SELECT LIFOFIFO
   IF  .NOT. EOF()
      SKIP -1
   ENDIF
ENDSCAN

PROCEDURE CHKCOMMIT
IF FILE(MDRIVE+'\INVOICE.DBF') .AND.  .NOT. USED('INVOICE')
   USE IN 0 (MDRIVE+'\INVOICE')
ENDIF
IF FILE(MDRIVE+'\INVLINE.DBF') .AND.  .NOT. USED('INVLINE')
   USE IN 0 (MDRIVE+'\INVLINE')
ENDIF
IF FILE(MDRIVE+'\ORDER.DBF') .AND.  .NOT. USED('ORDER')
   USE IN 0 (MDRIVE+'\ORDER')
ENDIF
IF FILE(MDRIVE+'\ORDLINE.DBF') .AND.  .NOT. USED('ORDLINE')
   USE IN 0 (MDRIVE+'\ORDLINE')
ENDIF
IF FILE(MDRIVE+'\PURCHASE.DBF') .AND.  .NOT. USED('PURCHASE')
   USE IN 0 (MDRIVE+'\PURCHASE')
ENDIF
IF FILE(MDRIVE+'\PURLINE.DBF') .AND.  .NOT. USED('PURLINE')
   USE IN 0 (MDRIVE+'\PURLINE')
ENDIF
IF FILE(MDRIVE+'\SERVICE.DBF') .AND.  .NOT. USED('SERVICE')
   USE IN 0 (MDRIVE+'\SERVICE') ORDER SERVICE
ENDIF
SELECT ORDLINE.SERVICE, SUM(ORDLINE.SOLD) AS ORDSOLD, SUM(INVLINE.SOLD) AS INVSOLD FROM INVLINE, ORDLINE WHERE INVLINE.SERVICE=ORDLINE.SERVICE GROUP BY ORDLINE.SERVICE UNION SELECT ORDLINE.SERVICE, SUM(ORDLINE.SOLD) AS ORDSOLD, 0 FROM ORDLINE WHERE  NOT ORDLINE.SERVICE IN(SELECT INVLINE.SERVICE AS SERVICE FROM INVLINE GROUP BY INVLINE.SERVICE) UNION SELECT INVLINE.SERVICE, 0, SUM(INVLINE.SOLD) AS INVSOLD FROM INVLINE WHERE  NOT INVLINE.SERVICE IN(SELECT ORDLINE.SERVICE AS SERVICE FROM ORDLINE GROUP BY ORDLINE.SERVICE) INTO CURSOR QUERY
SCAN
   SELECT SERVICE
   IF SEEK(QUERY.SERVICE)
      REPLACE COMMITT WITH (QUERY.ORDSOLD+QUERY.INVSOLD)
   ENDIF
   SELECT QUERY
ENDSCAN
USE
SELECT INVOICE
USE
SELECT INVLINE
USE
SELECT ORDER
USE
SELECT ORDLINE
USE

PROCEDURE CHKORDER
SELECT PURLINE.SERVICE, SUM(PURLINE.SOLD) AS SOLD FROM PURLINE, PURCHASE WHERE PURLINE.INVOICE=PURCHASE.INVOICE AND PURCHASE.RECD=.F. GROUP BY PURLINE.SERVICE INTO CURSOR QUERY
SCAN
   SELECT SERVICE
   IF SEEK(QUERY.SERVICE)
      IF ORDER<>QUERY.SOLD
         REPLACE ORDER WITH QUERY.SOLD
      ENDIF
   ENDIF
   SELECT QUERY
ENDSCAN
USE
SELECT PURCHASE
USE
SELECT PURLINE
USE

PROCEDURE RICHIE
PARAMETER CARRAYNAME, NELEMENTS, NSPACES
PRIVATE CARRAYNAME, NELEMENTS, NSPACES, PRLINE, MSPC, JNELEMENTS
PRIVATE MCCITY, MCZIP, MCSTATE, MCCOMMA, JNEMPTYELE
PRLINE = ''
IF NELEMENTS>5 .AND. CARRAYNAME<>'ArrayShip'
   PRLINE = ''
   mcCity  = alltrim(&cArrayName(5))
   mcZip   = alltrim(&cArrayName(6))
   mcState = alltrim(&cArrayName(7))
   MCCOMMA = ','
   IF LEN(MCZIP)>=7
      MCZIP = MCZIP
   ELSE
      MCZIP = ALLTRIM(SUBSTR(MCZIP,1,5))
   ENDIF
   IF  .NOT. EMPTY(MCZIP)
      MSPC = ''
      MCZIP = ' '+MCZIP
   ELSE
      MSPC = '  '
   ENDIF
   MCCOMMA = ','
   IF EMPTY(MCCITY) .AND.  .NOT. EMPTY(MCSTATE)
      MCCOMMA = ''
   ENDIF
   IF EMPTY(MCCITY)
      IF EMPTY(MCSTATE)
         STORE PRLINE+TRIM(MCCITY)+TRIM(MCSTATE)+SUBSTR(MCZIP,3) TO PRLINE
      ELSE
         STORE PRLINE+TRIM(MCCITY)+MCCOMMA+TRIM(MCSTATE)+MCZIP TO PRLINE
      ENDIF
   ELSE
      IF EMPTY(MCSTATE)
         STORE PRLINE+TRIM(MCCITY)+TRIM(MCSTATE)+MCZIP TO PRLINE
      ELSE
         STORE PRLINE+TRIM(MCCITY)+', '+TRIM(MCSTATE)+MCZIP TO PRLINE
      ENDIF
   ENDIF
   store prline to &cArrayName(5)
   store space(nSpaces) to &cArrayName(6)
   store space(nSpaces) to &cArrayName(7)
   IF ALLTRIM(PRLINE)='-'
      store space(nSpaces) to &cArrayName(5)
   ENDIF
ENDIF
IF NELEMENTS>8
   PRLINE = ''
   if !empty(&cArrayName(8))
      STORE prLine + 'Phone : ' + &cArrayName(8) + ' ' TO prLine
      if !empty(&cArrayName(9))
         store prline + 'Fax: ' + &cArrayName(9) to prline
      ENDIF
   ELSE
      if !empty(&cArrayName(9))
         store prline + 'Fax: ' + &cArrayName(9) to prline
      ENDIF
   ENDIF
   store prline to &cArrayName(6)
   store space(nSpaces) to &cArrayName(8)
   store space(nSpaces) to &cArrayName(9)
ENDIF
JNELEMENTS = 0
JNEMPTYELE = 0
FOR JNELEMENTS = 1 TO NELEMENTS
   If EMPTY (&cArrayName ( jnElements ) ))
      Store Space(nSpaces) to &cArrayName(jnElements)
   ENDIF
   jnEmptyEle = ASCAN ( &cArrayName , space ( nSpaces ) )
   If jnElements < nElements    And  jnEmptyEle > 0  and   EMPTY (&cArrayName(jnElements))
      &cArrayName(jnEmptyEle) = &cArrayName(jnElements + 1 ) 
      If LEN ( &carrayName (jnEmptyEle) )  <  nSpaces
         &cArrayName(jnEmptyEle) = &cArrayName(jnEmptyEle) +  space ( nSpaces - len(&cArrayName(jnElements + 1 ) ) )
      ENDIF
      Store Space(nSpaces) to &cArrayName(jnElements + 1 )
   ENDIF
   If LEN ( &carrayName(jnelements) )  <  nSpaces
      &cArrayName(jnElements) = &cArrayName(jnElements) +  space ( nSpaces - len(&cArrayName(jnElements) ) )
   ENDIF
ENDFOR
RETURN

FUNCTION  RESETON
PARAMETER PRNTFLAG, NIDENTIFIE
PRIVATE PRNTFLAG, NIDENTIFIE
IF NIDENTIFIE=1
   = PRNSETUP(.F.)
   RETURN
ENDIF
IF  .NOT. PRNTFLAG .AND. UPPER(SENDPRN)<>'SCREEN'
   PRNTFLAG = .T.
ENDIF
SET PRINTER OFF
SET PRINTER TO
SET DEVICE TO SCREEN
IF PRN_PORT='LPT1' .OR. EMPTY(PRN_PORT)
   JCOLDALIAS = ALIAS()
   SELECT 0
   PRN_PORT = ''
   SET PRINTER OFF
   IF  .NOT. EMPTY(JCOLDALIAS)
      select &jcOldAlias
   ENDIF
ELSE
   SET PRINTER TO &prn_port
ENDIF
IF _WINDOWS
   WIN_P_NORM = 'FoxPrint,10,B'
   SET PRINTER FONT (SUBSTR(WIN_P_NORM,1,AT(',',WIN_P_NORM)-1)), VAL(SUBSTR(WIN_P_NORM,AT(',',WIN_P_NORM)+1,RAT(',',WIN_P_NORM)-AT(',',WIN_P_NORM)-1))
ENDIF
RELEASE WINDOW PRN_MSG
= CHANGEFILE()
IF UPPER(SENDPRN)='SCREEN'
   IF TYPE('stop_prn')='L'
      IF STOP_PRN=.F.
         DO PRNVIEW
      ENDIF
   ENDIF
ENDIF
RETURN (PRNTFLAG)

PROCEDURE PRNSETUP
PARAMETER _CONDENSE
IF _WINDOWS
   WIN_P_NORM = 'FoxPrint,12,B'
   WIN_P_NORM = 'FoxPrint,12,B'
   WIN_P_COND = 'FoxPrint,7,B'
   WIN_P_NLEN = 65
   WIN_P_CLEN = 90
   IF _CONDENSE
      SET PRINTER FONT (SUBSTR(WIN_P_COND,1,AT(',',WIN_P_COND)-1)), VAL(SUBSTR(WIN_P_COND,AT(',',WIN_P_COND)+1,RAT(',',WIN_P_COND)-AT(',',WIN_P_COND)-1))
      _PLENGTH = WIN_P_CLEN
   ELSE
      SET PRINTER FONT (SUBSTR(WIN_P_NORM,1,AT(',',WIN_P_NORM)-1)), VAL(SUBSTR(WIN_P_NORM,AT(',',WIN_P_NORM)+1,RAT(',',WIN_P_NORM)-AT(',',WIN_P_NORM)-1))
      _PLENGTH = WIN_P_NLEN
   ENDIF
ENDIF
IF _PLINENO>1
   SET PRINTER TO nul
   EJECT
   SET PRINTER TO
ENDIF
DO CASE
   CASE UPPER(SENDPRN)='PRINTER'
      IF TYPE('mcFormNo')='C'
         IF MCFORMNO='86413' .OR. MCFORMNO='86493' .OR. MCFORMNO='86613' .OR. MCFORMNO='86933'
            SET PRINTER OFF
            SET PRINTER TO ASCII.TXT
            SET PRINTER ON
         ENDIF
      ENDIF
   CASE UPPER(SENDPRN)='FILE'
      SET PRINTER TO &xfilename
      MCFILETOMO = UPPER(ALLTRIM(XFILENAME))
   CASE UPPER(SENDPRN)='SCREEN'
      SET PRINTER TO out.txt
      MCFILETOMO = 'OUT.TXT'
ENDCASE
WAIT CLEAR
SET PRINTER ON

PROCEDURE PA7GETOUT
IF USED('PA7')
   SELECT PA7
   USE
ENDIF
USE IN 0 EXCLUSIVE PA7
SELECT PA7
PACK
IF FILE('LASTUSED.DBF')
   IF  .NOT. USED('LASTUSED')
      USE lastused
   ENDIF
   SELECT LASTUSED
   IF EOF() .AND. BOF()
      APPEND BLANK
   ENDIF
   REPLACE LASTUSED.COMPPATH WITH MDRIVE
   REPLACE LASTUSED.COMPNAME WITH PCOMPANY
ENDIF
ON SHUTDOWN 
CLEAR
CLOSE DATABASES
_GOODBYE = .T.
RELEASE ALL
CLEAR GETS
CLOSE ALL
CLEAR ALL
QUIT

PROCEDURE DIARY
IF NCALENDAR=1
   SHOW MENU _MSYSMENU
   SET RESOURCE ON
   ACTIVATE WINDOW CALENDAR
ENDIF
IF NCALENDAR=2
   IF FILE(GETENV('WINDIR')+'\CALENDAR.EXE')
      RUN /n CALENDAR
   ELSE
      = OKMSG('Windows Calendar not found in '+ALLTRIM(GETENV('WINDIR')))
   ENDIF
ENDIF
IF NCALENDAR=3
   IF LEFT(OS(),9)='Windows 4'
      SCHDFILE = LEFT(GETENV('WINDIR'),3)+'MSOFFICE\SCHEDULE.EXE'
      IF  .NOT. FILE(SCHDFILE)
         = OKMSG('Schedule+ file not found...')
      ELSE
         Run /n &SchdFile	
      ENDIF
   ELSE
      RUN /n SCHDPLUS
   ENDIF
ENDIF

PROCEDURE MCALC
SET RESOURCE ON
ACTIVATE WINDOW CALCULATOR

PROCEDURE RPRTCHOICE
IF _SEND_OUT<>3
   SHOW GET XFILENAME DISABLE
ELSE
   SHOW GET XFILENAME ENABLE
ENDIF

PROCEDURE RPRTWHEN
IF _SEND_OUT<>3
   SHOW GET XFILENAME DISABLE
ENDIF

PROCEDURE VERIFY
PARAMETER XFILENAME, XFLAG, XCODE
PRIVATE XFILENAME, XFLAG, XCODE
Sele &xFileName
IF XFLAG .AND. SEEK(XCODE)
   DELETE
ENDIF

PROCEDURE MOUSECLICK

PROCEDURE KEYPRESS
IF LASTKEY()=27
   KEYBOARD CHR(23)
ENDIF

PROCEDURE UPD_ACC
IF USED('ACCTYPE')
   SELECT ACCTYPE
   USE
ENDIF
USE EXCLUSIVE (DATA_PATH)+'\ACCTYPE'
ZAP
DIMENSION ATYPE( 11, 2)
ATYPE[ 1, 1] = 'A01'
ATYPE[ 1, 2] = 'Current Assets'
ATYPE[ 2, 1] = 'A02'
ATYPE[ 2, 2] = 'Fixed Assets'
ATYPE[ 3, 1] = 'A03'
ATYPE[ 3, 2] = 'Other Assets'
ATYPE[ 4, 1] = 'L01'
ATYPE[ 4, 2] = 'Current Liabilities'
ATYPE[ 5, 1] = 'L02'
ATYPE[ 5, 2] = 'Long Term Liabilities'
ATYPE[ 6, 1] = 'C01'
ATYPE[ 6, 2] = 'Capital/Equity'
ATYPE[ 7, 1] = 'R01'
ATYPE[ 7, 2] = 'Revenue from Services'
ATYPE[ 8, 1] = 'R02'
ATYPE[ 8, 2] = 'Other Revenue'
ATYPE[ 9, 1] = 'E01'
ATYPE[ 9, 2] = 'Operation Expenses'
ATYPE[ 10, 1] = 'E02'
ATYPE[ 10, 2] = 'Tax Expenses'
ATYPE[ 11, 1] = 'E03'
ATYPE[ 11, 2] = 'Other Expenses'
APPEND FROM ARRAY ATYPE
IF SAMPLE=.F.
   RETURN
ENDIF
IF USED('ACCOUNT')
   SELECT ACCOUNT
   USE
ENDIF
USE EXCLUSIVE (DATA_PATH)+'\ACCOUNT'
ZAP
IF LCONNUNIV=.T.
   DIMENSION ATYPE( 249, 3)
   DO UNIVOFCONN
   RETURN
ENDIF
DIMENSION ATYPE( 68, 3)
ATYPE[ 1, 1] = '11011'
ATYPE[ 1, 2] = 'Checking Account 1'
ATYPE[ 1, 3] = 'A01'
ATYPE[ 2, 1] = '11012'
ATYPE[ 2, 2] = 'Checking Account 2'
ATYPE[ 2, 3] = 'A01'
ATYPE[ 3, 1] = '1102'
ATYPE[ 3, 2] = 'Savings Account'
ATYPE[ 3, 3] = 'A01'
ATYPE[ 4, 1] = '1103'
ATYPE[ 4, 2] = 'Accounts Receivable'
ATYPE[ 4, 3] = 'A01'
ATYPE[ 5, 1] = '1104'
ATYPE[ 5, 2] = 'Allowance for Bad Debit'
ATYPE[ 5, 3] = 'A01'
ATYPE[ 6, 1] = '1105'
ATYPE[ 6, 2] = 'Inventory'
ATYPE[ 6, 3] = 'A01'
ATYPE[ 7, 1] = '1201'
ATYPE[ 7, 2] = 'Office Equipment'
ATYPE[ 7, 3] = 'A02'
ATYPE[ 8, 1] = '12011'
ATYPE[ 8, 2] = 'Depreciation-Office Equipment'
ATYPE[ 8, 3] = 'A02'
ATYPE[ 9, 1] = '1202'
ATYPE[ 9, 2] = 'Vehicles'
ATYPE[ 9, 3] = 'A02'
ATYPE[ 10, 1] = '12021'
ATYPE[ 10, 2] = 'Depreciation-Vehicles'
ATYPE[ 10, 3] = 'A02'
ATYPE[ 11, 1] = '1203'
ATYPE[ 11, 2] = 'Furniture & Fixtures'
ATYPE[ 11, 3] = 'A02'
ATYPE[ 12, 1] = '12031'
ATYPE[ 12, 2] = 'Depreciation-Furniture/Fixture'
ATYPE[ 12, 3] = 'A02'
ATYPE[ 13, 1] = '1204'
ATYPE[ 13, 2] = 'Machinery & Equipment'
ATYPE[ 13, 3] = 'A02'
ATYPE[ 14, 1] = '12041'
ATYPE[ 14, 2] = 'Depreciation-Machinery/Equip.'
ATYPE[ 14, 3] = 'A02'
ATYPE[ 15, 1] = '1205'
ATYPE[ 15, 2] = 'Buildings'
ATYPE[ 15, 3] = 'A02'
ATYPE[ 16, 1] = '12051'
ATYPE[ 16, 2] = 'Depreciation-Buildings'
ATYPE[ 16, 3] = 'A02'
ATYPE[ 17, 1] = '1206'
ATYPE[ 17, 2] = 'Land'
ATYPE[ 17, 3] = 'A02'
ATYPE[ 18, 1] = '1301'
ATYPE[ 18, 2] = 'Deposits'
ATYPE[ 18, 3] = 'A03'
ATYPE[ 19, 1] = '1302'
ATYPE[ 19, 2] = 'Long Term Investments'
ATYPE[ 19, 3] = 'A03'
ATYPE[ 20, 1] = '2101'
ATYPE[ 20, 2] = 'Credit Cards'
ATYPE[ 20, 3] = 'L01'
ATYPE[ 21, 1] = '2102'
ATYPE[ 21, 2] = 'Accounts Payable'
ATYPE[ 21, 3] = 'L01'
ATYPE[ 22, 1] = '2103'
ATYPE[ 22, 2] = 'Notes Payable'
ATYPE[ 22, 3] = 'L01'
ATYPE[ 23, 1] = '2104'
ATYPE[ 23, 2] = 'Taxes Payable'
ATYPE[ 23, 3] = 'L01'
ATYPE[ 24, 1] = '2105'
ATYPE[ 24, 2] = 'Sales Taxes Payable'
ATYPE[ 24, 3] = 'L01'
ATYPE[ 25, 1] = '2201'
ATYPE[ 25, 2] = 'Mortgages'
ATYPE[ 25, 3] = 'L02'
ATYPE[ 26, 1] = '2202'
ATYPE[ 26, 2] = 'Long Term Notes Payable'
ATYPE[ 26, 3] = 'L02'
ATYPE[ 27, 1] = '3101'
ATYPE[ 27, 2] = 'Owners Equity'
ATYPE[ 27, 3] = 'C01'
ATYPE[ 28, 1] = '33'
ATYPE[ 28, 2] = 'Profit/Loss'
ATYPE[ 28, 3] = 'C01'
ATYPE[ 29, 1] = '4101'
ATYPE[ 29, 2] = 'Dept.1-Revenue'
ATYPE[ 29, 3] = 'R01'
ATYPE[ 30, 1] = '4102'
ATYPE[ 30, 2] = 'Dept.2-Revenue'
ATYPE[ 30, 3] = 'R01'
ATYPE[ 31, 1] = '4103'
ATYPE[ 31, 2] = 'Revenue from Freight'
ATYPE[ 31, 3] = 'R01'
ATYPE[ 32, 1] = '4202'
ATYPE[ 32, 2] = 'Revenue from other Sources'
ATYPE[ 32, 3] = 'R02'
ATYPE[ 33, 1] = '5019'
ATYPE[ 33, 2] = 'Inventory Adjustments'
ATYPE[ 33, 3] = 'E01'
ATYPE[ 34, 1] = '5101'
ATYPE[ 34, 2] = 'Dept.1-Cost of Goods Sold'
ATYPE[ 34, 3] = 'E01'
ATYPE[ 35, 1] = '5102'
ATYPE[ 35, 2] = 'Dept.2-Cost of Goods Sold'
ATYPE[ 35, 3] = 'E01'
ATYPE[ 36, 1] = '5110'
ATYPE[ 36, 2] = 'Discounts Taken'
ATYPE[ 36, 3] = 'E01'
ATYPE[ 37, 1] = '5201'
ATYPE[ 37, 2] = 'Office Supplies'
ATYPE[ 37, 3] = 'E01'
ATYPE[ 38, 1] = '5202'
ATYPE[ 38, 2] = 'Phone Company'
ATYPE[ 38, 3] = 'E01'
ATYPE[ 39, 1] = '5203'
ATYPE[ 39, 2] = 'Electric Company'
ATYPE[ 39, 3] = 'E01'
ATYPE[ 40, 1] = '5204'
ATYPE[ 40, 2] = 'Shipping Expenses'
ATYPE[ 40, 3] = 'E01'
ATYPE[ 41, 1] = '5205'
ATYPE[ 41, 2] = 'Consulting Fees'
ATYPE[ 41, 3] = 'E01'
ATYPE[ 42, 1] = '5206'
ATYPE[ 42, 2] = 'Rent & Leases'
ATYPE[ 42, 3] = 'E01'
ATYPE[ 43, 1] = '5207'
ATYPE[ 43, 2] = 'Insurance'
ATYPE[ 43, 3] = 'E01'
ATYPE[ 44, 1] = '5208'
ATYPE[ 44, 2] = 'Maintenance'
ATYPE[ 44, 3] = 'E01'
ATYPE[ 45, 1] = '5209'
ATYPE[ 45, 2] = 'Depreciation'
ATYPE[ 45, 3] = 'E01'
ATYPE[ 46, 1] = '5210'
ATYPE[ 46, 2] = 'Amortization'
ATYPE[ 46, 3] = 'E01'
ATYPE[ 47, 1] = '5211'
ATYPE[ 47, 2] = 'Interest Expense'
ATYPE[ 47, 3] = 'E01'
ATYPE[ 48, 1] = '5212'
ATYPE[ 48, 2] = 'Bad Debt Loss'
ATYPE[ 48, 3] = 'E01'
ATYPE[ 49, 1] = '5213'
ATYPE[ 49, 2] = 'Freight Expense'
ATYPE[ 49, 3] = 'E01'
ATYPE[ 50, 1] = '5214'
ATYPE[ 50, 2] = 'Payroll Paid'
ATYPE[ 50, 3] = 'E01'
ATYPE[ 51, 1] = '5301'
ATYPE[ 51, 2] = 'Tax Expenses'
ATYPE[ 51, 3] = 'E02'
ATYPE[ 52, 1] = '5302'
ATYPE[ 52, 2] = 'Other Taxes'
ATYPE[ 52, 3] = 'E02'
ATYPE[ 53, 1] = '5303'
ATYPE[ 53, 2] = 'Income Tax'
ATYPE[ 53, 3] = 'E02'
ATYPE[ 54, 1] = '5304'
ATYPE[ 54, 2] = 'Sales Taxes'
ATYPE[ 54, 3] = 'E02'
ATYPE[ 55, 1] = '5401'
ATYPE[ 55, 2] = 'Travel & Entertainment'
ATYPE[ 55, 3] = 'E03'
ATYPE[ 56, 1] = '5402'
ATYPE[ 56, 2] = 'Lodging'
ATYPE[ 56, 3] = 'E03'
ATYPE[ 57, 1] = '5403'
ATYPE[ 57, 2] = 'Personal Expenses'
ATYPE[ 57, 3] = 'E03'
ATYPE[ 58, 1] = '2110'
ATYPE[ 58, 2] = 'FUTA Payable'
ATYPE[ 58, 3] = 'L01'
ATYPE[ 59, 1] = '2111'
ATYPE[ 59, 2] = 'FICA Payable'
ATYPE[ 59, 3] = 'L01'
ATYPE[ 60, 1] = '2112'
ATYPE[ 60, 2] = 'FWH Payable'
ATYPE[ 60, 3] = 'L01'
ATYPE[ 61, 1] = '2113'
ATYPE[ 61, 2] = 'SUTA Payable'
ATYPE[ 61, 3] = 'L01'
ATYPE[ 62, 1] = '2114'
ATYPE[ 62, 2] = 'SDIF Payable'
ATYPE[ 62, 3] = 'L01'
ATYPE[ 63, 1] = '2115'
ATYPE[ 63, 2] = 'SWH Payable'
ATYPE[ 63, 3] = 'L01'
ATYPE[ 64, 1] = '2116'
ATYPE[ 64, 2] = 'CWH Payable'
ATYPE[ 64, 3] = 'L01'
ATYPE[ 65, 1] = '2117'
ATYPE[ 65, 2] = 'Allotments Payable'
ATYPE[ 65, 3] = 'L01'
ATYPE[ 66, 1] = '2118'
ATYPE[ 66, 2] = 'Child Supp. Payable'
ATYPE[ 66, 3] = 'L01'
ATYPE[ 67, 1] = '5215'
ATYPE[ 67, 2] = 'Payroll Expense'
ATYPE[ 67, 3] = 'E02'
ATYPE[ 68, 1] = '2106'
ATYPE[ 68, 2] = 'Inventory Adjustment Credits'
ATYPE[ 68, 3] = 'L01'
APPEND FROM ARRAY ATYPE
USE

PROCEDURE UPDDOCGEN
USE EXCLUSIVE (DATA_PATH)+'\DOCGEN'
APPEND BLANK
REPLACE COMPANY WITH NEWCOMPANY
I0 = 10
IDIR = 'S'
IJOB = 'N'
IHLD = 'Y'
IUTS = 'N'
IWRT = 'N'
ISHP = 'Y'
IEXP = 'Y'
ICOM = 'N'
IHL2 = 'Y'
IGST = 'N'
ILEFT = 8
IRIGHT = 2
MCOUNT = 1
DATEF = 1
ICOST = 'A'
IPRNT = 19
DATEF = 1
_CURR_SIGN = '$   '
_CURR_WORD = 'DOLLARS             '
REPLACE GSTRATE WITH PNDEFAULTG
REPLACE CURRENT WITH 'Thank you for your Business'
REPLACE DAYS30 WITH 'Thank you for your Business'
REPLACE DAYS60 WITH 'Your account is 30 days overdue'
REPLACE DAYS90 WITH 'Your account is 60 days overdue'
REPLACE LINE14 WITH 'Invoice '
REPLACE LINE13 WITH 'Payment - Thank you           Write-Off                     '
REPLACE LINE12 WITH 'Misc. Charges                 Order of General Merchandise  '
REPLACE LINE11 WITH 'Order of General Merchandise  Payment of Invoice           '
REPLACE GENERAL WITH LTRIM(STR(I0))+SUBSTR(GENERAL,3,18)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,2)+'40'+SUBSTR(GENERAL,5,16)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,4)+IDIR+SUBSTR(GENERAL,6,15)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,5)+IJOB+SUBSTR(GENERAL,7,14)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,6)+IHLD+SUBSTR(GENERAL,8,14)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,7)+IUTS+SUBSTR(GENERAL,9,13)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,8)+IWRT+SUBSTR(GENERAL,10,12)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,9)+ISHP+SUBSTR(GENERAL,11,11)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,10)+IEXP+SUBSTR(GENERAL,12,10)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,11)+ICOM+SUBSTR(GENERAL,13,9)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,12)+IHL2+SUBSTR(GENERAL,14,8)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,13)+IGST+SUBSTR(GENERAL,15,7)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,14)+STR(ILEFT,1)+SUBSTR(GENERAL,16,6)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,15)+STR(IRIGHT,1)+SUBSTR(GENERAL,17,5)
REPLACE GENERAL WITH SUBSTR(GENERAL,1,17)+ICOST+SUBSTR(GENERAL,19,3)
REPLACE LINE15 WITH SUBSTR(LINE15,1,13)+STR(IPRNT,2)+SUBSTR(LINE15,16,45)
REPLACE LINE15 WITH LTRIM(STR(MCOUNT))+LTRIM(STR(DATEF))+SUBSTR(LINE15,3,58)
REPLACE RETURNS WITH 1
IF SAMPLE
   IF LCONNUNIV=.T.
      CSALESTAX = '904       216       904       216'
      CLINE10 = '904       216       $    Dollars'
   ELSE
      CSALESTAX = '5301      2105      5301      2105'
      CLINE10 = '5301      2105      $    Dollars'
   ENDIF
   REPLACE SALES WITH IIF(LCONNUNIV=.F.,'4101','401')
   REPLACE RECEIVABLE WITH IIF(LCONNUNIV=.F.,'1103','111')
   REPLACE PAYABLE WITH IIF(LCONNUNIV=.F.,'2102','201')
   REPLACE CHECKING WITH IIF(LCONNUNIV=.F.,'11011','101')
   REPLACE PRODUCTS WITH IIF(LCONNUNIV=.F.,'1105','130')
   REPLACE COGS WITH IIF(LCONNUNIV=.F.,'5101','511')
   REPLACE FREIGHTEXP WITH IIF(LCONNUNIV=.F.,'5213','617')
   REPLACE FREIGHTINC WITH IIF(LCONNUNIV=.F.,'4103','801')
   REPLACE SALESTAX WITH IIF(LCONNUNIV=.F.,'2106','249')
   REPLACE PADJ WITH IIF(LCONNUNIV=.F.,'5019','520')
   REPLACE LINE7 WITH CSALESTAX
   REPLACE LINE8 WITH CSALESTAX
   REPLACE LINE9 WITH CSALESTAX
   REPLACE LINE10 WITH CLINE10
ENDIF
REPLACE PORT WITH '1'
REPLACE LPSTAFTER WITH .F.
REPLACE COMPHEAD WITH .T.
REPLACE CHKFORM WITH '49083'
REPLACE INVFORM WITH '49453'
REPLACE STAFORM WITH '49693'
REPLACE POFORM WITH '49403'
REPLACE ESTFORM WITH '49453'
REPLACE RECPOFORM WITH '49403'
IF  .NOT. LCONVERT .AND.  .NOT. MLLIGHTVER
   REPLACE REGISKNT WITH 25
ENDIF
CLOSE DATABASES

PROCEDURE _R2S1A92N5

PROCEDURE _R2S1A92WT
= SYS(1037)

PROCEDURE WINQUIT
IF OKCANMSG('Quit from the Application ?')
   = PA7GETOUT()
ENDIF

PROCEDURE NULLRET
RETURN

PROCEDURE ENABLACTIV
_INACTIVE = 0
IF REPTYPE<>6
   _INACTIVE = 1
   SHOW GET _INACTIVE ENABLE
ELSE
   SHOW GET _INACTIVE DISABLE
ENDIF
IF MLLIGHTVER=.T. .AND. MCICONNAME<>'DLXACC.ICO'
   SHOW GET REPTYPE, 6 DISABLE
ENDIF

PROCEDURE ZEROBALANC
PARAMETER NVALUE
IF NVALUE=1 .AND. REPTYPE<>2
   P_FORWARD = 0
   SHOW GET P_FORWARD DISABLE
   RETURN
ENDIF
SHOW GET P_FORWARD DISABLE
IF REPTYPE=2
   P_FORWARD = 1
   SHOW GET P_FORWARD ENABLE
ENDIF

PROCEDURE INVDUE
IF REPTYPE<>2
   SHOW GET XDATE DISABLE
ELSE
   SHOW GET XDATE ENABLE
ENDIF

PROCEDURE CHKDIR
PRIVATE JCDATAPATH, JNSUCCESS, JLPA7OPEN, JNRECNO
JLPA7OPEN = .F.
JNRECNO = 0
IF  .NOT. USED('PA7')
   USE IN 0 PA7
   JLPA7OPEN = .T.
ENDIF
SELECT PA7
JNRECNO = RECNO()
GOTO TOP
SCAN
   JCDATAPATH = ALLTRIM(PATH)
   JNSUCCESS = MKDIR(JCDATAPATH)
   IF JNSUCCESS<>6
      DELETE
   ENDIF
ENDSCAN
IF JLPA7OPEN
   USE
ELSE
   LOCATE FOR RECNO()=JNRECNO
ENDIF

PROCEDURE CHKDATA
PRIVATE JCTMPFILE
IF FILE(DATA_PATH+'\DIRCHK.DBF')
   IF  .NOT. FILE(DATA_PATH+'\DIRCHK.CDX')
      CREATE DBF ('STOPGAP.DBF') ( CKNUM N ( 10 ), CKDATE D ( 8 ), CHECKNUM C ( 10 ), VENDOR C ( 10 ), PAYTO C ( 30 ), NAME C ( 30 ), ADDRESS1 C ( 30 ), ADDRESS2 C ( 30 ), ADDRESS3 C ( 30 ), PAID N ( 9, 2 ), CKMEMO C ( 30 ), TYPE C ( 1 ), ACCT1 C ( 10 ), ACCTAMT1 N ( 9, 2 ), ACCT2 C ( 10 ), ACCTAMT2 N ( 9, 2 ), ACCT3 C ( 10 ), ACCTAMT3 N ( 9, 2 ), ACCT4 C ( 10 ), ACCTAMT4 N ( 9, 2 ), ACCT5 C ( 10 ), ACCTAMT5 N ( 9, 2 ), ACCT6 C ( 10 ), ACCTAMT6 N ( 9, 2 ), ACCT7 C ( 10 ), ACCTAMT7 N ( 9, 2 ), ACCT8 C ( 10 ), ACCTAMT8 N ( 9, 2 ), REF C ( 10 ), JOB C ( 10 ), CHECKING C ( 10 ) )
      USE
      USE IN 0 EXCLUSIVE STOPGAP
      SELECT STOPGAP
      INDEX ON CKNUM TAG CKNUM
      USE
      ERASE 'STOPGAP.DBF'
      RENAME 'STOPGAP.CDX' TO (DATA_PATH+'\DIRCHK.CDX')
   ENDIF
   USE IN 0 (DATA_PATH+'\DIRCHK.DBF')
   SELECT DIRCHK
   IF FCOUNT()=29
      JCTMPFILE = SYS(3)+'.TMP'
      SELECT CKNUM, CKDATE, CHECKNUM, VENDOR, PAYTO, SPACE(30) AS NAME, ADDRESS1, SPACE(30) AS ADDRESS3, ADDRESS2, PAID, CKMEMO, TYPE, ACCT1, ACCTAMT1, ACCT2, ACCTAMT2, ACCT3, ACCTAMT3, ACCT4, ACCTAMT4, ACCT5, ACCTAMT5, ACCT6, ACCTAMT6, ACCT7, ACCTAMT7, ACCT8, ACCTAMT8, REF, JOB, CHECKING FROM DIRCHK INTO CURSOR CUR NOCONSOLE
      Copy to &jcTmpFile Type SDF
      SELECT DIRCHK
      USE
      CREATE DBF (DATA_PATH+'\DIRCHK.DBF') ( CKNUM N ( 10 ), CKDATE D ( 8 ), CHECKNUM C ( 10 ), VENDOR C ( 10 ), PAYTO C ( 30 ), NAME C ( 30 ), ADDRESS1 C ( 30 ), ADDRESS2 C ( 30 ), ADDRESS3 C ( 30 ), PAID N ( 9, 2 ), CKMEMO C ( 30 ), TYPE C ( 1 ), ACCT1 C ( 10 ), ACCTAMT1 N ( 9, 2 ), ACCT2 C ( 10 ), ACCTAMT2 N ( 9, 2 ), ACCT3 C ( 10 ), ACCTAMT3 N ( 9, 2 ), ACCT4 C ( 10 ), ACCTAMT4 N ( 9, 2 ), ACCT5 C ( 10 ), ACCTAMT5 N ( 9, 2 ), ACCT6 C ( 10 ), ACCTAMT6 N ( 9, 2 ), ACCT7 C ( 10 ), ACCTAMT7 N ( 9, 2 ), ACCT8 C ( 10 ), ACCTAMT8 N ( 9, 2 ), REF C ( 10 ), JOB C ( 10 ), CHECKING C ( 10 ) )
      Append from &jcTmpFile Type SDF		
      INDEX ON CKNUM TAG CKNUM
      USE
      ERASE (JCTMPFILE)
      SELECT CUR
   ENDIF
   USE
ENDIF
IF FILE(DATA_PATH+'\INV-ADJ.DBF')
   IF  .NOT. FILE(DATA_PATH+'\INV-ADJ.CDX')
      CREATE DBF 'STOPGAP.DBF' ( SERVICE C ( 40 ), NEWUNIT N ( 11, 4 ), PCOGS C ( 10 ), COST N ( 10, 4 ) )
      USE
      USE IN 0 EXCLUSIVE STOPGAP
      SELECT STOPGAP
      INDEX ON SERVICE TAG SERVICE
      USE
      ERASE 'STOPGAP.DBF'
      RENAME 'STOPGAP.CDX' TO (DATA_PATH+'\INV-ADJ.CDX')
   ENDIF
   USE IN 0 (DATA_PATH+'\INV-ADJ.DBF') ALIAS INVADJ
   SELECT INVADJ
   IF TYPE('COST')='U'
      COPY TO Richie.Txt TYPE SDF
      USE
      CREATE DBF (DATA_PATH+'\INV-ADJ.DBF') ( SERVICE C ( 40 ), NEWUNIT N ( 11, 4 ), PCOGS C ( 10 ), COST N ( 10, 4 ) )
      APPEND FROM Richie.Txt TYPE SDF
      INDEX ON SERVICE TAG SERVICE
      ERASE Richie.Txt
   ENDIF
   USE
ENDIF
RETURN

PROCEDURE CHKFILES
PRIVATE PATH, CPATH, DBFFILE, MLFIRST, LDOINDEX, CINDEXFILE, CFPTFILE
= CHK4MEMO()
LDOINDEX = .F.
CINDEXFILE = ''
FOR NCOUNTER = 1 TO 40
   CINDEXFILE = MDRIVE+'\'+DBFS(NCOUNTER)+'.CDX'
   IF  .NOT. FILE(CINDEXFILE)
      LDOINDEX = .T.
   ENDIF
ENDFOR
IF LDOINDEX=.T.
   DO REINDEX WITH .F.
ENDIF

PROCEDURE CHK4MEMO
FOR NCOUNTER = 1 TO 6
   CFPTFILE = DATA_PATH+'\'+DBFS(NCOUNTER)+'.FPT'
   IF  .NOT. FILE(CFPTFILE)
      = CREATEFPT(NCOUNTER)
   ENDIF
ENDFOR

PROCEDURE CREATEFPT
PARAMETER NFILETYPE
PRIVATE CTMPFILE
IF NFILETYPE=1
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( ACCOUNT C ( 10 ), ACCTNAME C ( 30 ), ACCTTYPE C ( 3 ), PREVBAL N ( 11, 2 ), MONTHBAL N ( 11, 2 ), CURRBAL N ( 11, 2 ), A1 N ( 11, 2 ), A2 N ( 11, 2 ), A3 N ( 11, 2 ), A4 N ( 11, 2 ), A5 N ( 11, 2 ), A6 N ( 11, 2 ), A7 N ( 11, 2 ), A8 N ( 11, 2 ), A9 N ( 11, 2 ), A10 N ( 11, 2 ), A11 N ( 11, 2 ), A12 N ( 11, 2 ), B1 N ( 11, 2 ), B2 N ( 11, 2 ), B3 N ( 11, 2 ), B4 N ( 11, 2 ), B5 N ( 11, 2 ), B6 N ( 11, 2 ), B7 N ( 11, 2 ), B8 N ( 11, 2 ), B9 N ( 11, 2 ), B10 N ( 11, 2 ), B11 N ( 11, 2 ), B12 N ( 11, 2 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\ACCOUNT.FPT')
ENDIF
IF NFILETYPE=2
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( CLIENT C ( 10 ), COMPANY C ( 40 ), NAME C ( 30 ), ADDRESS C ( 30 ), CITY C ( 15 ), STATE C ( 2 ), ZIP C ( 10 ), PHONE1 C ( 13 ), PHONE2 C ( 13 ), SOCIAL C ( 11 ), DUEDAYS N ( 3 ), REMINDER D, LASTPAY D, LASTVISIT D, TOTBALAN N ( 11, 2 ), LICENSE C ( 10 ), COMPANY2 C ( 40 ), NAME2 C ( 30 ), ADDRESS2 C ( 30 ), CITY2 C ( 15 ), STATE2 C ( 2 ), ZIP2 C ( 10 ), PHONE3 C ( 13 ), PHONE4 C ( 13 ), COMMENTS C ( 40 ), TAXCODE C ( 1 ), FORWARD C ( 1 ), INTEREST C ( 1 ), MTDU N ( 12, 4 ), MTDD N ( 10, 2 ), YTDU N ( 12, 4 ), YTDD N ( 11, 2 ), LYU N ( 12, 4 ), LYD N ( 11, 2 ), CTRY C ( 20 ), CTRY2 C ( 20 ), LEVEL C ( 4 ), SLS C ( 3 ), GSTCODE C ( 1 ), ADDRESS3 C ( 30 ), ADDRESS4 C ( 30 ), VAT C ( 1 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\CLIENT.FPT')
ENDIF
IF NFILETYPE=3
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( VENDOR C ( 10 ), COMPANY C ( 40 ), NAME C ( 30 ), ADDRESS C ( 30 ), CITY C ( 15 ), STATE C ( 2 ), ZIP C ( 10 ), PHONE1 C ( 13 ), PHONE2 C ( 13 ), DISCOUNT N ( 5, 3 ), DISCDAYS N ( 2 ), DUEDAYS N ( 2 ), CRDLIMIT N ( 9, 2 ), CURRBAL N ( 11, 2 ), SALETAX N ( 4, 2 ), LASTPUR D, LASTPAY D, TAXCODE C ( 1 ), COMMENTS C ( 40 ), MTDU N ( 12, 4 ), MTDD N ( 10, 2 ), YTDU N ( 12, 4 ), YTDD N ( 11, 2 ), LYU N ( 12, 4 ), LYD N ( 11, 2 ), CTRY C ( 20 ), GSTCODE C ( 1 ), ADDRESS2 C ( 30 ), VAT C ( 1 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\VENDOR.FPT')
ENDIF
IF NFILETYPE=4
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( S_PERSON C ( 3 ), S_NAME C ( 40 ), COMMISSION N ( 8, 4 ), MTDUS N ( 11, 4 ), MTDDS N ( 11, 2 ), YTDUS N ( 11, 4 ), YTDDS N ( 11, 2 ), LYUS N ( 11, 4 ), LYDS N ( 11, 2 ), MTDCOM N ( 11, 2 ), YTDCOM N ( 11, 2 ), LYCOM N ( 11, 2 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\SALESMAN.FPT')
ENDIF
IF NFILETYPE=5
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( SERVICE C ( 40 ), SERVDESC C ( 40 ), SELLPRICE N ( 8, 2 ), TYPE C ( 1 ), COST N ( 10, 4 ), UNITS N ( 12, 4 ), DOLLARS N ( 11, 2 ), ORDER N ( 12, 4 ), COMMITT N ( 11, 4 ), PSALES C ( 10 ), PCOGS C ( 10 ), TAXABLE C ( 1 ), MANUFACT C ( 1 ), GENQTY N ( 4 ), MTDUS N ( 12, 4 ), MTDDS N ( 10, 2 ), YTDUS N ( 12, 4 ), YTDDS N ( 11, 2 ), LYUS N ( 12, 4 ), LYDS N ( 11, 2 ), MTDUP N ( 12, 4 ), MTDDP N ( 10, 2 ), YTDUP N ( 12, 4 ), YTDDP N ( 11, 2 ), LYUP N ( 12, 4 ), LYDP N ( 11, 2 ), DEPT N ( 5 ), CLASS N ( 5 ), LEVELS C ( 1 ), VENDOR C ( 10 ), GSTCODE C ( 1 ), AVECOST N ( 10, 4 ), VAT C ( 1 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\SERVICE.FPT')
ENDIF
IF NFILETYPE=6
   CTMPFILE = SYS(3)
   CREATE DBF (CTMPFILE) ( JOB C ( 10 ), JOBNAME C ( 40 ), FMNOTES M ( 10 ) )
   USE
   ERASE (CTMPFILE+'.DBF')
   RENAME (CTMPFILE+'.FPT') TO (DATA_PATH+'\JOB.FPT')
ENDIF

PROCEDURE UNIVOFCONN
ATYPE[ 1, 1] = '101'
ATYPE[ 1, 2] = 'Cash'
ATYPE[ 1, 3] = 'A01'
ATYPE[ 2, 1] = '102'
ATYPE[ 2, 2] = 'Petty Cash'
ATYPE[ 2, 3] = 'A01'
ATYPE[ 3, 1] = '105'
ATYPE[ 3, 2] = 'Short-term Invest'
ATYPE[ 3, 3] = 'A01'
ATYPE[ 4, 1] = '106'
ATYPE[ 4, 2] = 'ST Invest (Trading)'
ATYPE[ 4, 3] = 'A01'
ATYPE[ 5, 1] = '107'
ATYPE[ 5, 2] = 'ST Invest (Avail-for-Sale)'
ATYPE[ 5, 3] = 'A01'
ATYPE[ 6, 1] = '108'
ATYPE[ 6, 2] = 'ST Invest (Held-to-Mat)'
ATYPE[ 6, 3] = 'A01'
ATYPE[ 7, 1] = '111'
ATYPE[ 7, 2] = 'Accounts Receivable'
ATYPE[ 7, 3] = 'A01'
ATYPE[ 8, 1] = '112'
ATYPE[ 8, 2] = 'Allow for Doubt Accts'
ATYPE[ 8, 3] = 'A01'
ATYPE[ 9, 1] = '113'
ATYPE[ 9, 2] = 'Accts Rec Credit Cards'
ATYPE[ 9, 3] = 'A01'
ATYPE[ 10, 1] = '115'
ATYPE[ 10, 2] = 'Notes Receivable'
ATYPE[ 10, 3] = 'A01'
ATYPE[ 11, 1] = '116'
ATYPE[ 11, 2] = 'Notes Rec Disc'
ATYPE[ 11, 3] = 'A01'
ATYPE[ 12, 1] = '117'
ATYPE[ 12, 2] = 'Interest Receivable'
ATYPE[ 12, 3] = 'A01'
ATYPE[ 13, 1] = '118'
ATYPE[ 13, 2] = 'Notes Rec-Officers'
ATYPE[ 13, 3] = 'A01'
ATYPE[ 14, 1] = '130'
ATYPE[ 14, 2] = 'Merchandise Inventory'
ATYPE[ 14, 3] = 'A01'
ATYPE[ 15, 1] = '131'
ATYPE[ 15, 2] = 'Materials Inv'
ATYPE[ 15, 3] = 'A01'
ATYPE[ 16, 1] = '132'
ATYPE[ 16, 2] = 'Work-in-Process Inv'
ATYPE[ 16, 3] = 'A01'
ATYPE[ 17, 1] = '133'
ATYPE[ 17, 2] = 'Finished Goods Inv'
ATYPE[ 17, 3] = 'A01'
ATYPE[ 18, 1] = '135'
ATYPE[ 18, 2] = 'Office Supplies'
ATYPE[ 18, 3] = 'A01'
ATYPE[ 19, 1] = '136'
ATYPE[ 19, 2] = 'Store Supplies'
ATYPE[ 19, 3] = 'A01'
ATYPE[ 20, 1] = '137'
ATYPE[ 20, 2] = 'Repair Supplies'
ATYPE[ 20, 3] = 'A01'
ATYPE[ 21, 1] = '138'
ATYPE[ 21, 2] = 'Prepaid Magazine'
ATYPE[ 21, 3] = 'A01'
ATYPE[ 22, 1] = '139'
ATYPE[ 22, 2] = 'Work-in-Process,'
ATYPE[ 22, 3] = 'A01'
ATYPE[ 23, 1] = '140'
ATYPE[ 23, 2] = 'Work-in-Process,'
ATYPE[ 23, 3] = 'A01'
ATYPE[ 24, 1] = '141'
ATYPE[ 24, 2] = 'Prepaid Insurance'
ATYPE[ 24, 3] = 'A01'
ATYPE[ 25, 1] = '142'
ATYPE[ 25, 2] = 'Prepaid Rent'
ATYPE[ 25, 3] = 'A01'
ATYPE[ 26, 1] = '143'
ATYPE[ 26, 2] = 'Prepaid Advertising'
ATYPE[ 26, 3] = 'A01'
ATYPE[ 27, 1] = '145'
ATYPE[ 27, 2] = 'LT Invest (Avail-for-Sale)'
ATYPE[ 27, 3] = 'A03'
ATYPE[ 28, 1] = '146'
ATYPE[ 28, 2] = 'LT Invest (Held-to-Mat)'
ATYPE[ 28, 3] = 'A03'
ATYPE[ 29, 1] = '147'
ATYPE[ 29, 2] = 'LT Invest in Stock'
ATYPE[ 29, 3] = 'A03'
ATYPE[ 30, 1] = '148'
ATYPE[ 30, 2] = 'Invest in Subsidiary'
ATYPE[ 30, 3] = 'A03'
ATYPE[ 31, 1] = '151'
ATYPE[ 31, 2] = 'Land'
ATYPE[ 31, 3] = 'A02'
ATYPE[ 32, 1] = '153'
ATYPE[ 32, 2] = 'Building'
ATYPE[ 32, 3] = 'A02'
ATYPE[ 33, 1] = '154'
ATYPE[ 33, 2] = 'Accum Depre-Bldg'
ATYPE[ 33, 3] = 'A02'
ATYPE[ 34, 1] = '155'
ATYPE[ 34, 2] = 'Store Building'
ATYPE[ 34, 3] = 'A02'
ATYPE[ 35, 1] = '156'
ATYPE[ 35, 2] = 'Accum Depre-Store Bldg'
ATYPE[ 35, 3] = 'A02'
ATYPE[ 36, 1] = '157'
ATYPE[ 36, 2] = 'Office Building'
ATYPE[ 36, 3] = 'A02'
ATYPE[ 37, 1] = '158'
ATYPE[ 37, 2] = 'Accum Depre-Office Bldg'
ATYPE[ 37, 3] = 'A02'
ATYPE[ 38, 1] = '159'
ATYPE[ 38, 2] = 'Equipment'
ATYPE[ 38, 3] = 'A02'
ATYPE[ 39, 1] = '160'
ATYPE[ 39, 2] = 'Accum Depre-Equip'
ATYPE[ 39, 3] = 'A02'
ATYPE[ 40, 1] = '161'
ATYPE[ 40, 2] = 'Machinery'
ATYPE[ 40, 3] = 'A02'
ATYPE[ 41, 1] = '162'
ATYPE[ 41, 2] = 'Accum Depre-Mach'
ATYPE[ 41, 3] = 'A02'
ATYPE[ 42, 1] = '165'
ATYPE[ 42, 2] = 'Store Furniture'
ATYPE[ 42, 3] = 'A02'
ATYPE[ 43, 1] = '166'
ATYPE[ 43, 2] = 'Accum Depre-Store Furn'
ATYPE[ 43, 3] = 'A02'
ATYPE[ 44, 1] = '167'
ATYPE[ 44, 2] = 'Delivery Equip'
ATYPE[ 44, 3] = 'A02'
ATYPE[ 45, 1] = '168'
ATYPE[ 45, 2] = 'Accum Depre-Del Equip'
ATYPE[ 45, 3] = 'A02'
ATYPE[ 46, 1] = '169'
ATYPE[ 46, 2] = 'Trucks'
ATYPE[ 46, 3] = 'A02'
ATYPE[ 47, 1] = '170'
ATYPE[ 47, 2] = 'Accum Depre-Trucks'
ATYPE[ 47, 3] = 'A02'
ATYPE[ 48, 1] = '171'
ATYPE[ 48, 2] = 'Office Equip'
ATYPE[ 48, 3] = 'A02'
ATYPE[ 49, 1] = '172'
ATYPE[ 49, 2] = 'Accum Depre-Office Equip'
ATYPE[ 49, 3] = 'A02'
ATYPE[ 50, 1] = '173'
ATYPE[ 50, 2] = 'Automobiles'
ATYPE[ 50, 3] = 'A02'
ATYPE[ 51, 1] = '174'
ATYPE[ 51, 2] = 'Accum Depre-Auto'
ATYPE[ 51, 3] = 'A02'
ATYPE[ 52, 1] = '175'
ATYPE[ 52, 2] = 'Auto Equip'
ATYPE[ 52, 3] = 'A02'
ATYPE[ 53, 1] = '176'
ATYPE[ 53, 2] = 'Accum Depre-Auto Equip'
ATYPE[ 53, 3] = 'A02'
ATYPE[ 54, 1] = '177'
ATYPE[ 54, 2] = 'Computer System'
ATYPE[ 54, 3] = 'A02'
ATYPE[ 55, 1] = '178'
ATYPE[ 55, 2] = 'Accum Depre-Computer'
ATYPE[ 55, 3] = 'A02'
ATYPE[ 56, 1] = '179'
ATYPE[ 56, 2] = 'Cleaning Equip'
ATYPE[ 56, 3] = 'A02'
ATYPE[ 57, 1] = '180'
ATYPE[ 57, 2] = 'Accum Depre-Clean Equip'
ATYPE[ 57, 3] = 'A02'
ATYPE[ 58, 1] = '185'
ATYPE[ 58, 2] = 'Plumbing Equip'
ATYPE[ 58, 3] = 'A02'
ATYPE[ 59, 1] = '186'
ATYPE[ 59, 2] = 'Accum Depre-Plumb Equip'
ATYPE[ 59, 3] = 'A02'
ATYPE[ 60, 1] = '190'
ATYPE[ 60, 2] = 'Organization Costs'
ATYPE[ 60, 3] = 'A03'
ATYPE[ 61, 1] = '191'
ATYPE[ 61, 2] = 'Patents'
ATYPE[ 61, 3] = 'A03'
ATYPE[ 62, 1] = '192'
ATYPE[ 62, 2] = 'Trademarks'
ATYPE[ 62, 3] = 'A03'
ATYPE[ 63, 1] = '193'
ATYPE[ 63, 2] = 'Goodwill'
ATYPE[ 63, 3] = 'A03'
ATYPE[ 64, 1] = '194'
ATYPE[ 64, 2] = 'Copyrights'
ATYPE[ 64, 3] = 'A03'
ATYPE[ 65, 1] = '195'
ATYPE[ 65, 2] = 'Computer Software Costs'
ATYPE[ 65, 3] = 'A03'
ATYPE[ 66, 1] = '196'
ATYPE[ 66, 2] = 'Franchises'
ATYPE[ 66, 3] = 'A03'
ATYPE[ 67, 1] = '197'
ATYPE[ 67, 2] = 'Lease Rights'
ATYPE[ 67, 3] = 'A03'
ATYPE[ 68, 1] = '198'
ATYPE[ 68, 2] = 'Leasehold Improve'
ATYPE[ 68, 3] = 'A03'
ATYPE[ 69, 1] = '199'
ATYPE[ 69, 2] = 'Mining Properties'
ATYPE[ 69, 3] = 'A03'
ATYPE[ 70, 1] = '201'
ATYPE[ 70, 2] = 'Accounts Payable'
ATYPE[ 70, 3] = 'L01'
ATYPE[ 71, 1] = '202'
ATYPE[ 71, 2] = 'Notes Payable'
ATYPE[ 71, 3] = 'L01'
ATYPE[ 72, 1] = '203'
ATYPE[ 72, 2] = 'Discount on Notes Pay'
ATYPE[ 72, 3] = 'L01'
ATYPE[ 73, 1] = '204'
ATYPE[ 73, 2] = 'Interest Payable'
ATYPE[ 73, 3] = 'L01'
ATYPE[ 74, 1] = '205'
ATYPE[ 74, 2] = 'Salaries Payable'
ATYPE[ 74, 3] = 'L01'
ATYPE[ 75, 1] = '206'
ATYPE[ 75, 2] = 'Vouchers Payable'
ATYPE[ 75, 3] = 'L01'
ATYPE[ 76, 1] = '211'
ATYPE[ 76, 2] = 'Div Pay-Pref Stock'
ATYPE[ 76, 3] = 'L01'
ATYPE[ 77, 1] = '212'
ATYPE[ 77, 2] = 'Div Pay-Com Stock'
ATYPE[ 77, 3] = 'L01'
ATYPE[ 78, 1] = '215'
ATYPE[ 78, 2] = 'Income Taxes Pay'
ATYPE[ 78, 3] = 'L01'
ATYPE[ 79, 1] = '216'
ATYPE[ 79, 2] = 'Sales Taxes Pay'
ATYPE[ 79, 3] = 'L01'
ATYPE[ 80, 1] = '218'
ATYPE[ 80, 2] = 'Lia for Vacation Pay'
ATYPE[ 80, 3] = 'L01'
ATYPE[ 81, 1] = '221'
ATYPE[ 81, 2] = 'FICA Taxes Pay'
ATYPE[ 81, 3] = 'L01'
ATYPE[ 82, 1] = '222'
ATYPE[ 82, 2] = 'Fed Tax Withhold Pay'
ATYPE[ 82, 3] = 'L01'
ATYPE[ 83, 1] = '223'
ATYPE[ 83, 2] = 'State Tax Withhold Pay'
ATYPE[ 83, 3] = 'L01'
ATYPE[ 84, 1] = '224'
ATYPE[ 84, 2] = 'State Unemploy Taxes Pay'
ATYPE[ 84, 3] = 'L01'
ATYPE[ 85, 1] = '225'
ATYPE[ 85, 2] = 'Fed Unemploy Taxes Pay'
ATYPE[ 85, 3] = 'L01'
ATYPE[ 86, 1] = '226'
ATYPE[ 86, 2] = 'Union Dues Withhold Pay'
ATYPE[ 86, 3] = 'L01'
ATYPE[ 87, 1] = '227'
ATYPE[ 87, 2] = 'Group Health Insur Pre Pay'
ATYPE[ 87, 3] = 'L01'
ATYPE[ 88, 1] = '228'
ATYPE[ 88, 2] = 'U.S. Bonds Withhold Pay'
ATYPE[ 88, 3] = 'L01'
ATYPE[ 89, 1] = '229'
ATYPE[ 89, 2] = 'Comm Fund Withhold Pay'
ATYPE[ 89, 3] = 'L01'
ATYPE[ 90, 1] = '230'
ATYPE[ 90, 2] = 'Unearned Revenue'
ATYPE[ 90, 3] = 'L01'
ATYPE[ 91, 1] = '231'
ATYPE[ 91, 2] = 'Unearned Rent'
ATYPE[ 91, 3] = 'L01'
ATYPE[ 92, 1] = '232'
ATYPE[ 92, 2] = 'Unearned Subscriptions'
ATYPE[ 92, 3] = 'L01'
ATYPE[ 93, 1] = '233'
ATYPE[ 93, 2] = 'Unearned Service Rev'
ATYPE[ 93, 3] = 'L01'
ATYPE[ 94, 1] = '234'
ATYPE[ 94, 2] = 'Unearned Park Lot Rev'
ATYPE[ 94, 3] = 'L01'
ATYPE[ 95, 1] = '235'
ATYPE[ 95, 2] = 'Unearned Prof Fees'
ATYPE[ 95, 3] = 'L01'
ATYPE[ 96, 1] = '236'
ATYPE[ 96, 2] = 'Unearned Advertising'
ATYPE[ 96, 3] = 'L01'
ATYPE[ 97, 1] = '249'
ATYPE[ 97, 2] = 'Inventory Adjustment Credits'
ATYPE[ 97, 3] = 'L01'
ATYPE[ 98, 1] = '251'
ATYPE[ 98, 2] = 'Mortgage Payable'
ATYPE[ 98, 3] = 'L02'
ATYPE[ 99, 1] = '252'
ATYPE[ 99, 2] = 'Notes Payable-LT'
ATYPE[ 99, 3] = 'L02'
ATYPE[ 100, 1] = '261'
ATYPE[ 100, 2] = 'Bonds Payable'
ATYPE[ 100, 3] = 'L02'
ATYPE[ 101, 1] = '266'
ATYPE[ 101, 2] = 'Pre on Bonds Pay'
ATYPE[ 101, 3] = 'L02'
ATYPE[ 102, 1] = '267'
ATYPE[ 102, 2] = 'Disc on Bonds Pay'
ATYPE[ 102, 3] = 'L02'
ATYPE[ 103, 1] = '33'
ATYPE[ 103, 2] = 'Profit/Loss'
ATYPE[ 103, 3] = 'C01'
ATYPE[ 104, 1] = '301'
ATYPE[ 104, 2] = 'Capital'
ATYPE[ 104, 3] = 'C01'
ATYPE[ 105, 1] = '311'
ATYPE[ 105, 2] = 'Withdrawals'
ATYPE[ 105, 3] = 'C01'
ATYPE[ 106, 1] = '321'
ATYPE[ 106, 2] = 'Preferred Stock'
ATYPE[ 106, 3] = 'C01'
ATYPE[ 107, 1] = '325'
ATYPE[ 107, 2] = 'Add Pd-in Cap-Pref'
ATYPE[ 107, 3] = 'C01'
ATYPE[ 108, 1] = '331'
ATYPE[ 108, 2] = 'Common Stock'
ATYPE[ 108, 3] = 'C01'
ATYPE[ 109, 1] = '333'
ATYPE[ 109, 2] = 'Stock Div to Be Issued, Com'
ATYPE[ 109, 3] = 'C01'
ATYPE[ 110, 1] = '341'
ATYPE[ 110, 2] = 'Add Pd-in Cap-Com'
ATYPE[ 110, 3] = 'C01'
ATYPE[ 111, 1] = '345'
ATYPE[ 111, 2] = 'Add Pd-in Cap-Treas Sk'
ATYPE[ 111, 3] = 'C01'
ATYPE[ 112, 1] = '349'
ATYPE[ 112, 2] = 'Paid-in Cap-Donations'
ATYPE[ 112, 3] = 'C01'
ATYPE[ 113, 1] = '360'
ATYPE[ 113, 2] = 'Retained Earnings'
ATYPE[ 113, 3] = 'C01'
ATYPE[ 114, 1] = '364'
ATYPE[ 114, 2] = 'Unrealized Gain (Loss) on Avai'
ATYPE[ 114, 3] = 'C01'
ATYPE[ 115, 1] = '366'
ATYPE[ 115, 2] = 'Treasury Stock-Pref'
ATYPE[ 115, 3] = 'C01'
ATYPE[ 116, 1] = '367'
ATYPE[ 116, 2] = 'Treasury Stock-Com'
ATYPE[ 116, 3] = 'C01'
ATYPE[ 117, 1] = '371'
ATYPE[ 117, 2] = 'Div-Pref Stock'
ATYPE[ 117, 3] = 'C01'
ATYPE[ 118, 1] = '372'
ATYPE[ 118, 2] = 'Div-Com Stock'
ATYPE[ 118, 3] = 'C01'
ATYPE[ 119, 1] = '376'
ATYPE[ 119, 2] = 'Stock Div-Pref Stock'
ATYPE[ 119, 3] = 'C01'
ATYPE[ 120, 1] = '377'
ATYPE[ 120, 2] = 'Stock Div-Com Stock'
ATYPE[ 120, 3] = 'C01'
ATYPE[ 121, 1] = '401'
ATYPE[ 121, 2] = 'Sales'
ATYPE[ 121, 3] = 'R01'
ATYPE[ 122, 1] = '402'
ATYPE[ 122, 2] = 'Sales Ret and Allow'
ATYPE[ 122, 3] = 'R01'
ATYPE[ 123, 1] = '403'
ATYPE[ 123, 2] = 'Sales Discounts'
ATYPE[ 123, 3] = 'R01'
ATYPE[ 124, 1] = '410'
ATYPE[ 124, 2] = 'Revenue'
ATYPE[ 124, 3] = 'R01'
ATYPE[ 125, 1] = '411'
ATYPE[ 125, 2] = 'Repair Rev'
ATYPE[ 125, 3] = 'R01'
ATYPE[ 126, 1] = '412'
ATYPE[ 126, 2] = 'Subscrip Rev'
ATYPE[ 126, 3] = 'R01'
ATYPE[ 127, 1] = '413'
ATYPE[ 127, 2] = 'Service Rev'
ATYPE[ 127, 3] = 'R01'
ATYPE[ 128, 1] = '414'
ATYPE[ 128, 2] = 'Special Events Rev'
ATYPE[ 128, 3] = 'R01'
ATYPE[ 129, 1] = '415'
ATYPE[ 129, 2] = 'Parking Lot Rev'
ATYPE[ 129, 3] = 'R01'
ATYPE[ 130, 1] = '416'
ATYPE[ 130, 2] = 'Copying Rev'
ATYPE[ 130, 3] = 'R01'
ATYPE[ 131, 1] = '417'
ATYPE[ 131, 2] = 'Acct Fee Rev'
ATYPE[ 131, 3] = 'R01'
ATYPE[ 132, 1] = '418'
ATYPE[ 132, 2] = 'Plumbing Rev'
ATYPE[ 132, 3] = 'R01'
ATYPE[ 133, 1] = '419'
ATYPE[ 133, 2] = 'Commissions Rev'
ATYPE[ 133, 3] = 'R01'
ATYPE[ 134, 1] = '420'
ATYPE[ 134, 2] = 'Trucking Rev'
ATYPE[ 134, 3] = 'R01'
ATYPE[ 135, 1] = '421'
ATYPE[ 135, 2] = 'Grooming Rev'
ATYPE[ 135, 3] = 'R01'
ATYPE[ 136, 1] = '422'
ATYPE[ 136, 2] = 'Rug Clean Fees Rev'
ATYPE[ 136, 3] = 'R01'
ATYPE[ 137, 1] = '423'
ATYPE[ 137, 2] = 'Prof Fees Rev'
ATYPE[ 137, 3] = 'R01'
ATYPE[ 138, 1] = '424'
ATYPE[ 138, 2] = 'Medical Service Rev'
ATYPE[ 138, 3] = 'R01'
ATYPE[ 139, 1] = '425'
ATYPE[ 139, 2] = 'Baking Rev'
ATYPE[ 139, 3] = 'R01'
ATYPE[ 140, 1] = '501'
ATYPE[ 140, 2] = 'Purchases'
ATYPE[ 140, 3] = 'E01'
ATYPE[ 141, 1] = '502'
ATYPE[ 141, 2] = 'Trans In'
ATYPE[ 141, 3] = 'E01'
ATYPE[ 142, 1] = '503'
ATYPE[ 142, 2] = 'Pur Ret and Allow'
ATYPE[ 142, 3] = 'E01'
ATYPE[ 143, 1] = '504'
ATYPE[ 143, 2] = 'Purchases Disc'
ATYPE[ 143, 3] = 'E01'
ATYPE[ 144, 1] = '511'
ATYPE[ 144, 2] = 'Cost of Goods Sold'
ATYPE[ 144, 3] = 'E01'
ATYPE[ 145, 1] = '515'
ATYPE[ 145, 2] = 'Factory Payroll'
ATYPE[ 145, 3] = 'E01'
ATYPE[ 146, 1] = '520'
ATYPE[ 146, 2] = 'Inventory Adjustments'
ATYPE[ 146, 3] = 'E01'
ATYPE[ 147, 1] = '530'
ATYPE[ 147, 2] = 'Mfg Over Control'
ATYPE[ 147, 3] = 'E01'
ATYPE[ 148, 1] = '601'
ATYPE[ 148, 2] = 'Selling Expenses'
ATYPE[ 148, 3] = 'E01'
ATYPE[ 149, 1] = '602'
ATYPE[ 149, 2] = 'Sales Sal Exp'
ATYPE[ 149, 3] = 'E01'
ATYPE[ 150, 1] = '603'
ATYPE[ 150, 2] = 'Delivery Sal Exp'
ATYPE[ 150, 3] = 'E01'
ATYPE[ 151, 1] = '605'
ATYPE[ 151, 2] = 'Commission Exp'
ATYPE[ 151, 3] = 'E01'
ATYPE[ 152, 1] = '609'
ATYPE[ 152, 2] = 'Rent Exp-Med Equip'
ATYPE[ 152, 3] = 'E01'
ATYPE[ 153, 1] = '610'
ATYPE[ 153, 2] = 'Rent Exp-Plumb Equip'
ATYPE[ 153, 3] = 'E01'
ATYPE[ 154, 1] = '611'
ATYPE[ 154, 2] = 'Rent Exp-Warehouse'
ATYPE[ 154, 3] = 'E01'
ATYPE[ 155, 1] = '612'
ATYPE[ 155, 2] = 'Rent Exp-Shop Bldg'
ATYPE[ 155, 3] = 'E01'
ATYPE[ 156, 1] = '613'
ATYPE[ 156, 2] = 'Rent Exp-Auto Equip'
ATYPE[ 156, 3] = 'E01'
ATYPE[ 157, 1] = '614'
ATYPE[ 157, 2] = 'Rent Exp-Trucks'
ATYPE[ 157, 3] = 'E01'
ATYPE[ 158, 1] = '615'
ATYPE[ 158, 2] = 'Rent Exp'
ATYPE[ 158, 3] = 'E01'
ATYPE[ 159, 1] = '616'
ATYPE[ 159, 2] = 'Advertising Exp'
ATYPE[ 159, 3] = 'E01'
ATYPE[ 160, 1] = '617'
ATYPE[ 160, 2] = 'Trans Out Exp'
ATYPE[ 160, 3] = 'E01'
ATYPE[ 161, 1] = '618'
ATYPE[ 161, 2] = 'Gas/Oil Exp'
ATYPE[ 161, 3] = 'E01'
ATYPE[ 162, 1] = '619'
ATYPE[ 162, 2] = 'Store Supp Exp'
ATYPE[ 162, 3] = 'E01'
ATYPE[ 163, 1] = '620'
ATYPE[ 163, 2] = 'Repair Supp Exp'
ATYPE[ 163, 3] = 'E01'
ATYPE[ 164, 1] = '621'
ATYPE[ 164, 2] = 'Delivery Exp'
ATYPE[ 164, 3] = 'E01'
ATYPE[ 165, 1] = '622'
ATYPE[ 165, 2] = 'Sales Promo Exp'
ATYPE[ 165, 3] = 'E01'
ATYPE[ 166, 1] = '623'
ATYPE[ 166, 2] = 'Dupl Supp Exp'
ATYPE[ 166, 3] = 'E01'
ATYPE[ 167, 1] = '624'
ATYPE[ 167, 2] = 'Plumb Supp Exp'
ATYPE[ 167, 3] = 'E01'
ATYPE[ 168, 1] = '625'
ATYPE[ 168, 2] = 'Utilities Exp'
ATYPE[ 168, 3] = 'E01'
ATYPE[ 169, 1] = '626'
ATYPE[ 169, 2] = 'Insurance Exp'
ATYPE[ 169, 3] = 'E01'
ATYPE[ 170, 1] = '651'
ATYPE[ 170, 2] = 'Depre Exp-Store Bldg'
ATYPE[ 170, 3] = 'E01'
ATYPE[ 171, 1] = '661'
ATYPE[ 171, 2] = 'Depre Exp-Store Furn'
ATYPE[ 171, 3] = 'E01'
ATYPE[ 172, 1] = '662'
ATYPE[ 172, 2] = 'Depre Exp-Del Equip'
ATYPE[ 172, 3] = 'E01'
ATYPE[ 173, 1] = '663'
ATYPE[ 173, 2] = 'Depre Exp-Trucks'
ATYPE[ 173, 3] = 'E01'
ATYPE[ 174, 1] = '664'
ATYPE[ 174, 2] = 'Depre Exp-Store Equip'
ATYPE[ 174, 3] = 'E01'
ATYPE[ 175, 1] = '691'
ATYPE[ 175, 2] = 'Misc Sell Exp'
ATYPE[ 175, 3] = 'E01'
ATYPE[ 176, 1] = '701'
ATYPE[ 176, 2] = 'Gen and Admin Exp'
ATYPE[ 176, 3] = 'E01'
ATYPE[ 177, 1] = '702'
ATYPE[ 177, 2] = 'Admin Sal Exp'
ATYPE[ 177, 3] = 'E01'
ATYPE[ 178, 1] = '703'
ATYPE[ 178, 2] = 'Office Sal Exp'
ATYPE[ 178, 3] = 'E01'
ATYPE[ 179, 1] = '704'
ATYPE[ 179, 2] = 'Employees Bonus Exp'
ATYPE[ 179, 3] = 'E01'
ATYPE[ 180, 1] = '705'
ATYPE[ 180, 2] = 'Salaries Expense'
ATYPE[ 180, 3] = 'E01'
ATYPE[ 181, 1] = '709'
ATYPE[ 181, 2] = 'Payroll Tax Exp'
ATYPE[ 181, 3] = 'E01'
ATYPE[ 182, 1] = '710'
ATYPE[ 182, 2] = 'Vacation Pay Exp'
ATYPE[ 182, 3] = 'E01'
ATYPE[ 183, 1] = '711'
ATYPE[ 183, 2] = 'Rent Exp-Bldg'
ATYPE[ 183, 3] = 'E01'
ATYPE[ 184, 1] = '712'
ATYPE[ 184, 2] = 'Rent Exp-Office Equip'
ATYPE[ 184, 3] = 'E01'
ATYPE[ 185, 1] = '713'
ATYPE[ 185, 2] = 'Rent Exp-Warehouse'
ATYPE[ 185, 3] = 'E01'
ATYPE[ 186, 1] = '715'
ATYPE[ 186, 2] = 'Rent Expense'
ATYPE[ 186, 3] = 'E01'
ATYPE[ 187, 1] = '716'
ATYPE[ 187, 2] = 'Property Tax Exp'
ATYPE[ 187, 3] = 'E01'
ATYPE[ 188, 1] = '717'
ATYPE[ 188, 2] = 'Office Expense'
ATYPE[ 188, 3] = 'E01'
ATYPE[ 189, 1] = '718'
ATYPE[ 189, 2] = 'Office Supp Exp'
ATYPE[ 189, 3] = 'E01'
ATYPE[ 190, 1] = '719'
ATYPE[ 190, 2] = 'Insurance Expense'
ATYPE[ 190, 3] = 'E01'
ATYPE[ 191, 1] = '720'
ATYPE[ 191, 2] = 'Postage Expense'
ATYPE[ 191, 3] = 'E01'
ATYPE[ 192, 1] = '721'
ATYPE[ 192, 2] = 'Utilities Expense'
ATYPE[ 192, 3] = 'E01'
ATYPE[ 193, 1] = '722'
ATYPE[ 193, 2] = 'Telephone Expense'
ATYPE[ 193, 3] = 'E01'
ATYPE[ 194, 1] = '723'
ATYPE[ 194, 2] = 'Repairs Expense'
ATYPE[ 194, 3] = 'E01'
ATYPE[ 195, 1] = '724'
ATYPE[ 195, 2] = 'Security Expense'
ATYPE[ 195, 3] = 'E01'
ATYPE[ 196, 1] = '725'
ATYPE[ 196, 2] = 'Cleaning Expense'
ATYPE[ 196, 3] = 'E01'
ATYPE[ 197, 1] = '726'
ATYPE[ 197, 2] = 'Gas/Oil Expense'
ATYPE[ 197, 3] = 'E01'
ATYPE[ 198, 1] = '728'
ATYPE[ 198, 2] = 'Magazine Expense'
ATYPE[ 198, 3] = 'E01'
ATYPE[ 199, 1] = '731'
ATYPE[ 199, 2] = 'Bad Debts Expense'
ATYPE[ 199, 3] = 'E01'
ATYPE[ 200, 1] = '732'
ATYPE[ 200, 2] = 'Bank Ser Charge Exp'
ATYPE[ 200, 3] = 'E01'
ATYPE[ 201, 1] = '733'
ATYPE[ 201, 2] = 'Collection Fee Exp'
ATYPE[ 201, 3] = 'E01'
ATYPE[ 202, 1] = '751'
ATYPE[ 202, 2] = 'Depre Exp-Bldg'
ATYPE[ 202, 3] = 'E01'
ATYPE[ 203, 1] = '752'
ATYPE[ 203, 2] = 'Depre Exp-Off Bldg'
ATYPE[ 203, 3] = 'E01'
ATYPE[ 204, 1] = '753'
ATYPE[ 204, 2] = 'Depre Exp-Equip'
ATYPE[ 204, 3] = 'E01'
ATYPE[ 205, 1] = '754'
ATYPE[ 205, 2] = 'Depre Exp-Off Equip'
ATYPE[ 205, 3] = 'E01'
ATYPE[ 206, 1] = '755'
ATYPE[ 206, 2] = 'Depre Exp-Auto'
ATYPE[ 206, 3] = 'E01'
ATYPE[ 207, 1] = '756'
ATYPE[ 207, 2] = 'Depre Exp-Auto Equip'
ATYPE[ 207, 3] = 'E01'
ATYPE[ 208, 1] = '757'
ATYPE[ 208, 2] = 'Depre Exp-Computer'
ATYPE[ 208, 3] = 'E01'
ATYPE[ 209, 1] = '758'
ATYPE[ 209, 2] = 'Depre Exp-Clean Equip'
ATYPE[ 209, 3] = 'E01'
ATYPE[ 210, 1] = '759'
ATYPE[ 210, 2] = 'Depre Exp-Trucks'
ATYPE[ 210, 3] = 'E01'
ATYPE[ 211, 1] = '771'
ATYPE[ 211, 2] = 'Amort Exp-Patents'
ATYPE[ 211, 3] = 'E01'
ATYPE[ 212, 1] = '772'
ATYPE[ 212, 2] = 'Amort Exp-Trademarks'
ATYPE[ 212, 3] = 'E01'
ATYPE[ 213, 1] = '773'
ATYPE[ 213, 2] = 'Amort Exp-Goodwill'
ATYPE[ 213, 3] = 'E01'
ATYPE[ 214, 1] = '774'
ATYPE[ 214, 2] = 'Amort Exp-Copyrights'
ATYPE[ 214, 3] = 'E01'
ATYPE[ 215, 1] = '775'
ATYPE[ 215, 2] = 'Amort Exp-Software'
ATYPE[ 215, 3] = 'E01'
ATYPE[ 216, 1] = '776'
ATYPE[ 216, 2] = 'Amort Exp-Franchises'
ATYPE[ 216, 3] = 'E01'
ATYPE[ 217, 1] = '777'
ATYPE[ 217, 2] = 'Amort Exp-Lease Rights'
ATYPE[ 217, 3] = 'E01'
ATYPE[ 218, 1] = '778'
ATYPE[ 218, 2] = 'Amort Exp-Lease Improve'
ATYPE[ 218, 3] = 'E01'
ATYPE[ 219, 1] = '791'
ATYPE[ 219, 2] = 'Misc Gen Exp'
ATYPE[ 219, 3] = 'E01'
ATYPE[ 220, 1] = '792'
ATYPE[ 220, 2] = 'Cash Over/Short'
ATYPE[ 220, 3] = 'E01'
ATYPE[ 221, 1] = '801'
ATYPE[ 221, 2] = 'Other Revenues'
ATYPE[ 221, 3] = 'R02'
ATYPE[ 222, 1] = '802'
ATYPE[ 222, 2] = 'Interest Revenue'
ATYPE[ 222, 3] = 'R02'
ATYPE[ 223, 1] = '803'
ATYPE[ 223, 2] = 'Rent Revenue'
ATYPE[ 223, 3] = 'R02'
ATYPE[ 224, 1] = '804'
ATYPE[ 224, 2] = 'Bad Debts Recovered'
ATYPE[ 224, 3] = 'R02'
ATYPE[ 225, 1] = '805'
ATYPE[ 225, 2] = 'Dividends Revenue'
ATYPE[ 225, 3] = 'R02'
ATYPE[ 226, 1] = '811'
ATYPE[ 226, 2] = 'Gain on Sale of Equip'
ATYPE[ 226, 3] = 'R02'
ATYPE[ 227, 1] = '812'
ATYPE[ 227, 2] = 'Gain on Sale of Assets'
ATYPE[ 227, 3] = 'R02'
ATYPE[ 228, 1] = '813'
ATYPE[ 228, 2] = 'Gain on Retire of Bonds Pay'
ATYPE[ 228, 3] = 'R02'
ATYPE[ 229, 1] = '814'
ATYPE[ 229, 2] = 'Gain on Sale of______'
ATYPE[ 229, 3] = 'R02'
ATYPE[ 230, 1] = '821'
ATYPE[ 230, 2] = 'Unrealized Gain on Invest'
ATYPE[ 230, 3] = 'R02'
ATYPE[ 231, 1] = '822'
ATYPE[ 231, 2] = 'Realized Gain on Invest'
ATYPE[ 231, 3] = 'R02'
ATYPE[ 232, 1] = '830'
ATYPE[ 232, 2] = 'Equity in Investee Inc'
ATYPE[ 232, 3] = 'R02'
ATYPE[ 233, 1] = '841'
ATYPE[ 233, 2] = 'Misc Revenue'
ATYPE[ 233, 3] = 'R02'
ATYPE[ 234, 1] = '842'
ATYPE[ 234, 2] = 'Sales Disc Not Taken'
ATYPE[ 234, 3] = 'R02'
ATYPE[ 235, 1] = '851'
ATYPE[ 235, 2] = 'Other Expenses'
ATYPE[ 235, 3] = 'E03'
ATYPE[ 236, 1] = '852'
ATYPE[ 236, 2] = 'Interest Expense'
ATYPE[ 236, 3] = 'E03'
ATYPE[ 237, 1] = '853'
ATYPE[ 237, 2] = 'Credit Card Fees Exp'
ATYPE[ 237, 3] = 'E03'
ATYPE[ 238, 1] = '861'
ATYPE[ 238, 2] = 'Loss on Sale of Equip'
ATYPE[ 238, 3] = 'E03'
ATYPE[ 239, 1] = '862'
ATYPE[ 239, 2] = 'Loss on Sale of Assets'
ATYPE[ 239, 3] = 'E03'
ATYPE[ 240, 1] = '863'
ATYPE[ 240, 2] = 'Loss on Retire of Bonds Pay'
ATYPE[ 240, 3] = 'E03'
ATYPE[ 241, 1] = '864'
ATYPE[ 241, 2] = 'Loss on Sale of________'
ATYPE[ 241, 3] = 'E03'
ATYPE[ 242, 1] = '871'
ATYPE[ 242, 2] = 'Unrealized Loss on Invest'
ATYPE[ 242, 3] = 'E03'
ATYPE[ 243, 1] = '872'
ATYPE[ 243, 2] = 'Realized Loss on Invest'
ATYPE[ 243, 3] = 'E03'
ATYPE[ 244, 1] = '880'
ATYPE[ 244, 2] = 'Equity in Investee Loss'
ATYPE[ 244, 3] = 'E03'
ATYPE[ 245, 1] = '889'
ATYPE[ 245, 2] = 'Misc Expense'
ATYPE[ 245, 3] = 'E03'
ATYPE[ 246, 1] = '890'
ATYPE[ 246, 2] = 'Pur Disc Lost'
ATYPE[ 246, 3] = 'E03'
ATYPE[ 247, 1] = '901'
ATYPE[ 247, 2] = 'Fed Inc Tax Exp'
ATYPE[ 247, 3] = 'E02'
ATYPE[ 248, 1] = '902'
ATYPE[ 248, 2] = 'State Inc Tax Exp'
ATYPE[ 248, 3] = 'E02'
ATYPE[ 249, 1] = '904'
ATYPE[ 249, 2] = 'Sales Tax Exp'
ATYPE[ 249, 3] = 'E02'
APPEND FROM ARRAY ATYPE
USE

FUNCTION  CHECKBAL
PARAMETER CCHECKCODE
IF  .NOT. USED('ACCOUNT')
   USE IN 0 (MDRIVE+'\ACCOUNT')
ENDIF
SELECT ACCOUNT
SET ORDER TO ACCOUNT
IF  .NOT. USED('GLTRAN')
   USE IN 0 (MDRIVE+'\GLTRAN')
ENDIF
IF  .NOT. USED('DIRCHK')
   USE IN 0 (MDRIVE+'\DIRCHK')
ENDIF
IF  .NOT. USED('PAYABLE')
   USE IN 0 (MDRIVE+'\PAYABLE')
ENDIF
IF  .NOT. USED('PAYLINE')
   USE IN 0 (MDRIVE+'\PAYLINE')
ENDIF
SELECT GLTRAN
SUM ALL FOR GLACCT=CCHECKCODE .AND. POSTED<>'Y' (GLDEBIT-GLCREDIT) TO NGLBALANCE
SELECT DIRCHK
SUM ALL FOR CHECKING=CCHECKCODE .AND. TYPE$'MCEP' PAID TO NCRCHECK
SUM ALL FOR CHECKING=CCHECKCODE .AND. TYPE$'DI' PAID TO NDRCHECK
SELECT PAYABLE
SUM ALL FOR CACCT=CCHECKCODE PAID TO NPAYAP
SELECT PAYLINE
SUM ALL FOR PAYACCT=CCHECKCODE (PAYDEBIT-PAYCREDIT) TO NAPTRN
SELECT ACCOUNT
SEEK CCHECKCODE
NAMOUNT = (CURRBAL+NGLBALANCE+NDRCHECK+NAPTRN)-(NPAYAP+NCRCHECK)
RETURN (NAMOUNT)

PROCEDURE HELPABOUT
IF FILE('EZAACC.ICO')
   DO ezabout.spr
ELSE
   DO P00About.SPR
ENDIF
