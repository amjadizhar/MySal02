* PROGRAM: REPLDGR1.PRG
* TO GET DATA FOR CREATING LEDGER REPORT
* PROGRAMMER: AMJAD IZHAR
* WRITTEN ON: 31-01-2007
* THIS REVISION: 31-01-2007
* 
*************************************************

CLEAR
CLEA ALL
CLOSE ALL

SET DATE TO BRIT
SET CENT ON

USE REPLDGR1
ZAP
USE

PUBLIC mC1,mC2,mC3,mDate1,mDate2,mDescrip1,mTrnDate,mTrnDesc

mC1=59
mC2=20
mC3=3
mDate1 = {01/07/2007}
mDate2 = {11/09/2007}

SELECT 1
USE LDGRCODE ORDER AC1
SET FILTER TO C1=mC1 AND C2=mC2 AND C3=mC3

SELECT 2
USE MASTER ORDER AC2
SET FILTER TO C1=mC1 AND C2=mC2 AND C3=mC3 ;
	AND DATE >= mDate1 ;
	AND DATE <= mDate2

SELECT 3
USE REPLDGR1 ORDER DATE


SELECT 1
SET RELATION TO STR(C1,2)+STR(C2,2)+STR(C3,3) INTO MASTER ADDITIVE
SET SKIP TO MASTER
GOTO TOP


mDescrip1 = "Account Code: "+STR(LDGRCODE.C1,2)+"-"+STR(LDGRCODE.C2,2)+"-"+STR(LDGRCODE.C3,3)
mTitle = "Account Title:  "+LDGRCODE.TITLE

mTrnDate = MASTER.Date
mTrnDesc = ALLTRIM(MASTER.Desc)+" "+ALLTRIM(MASTER.Desc1)

SELECT REPLDGR1
APPEND BLANK
REPL DESCRIP WITH ALLTRIM(mDescrip1+"  "+mTitle)

APPEND BLANK
REPL DESCRIP WITH "Ledger Report From: "+mdy(mdate1)+"  To: "+mdy(mdate2)

APPEND BLANK
APPEND BLANK

REPL DATE WITH mTrnDate
REPL DESCRIP WITH mTrnDesc
